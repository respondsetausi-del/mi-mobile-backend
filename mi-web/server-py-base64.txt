ZnJvbSBmYXN0YXBpIGltcG9ydCBGYXN0QVBJLCBBUElSb3V0ZXIsIEhUVFBFeGNlcHRpb24sIERl
cGVuZHMsIEhlYWRlciwgQm9keSwgUmVxdWVzdApmcm9tIGZhc3RhcGkuc2VjdXJpdHkgaW1wb3J0
IEhUVFBCZWFyZXIsIEhUVFBBdXRob3JpemF0aW9uQ3JlZGVudGlhbHMKZnJvbSBkb3RlbnYgaW1w
b3J0IGxvYWRfZG90ZW52CmZyb20gc3RhcmxldHRlLm1pZGRsZXdhcmUuY29ycyBpbXBvcnQgQ09S
U01pZGRsZXdhcmUKZnJvbSBtb3Rvci5tb3Rvcl9hc3luY2lvIGltcG9ydCBBc3luY0lPTW90b3JD
bGllbnQKZnJvbSBic29uIGltcG9ydCBPYmplY3RJZAppbXBvcnQgb3MKaW1wb3J0IGxvZ2dpbmcK
ZnJvbSBwYXRobGliIGltcG9ydCBQYXRoCmZyb20gcHlkYW50aWMgaW1wb3J0IEJhc2VNb2RlbCwg
RmllbGQKZnJvbSB0eXBpbmcgaW1wb3J0IExpc3QsIE9wdGlvbmFsLCBEaWN0CmZyb20gZGF0ZXRp
bWUgaW1wb3J0IGRhdGV0aW1lLCB0aW1lZGVsdGEKaW1wb3J0IHJhbmRvbQpmcm9tIG1hcmtldF9z
aW11bGF0b3IgaW1wb3J0IG1hcmtldF9zaW11bGF0b3IKZnJvbSByZWFsX21hcmtldF9kYXRhIGlt
cG9ydCByZWFsX21hcmtldF9kYXRhCmZyb20gaW5kaWNhdG9ycyBpbXBvcnQgVGVjaG5pY2FsSW5k
aWNhdG9ycywgU2lnbmFsR2VuZXJhdG9yCmltcG9ydCBodHRweAppbXBvcnQgYXN5bmNpbwpmcm9t
IGF1dGggaW1wb3J0ICgKICAgIFVzZXJSZWdpc3RlciwgVXNlckxvZ2luLCBBZG1pbkxvZ2luLCBU
b2tlbiwKICAgIHZlcmlmeV9wYXNzd29yZCwgZ2V0X3Bhc3N3b3JkX2hhc2gsIGNyZWF0ZV9hY2Nl
c3NfdG9rZW4sIHZlcmlmeV90b2tlbgopCmZyb20gbGljZW5zZV9tYW5hZ2VyIGltcG9ydCBMaWNl
bnNlTWFuYWdlcgpmcm9tIG1vZGVscyBpbXBvcnQgVXNlciwgQWRtaW4sIFVzZXJBY3Rpdml0eQpp
bXBvcnQgc3RyaW5nCmltcG9ydCBzZWNyZXRzCmZyb20gZW1lcmdlbnRpbnRlZ3JhdGlvbnMucGF5
bWVudHMuc3RyaXBlLmNoZWNrb3V0IGltcG9ydCBTdHJpcGVDaGVja291dCwgQ2hlY2tvdXRTZXNz
aW9uUmVzcG9uc2UsIENoZWNrb3V0U3RhdHVzUmVzcG9uc2UsIENoZWNrb3V0U2Vzc2lvblJlcXVl
c3QKZnJvbSBlbWFpbF9zZXJ2aWNlIGltcG9ydCBlbWFpbF9zZXJ2aWNlCmZyb20gdGVjaG5pY2Fs
X2FuYWx5c2lzX3NlcnZpY2UgaW1wb3J0IGdldF90ZWNobmljYWxfYW5hbHlzaXNfc2VydmljZQoK
IyBTaWduYWwgbW9kZWxzCmNsYXNzIE1hbnVhbFNpZ25hbChCYXNlTW9kZWwpOgogICAgc3ltYm9s
OiBzdHIKICAgIHNpZ25hbF90eXBlOiBzdHIgICMgIkJVWSIgb3IgIlNFTEwiCiAgICBpbmRpY2F0
b3I6IHN0cgogICAgY2FuZGxlX3BhdHRlcm46IHN0cgogICAgdGltZWZyYW1lOiBzdHIKICAgIG5v
dGVzOiBPcHRpb25hbFtzdHJdID0gTm9uZQogICAgdGFyZ2V0X3VzZXJzOiBPcHRpb25hbFtMaXN0
W3N0cl1dID0gTm9uZSAgIyBMaXN0IG9mIHVzZXIgSURzLCBOb25lIG1lYW5zIGFsbCB1c2Vycwog
ICAgZHVyYXRpb25fc2Vjb25kczogaW50ID0gMzAgICMgRGVmYXVsdCAzMCBzZWNvbmRzCgojIEJy
b2tlciBBZmZpbGlhdGUgbW9kZWxzCmNsYXNzIEJyb2tlckFmZmlsaWF0ZShCYXNlTW9kZWwpOgog
ICAgYnJva2VyX25hbWU6IHN0cgogICAgYnJva2VyX2ltYWdlOiBzdHIgICMgQmFzZTY0IGVuY29k
ZWQgaW1hZ2Ugb3IgVVJMCiAgICBhZmZpbGlhdGVfbGluazogc3RyCiAgICBkZXNjcmlwdGlvbjog
T3B0aW9uYWxbc3RyXSA9IE5vbmUKCiMgQ2hhbmdlIFBhc3N3b3JkIG1vZGVsCmNsYXNzIENoYW5n
ZVBhc3N3b3JkUmVxdWVzdChCYXNlTW9kZWwpOgogICAgY3VycmVudF9wYXNzd29yZDogc3RyCiAg
ICBuZXdfcGFzc3dvcmQ6IHN0cgoKIyBNYXJrZXQgTmV3cyBtb2RlbApjbGFzcyBNYXJrZXROZXdz
KEJhc2VNb2RlbCk6CiAgICB0aXRsZTogc3RyCiAgICBldmVudF90aW1lOiBzdHIgICMgVGltZSBv
ZiB0aGUgZXZlbnQgKGUuZy4sICIxNDozMCBVVEMiKQogICAgY3VycmVuY3k6IHN0ciAgIyBDdXJy
ZW5jeSBwYWlyIGFmZmVjdGVkIChlLmcuLCAiVVNEIiwgIkVVUiIpCiAgICBpbXBhY3Q6IHN0ciAg
IyAiSGlnaCIsICJNZWRpdW0iLCAiTG93IgogICAgc2lnbmFsOiBPcHRpb25hbFtzdHJdID0gTm9u
ZSAgIyAiQlVZIiBvciAiU0VMTCIgcmVjb21tZW5kYXRpb24KCiMgTWFudWFsIE5ld3MgRXZlbnQg
bW9kZWwgKGFsbCBmaWVsZHMgb3B0aW9uYWwgZXhjZXB0IHRpdGxlKQpjbGFzcyBNYW51YWxOZXdz
RXZlbnQoQmFzZU1vZGVsKToKICAgIHRpdGxlOiBzdHIgICMgUmVxdWlyZWQKICAgIGV2ZW50X3Rp
bWU6IE9wdGlvbmFsW3N0cl0gPSBOb25lICAjIE9wdGlvbmFsCiAgICBjdXJyZW5jeTogT3B0aW9u
YWxbc3RyXSA9IE5vbmUgICMgT3B0aW9uYWwKICAgIGltcGFjdDogT3B0aW9uYWxbc3RyXSA9IE5v
bmUgICMgT3B0aW9uYWwKICAgIGRlc2NyaXB0aW9uOiBPcHRpb25hbFtzdHJdID0gTm9uZSAgIyBP
cHRpb25hbAogICAgc2lnbmFsOiBPcHRpb25hbFtzdHJdID0gTm9uZSAgIyBPcHRpb25hbDogIkJV
WSIgb3IgIlNFTEwiCgojIEN1c3RvbSBJbmRpY2F0b3IgbW9kZWxzCmNsYXNzIEluZGljYXRvckNv
bmZpZyhCYXNlTW9kZWwpOgogICAgIiIiQ29uZmlndXJhdGlvbiBmb3IgYSBzaW5nbGUgdGVjaG5p
Y2FsIGluZGljYXRvciIiIgogICAgaW5kaWNhdG9yX3R5cGU6IHN0ciAgIyAiUlNJIiwgIk1BQ0Qi
LCAiTUEiLCAiRU1BIiwgIkJPTExJTkdFUiIsICJTVE9DSEFTVElDIgogICAgcGVyaW9kOiBPcHRp
b25hbFtpbnRdID0gTm9uZSAgIyBQZXJpb2QgZm9yIGNhbGN1bGF0aW9uCiAgICB0aHJlc2hvbGRf
dXBwZXI6IE9wdGlvbmFsW2Zsb2F0XSA9IE5vbmUgICMgVXBwZXIgdGhyZXNob2xkIChlLmcuLCBS
U0kgPiA3MCkKICAgIHRocmVzaG9sZF9sb3dlcjogT3B0aW9uYWxbZmxvYXRdID0gTm9uZSAgIyBM
b3dlciB0aHJlc2hvbGQgKGUuZy4sIFJTSSA8IDMwKQogICAgbWFfdHlwZTogT3B0aW9uYWxbc3Ry
XSA9IE5vbmUgICMgIlNNQSIsICJFTUEiIGZvciBNb3ZpbmcgQXZlcmFnZXMKICAgIGZhc3RfcGVy
aW9kOiBPcHRpb25hbFtpbnRdID0gTm9uZSAgIyBGb3IgTUFDRAogICAgc2xvd19wZXJpb2Q6IE9w
dGlvbmFsW2ludF0gPSBOb25lICAjIEZvciBNQUNECiAgICBzaWduYWxfcGVyaW9kOiBPcHRpb25h
bFtpbnRdID0gTm9uZSAgIyBGb3IgTUFDRCBzaWduYWwgbGluZQoKY2xhc3MgVHJhZGluZ0NvbmRp
dGlvbihCYXNlTW9kZWwpOgogICAgIiIiQnV5IG9yIFNlbGwgY29uZGl0aW9uIiIiCiAgICBjb25k
aXRpb25fdHlwZTogc3RyICAjICJBQk9WRSIsICJCRUxPVyIsICJDUk9TU19BQk9WRSIsICJDUk9T
U19CRUxPVyIsICJCRVRXRUVOIgogICAgaW5kaWNhdG9yX3JlZjogc3RyICAjIFJlZmVyZW5jZSB0
byBpbmRpY2F0b3IgKGUuZy4sICJSU0kiLCAiTUFDRCIpCiAgICB2YWx1ZTogT3B0aW9uYWxbZmxv
YXRdID0gTm9uZSAgIyBUaHJlc2hvbGQgdmFsdWUKICAgIHZhbHVlX3VwcGVyOiBPcHRpb25hbFtm
bG9hdF0gPSBOb25lICAjIEZvciBCRVRXRUVOIGNvbmRpdGlvbgogICAgdmFsdWVfbG93ZXI6IE9w
dGlvbmFsW2Zsb2F0XSA9IE5vbmUgICMgRm9yIEJFVFdFRU4gY29uZGl0aW9uCgpjbGFzcyBDdXN0
b21JbmRpY2F0b3IoQmFzZU1vZGVsKToKICAgIG5hbWU6IHN0ciAgIyBJbmRpY2F0b3IgbmFtZSAo
ZS5nLiwgIlJTSSBTdHJhdGVneSIsICJNQSBDcm9zc292ZXIiKQogICAgZGVzY3JpcHRpb246IE9w
dGlvbmFsW3N0cl0gPSBOb25lICAjIE9wdGlvbmFsIGRlc2NyaXB0aW9uCiAgICBzeW1ib2w6IHN0
ciAgIyBUcmFkaW5nIHN5bWJvbCB0byBtb25pdG9yIChlLmcuLCAiRVVSL1VTRCIsICJFVVJVU0Qi
KQogICAgdGltZWZyYW1lOiBzdHIgICMgVGltZWZyYW1lIChlLmcuLCAiMUgiLCAiNEgiLCAiMUQi
KQogICAgaW5kaWNhdG9yczogTGlzdFtJbmRpY2F0b3JDb25maWddICAjIExpc3Qgb2YgdGVjaG5p
Y2FsIGluZGljYXRvcnMgdG8gdXNlCiAgICBidXlfY29uZGl0aW9uczogTGlzdFtUcmFkaW5nQ29u
ZGl0aW9uXSAgIyBDb25kaXRpb25zIGZvciBCVVkgc2lnbmFsCiAgICBzZWxsX2NvbmRpdGlvbnM6
IExpc3RbVHJhZGluZ0NvbmRpdGlvbl0gICMgQ29uZGl0aW9ucyBmb3IgU0VMTCBzaWduYWwKICAg
IApjbGFzcyBJbmRpY2F0b3JTaWduYWxVcGRhdGUoQmFzZU1vZGVsKToKICAgIGluZGljYXRvcl9p
ZDogc3RyCiAgICBzaWduYWw6IHN0ciAgIyAiQlVZIiwgIlNFTEwiLCBvciAiTk9ORSIKICAgIApj
bGFzcyBVc2VySW5kaWNhdG9yU2VsZWN0aW9uKEJhc2VNb2RlbCk6CiAgICBpbmRpY2F0b3JfaWQ6
IHN0cgoKY2xhc3MgSW5kaWNhdG9yU3Vic2NyaXB0aW9uQ3JlYXRlKEJhc2VNb2RlbCk6CiAgICBp
bmRpY2F0b3JfaWQ6IHN0cgogICAgc3ltYm9sOiBzdHIKICAgIHRpbWVmcmFtZTogc3RyCgpjbGFz
cyBNYW51YWxPdmVycmlkZVNpZ25hbChCYXNlTW9kZWwpOgogICAgaW5kaWNhdG9yX2lkOiBzdHIK
ICAgIHNpZ25hbDogc3RyICAjICJCVVkiIG9yICJTRUxMIgoKCiMgSGVscGVyIGZ1bmN0aW9ucyBm
b3IgbWVudG9yIG9wZXJhdGlvbnMKZGVmIGdlbmVyYXRlX2xpY2Vuc2Vfa2V5KCk6CiAgICAiIiJH
ZW5lcmF0ZSBhIGxpY2Vuc2Uga2V5IHVzaW5nIExpY2Vuc2VNYW5hZ2VyIiIiCiAgICByZXR1cm4g
TGljZW5zZU1hbmFnZXIuZ2VuZXJhdGVfbGljZW5zZV9rZXkoKQoKZGVmIGdlbmVyYXRlX3JhbmRv
bV9zdHJpbmcobGVuZ3RoKToKICAgICIiIkdlbmVyYXRlIGEgcmFuZG9tIHN0cmluZyBmb3IgdGVt
cG9yYXJ5IHBhc3N3b3JkcyIiIgogICAgYWxwaGFiZXQgPSBzdHJpbmcuYXNjaWlfbGV0dGVycyAr
IHN0cmluZy5kaWdpdHMgKyAiIUAjJCVeJioiCiAgICByZXR1cm4gJycuam9pbihzZWNyZXRzLmNo
b2ljZShhbHBoYWJldCkgZm9yIGkgaW4gcmFuZ2UobGVuZ3RoKSkKCmRlZiBoYXNoX3Bhc3N3b3Jk
KHBhc3N3b3JkKToKICAgICIiIkhhc2ggYSBwYXNzd29yZCB1c2luZyB0aGUgYXV0aCBtb2R1bGUi
IiIKICAgIHJldHVybiBnZXRfcGFzc3dvcmRfaGFzaChwYXNzd29yZCkKClJPT1RfRElSID0gUGF0
aChfX2ZpbGVfXykucGFyZW50CiMgTG9hZCAuZW52IGZpbGUgYnV0IGRvbid0IG92ZXJyaWRlIGVu
dmlyb25tZW50IHZhcmlhYmxlcyBmcm9tIEt1YmVybmV0ZXMKbG9hZF9kb3RlbnYoUk9PVF9ESVIg
LyAnLmVudicsIG92ZXJyaWRlPUZhbHNlKQoKIyBNb25nb0RCIGNvbm5lY3Rpb24gLSB1c2UgLmdl
dCgpIHdpdGggZmFsbGJhY2sgZm9yIGRldmVsb3BtZW50Cm1vbmdvX3VybCA9IG9zLmdldGVudign
TU9OR09fVVJMJywgJ21vbmdvZGI6Ly9sb2NhbGhvc3Q6MjcwMTcnKQpkYl9uYW1lID0gb3MuZ2V0
ZW52KCdEQl9OQU1FJywgJ21pX21vYmlsZV9pbmRpY2F0b3InKQoKcHJpbnQoZiLwn5SNIENvbm5l
Y3RpbmcgdG8gTW9uZ29EQjoge21vbmdvX3VybFs6MjBdfS4uLiIpCnByaW50KGYi8J+UjSBEYXRh
YmFzZToge2RiX25hbWV9IikKCmNsaWVudCA9IEFzeW5jSU9Nb3RvckNsaWVudChtb25nb191cmwp
CmRiID0gY2xpZW50W2RiX25hbWVdCgojIENyZWF0ZSB0aGUgbWFpbiBhcHAgd2l0aG91dCBhIHBy
ZWZpeAphcHAgPSBGYXN0QVBJKCkKCiMgQ3JlYXRlIGEgcm91dGVyIHdpdGggdGhlIC9hcGkgcHJl
Zml4CmFwaV9yb3V0ZXIgPSBBUElSb3V0ZXIocHJlZml4PSIvYXBpIikKCiMgSGVscGVyIGZ1bmN0
aW9uIHRvIHNlcmlhbGl6ZSBNb25nb0RCIGRvY3VtZW50cwpkZWYgc2VyaWFsaXplX2RvYyhkb2Mp
OgogICAgaWYgZG9jIGFuZCAnX2lkJyBpbiBkb2M6CiAgICAgICAgZG9jWydfaWQnXSA9IHN0cihk
b2NbJ19pZCddKQogICAgcmV0dXJuIGRvYwoKIyBTZWN1cml0eQpzZWN1cml0eSA9IEhUVFBCZWFy
ZXIoKQoKIyBEZXBlbmRlbmN5IHRvIGdldCBjdXJyZW50IHVzZXIgZnJvbSBKV1QgdG9rZW4KYXN5
bmMgZGVmIGdldF9jdXJyZW50X3VzZXIoY3JlZGVudGlhbHM6IEhUVFBBdXRob3JpemF0aW9uQ3Jl
ZGVudGlhbHMgPSBEZXBlbmRzKHNlY3VyaXR5KSk6CiAgICAiIiIKICAgIEdldCBjdXJyZW50IHVz
ZXIgZm9yIHByb3RlY3RlZCByb3V0ZXMuCiAgICBJTVBPUlRBTlQ6IE9ubHkgYWxsb3dzIHVzZXJz
IHdobyBoYXZlOgogICAgMS4gQWN0aXZlIGFjY291bnQgc3RhdHVzIChub3QgZGVhY3RpdmF0ZWQp
CiAgICAyLiBQYWlkIHN0YXR1cyAocGF5bWVudF9zdGF0dXMgPSAicGFpZCIpCiAgICAKICAgIFRo
aXMgZW5zdXJlcyBvbmx5IHBheWluZyBjdXN0b21lcnMgY2FuIGFjY2VzcyBhcHAgZmVhdHVyZXMu
CiAgICAiIiIKICAgIHRva2VuID0gY3JlZGVudGlhbHMuY3JlZGVudGlhbHMKICAgIHBheWxvYWQg
PSB2ZXJpZnlfdG9rZW4odG9rZW4pCiAgICBpZiBub3QgcGF5bG9hZDoKICAgICAgICByYWlzZSBI
VFRQRXhjZXB0aW9uKHN0YXR1c19jb2RlPTQwMSwgZGV0YWlsPSJJbnZhbGlkIG9yIGV4cGlyZWQg
dG9rZW4iKQogICAgCiAgICB1c2VyX2lkID0gcGF5bG9hZC5nZXQoInN1YiIpCiAgICB1c2VyX3R5
cGUgPSBwYXlsb2FkLmdldCgidHlwZSIsICJ1c2VyIikKICAgIAogICAgaWYgbm90IHVzZXJfaWQ6
CiAgICAgICAgcmFpc2UgSFRUUEV4Y2VwdGlvbihzdGF0dXNfY29kZT00MDEsIGRldGFpbD0iSW52
YWxpZCB0b2tlbiBwYXlsb2FkIikKICAgIAogICAgIyBGZXRjaCB1c2VyIGZyb20gZGF0YWJhc2UK
ICAgIGlmIHVzZXJfdHlwZSA9PSAiYWRtaW4iOgogICAgICAgIHVzZXIgPSBhd2FpdCBkYi5hZG1p
bnMuZmluZF9vbmUoeyJfaWQiOiBPYmplY3RJZCh1c2VyX2lkKX0pCiAgICBlbHNlOgogICAgICAg
IHVzZXIgPSBhd2FpdCBkYi51c2Vycy5maW5kX29uZSh7Il9pZCI6IE9iamVjdElkKHVzZXJfaWQp
fSkKICAgIAogICAgaWYgbm90IHVzZXI6CiAgICAgICAgcmFpc2UgSFRUUEV4Y2VwdGlvbihzdGF0
dXNfY29kZT00MDEsIGRldGFpbD0iVXNlciBub3QgZm91bmQiKQogICAgCiAgICAjIEZvciByZWd1
bGFyIHVzZXJzIChub3QgYWRtaW5zKSwgZW5mb3JjZSBwYXltZW50IHJlcXVpcmVtZW50CiAgICBp
ZiB1c2VyX3R5cGUgIT0gImFkbWluIjoKICAgICAgICBhY2NvdW50X3N0YXR1cyA9IHVzZXIuZ2V0
KCJzdGF0dXMiKQogICAgICAgIHBheW1lbnRfc3RhdHVzID0gdXNlci5nZXQoInBheW1lbnRfc3Rh
dHVzIiwgInVucGFpZCIpCiAgICAgICAgCiAgICAgICAgIyBCbG9jayBkZWFjdGl2YXRlZCBhY2Nv
dW50cyAoYWRtaW4gZXhwbGljaXRseSBkZWFjdGl2YXRlZCB0aGVtKQogICAgICAgIGlmIGFjY291
bnRfc3RhdHVzID09ICJpbmFjdGl2ZSI6CiAgICAgICAgICAgIHJhaXNlIEhUVFBFeGNlcHRpb24o
c3RhdHVzX2NvZGU9NDAzLCBkZXRhaWw9IkFjY291bnQgaXMgZGVhY3RpdmF0ZWQuIFBsZWFzZSBj
b250YWN0IGFkbWluLiIpCiAgICAgICAgCiAgICAgICAgIyBCbG9jayB1bnBhaWQgYWNjb3VudHMg
KG11c3QgY29tcGxldGUgcGF5bWVudCBmaXJzdCkKICAgICAgICAjIFRoaXMgaXMgdGhlIFBSSU1B
UlkgYWNjZXNzIGNvbnRyb2wgLSBwYXltZW50X3N0YXR1cyBtdXN0IGJlICJwYWlkIgogICAgICAg
IGlmIHBheW1lbnRfc3RhdHVzICE9ICJwYWlkIjoKICAgICAgICAgICAgcmFpc2UgSFRUUEV4Y2Vw
dGlvbigKICAgICAgICAgICAgICAgIHN0YXR1c19jb2RlPTQwMywgCiAgICAgICAgICAgICAgICBk
ZXRhaWw9IlBheW1lbnQgcmVxdWlyZWQuIFBsZWFzZSBjb21wbGV0ZSBwYXltZW50IHRvIGFjY2Vz
cyB0aGUgYXBwLiIsCiAgICAgICAgICAgICAgICBoZWFkZXJzPXsiWC1QYXltZW50LVJlcXVpcmVk
IjogInRydWUifQogICAgICAgICAgICApCiAgICAgICAgCiAgICAgICAgIyBJZiB1c2VyIGhhcyBw
YWlkIChwYXltZW50X3N0YXR1cz0icGFpZCIpLCB0aGV5IGdldCBhY2Nlc3MKICAgICAgICAjIHJl
Z2FyZGxlc3Mgb2Ygc3RhdHVzIGZpZWxkICh1bmxlc3MgZXhwbGljaXRseSBkZWFjdGl2YXRlZCBh
Ym92ZSkKICAgICAgICAjIFRoaXMgYWxsb3dzIGV4aXN0aW5nIHVzZXJzIG1hcmtlZCBhcyBwYWlk
IHRvIGFjY2VzcyB0aGUgYXBwCiAgICAKICAgIHJldHVybiBzZXJpYWxpemVfZG9jKHVzZXIpCgoj
IERlcGVuZGVuY3kgZm9yIHBheW1lbnQgZW5kcG9pbnRzIC0gYWxsb3dzIHBlbmRpbmcgdXNlcnMg
dG8gcGF5CmFzeW5jIGRlZiBnZXRfY3VycmVudF91c2VyX2Zvcl9wYXltZW50KGNyZWRlbnRpYWxz
OiBIVFRQQXV0aG9yaXphdGlvbkNyZWRlbnRpYWxzID0gRGVwZW5kcyhzZWN1cml0eSkpOgogICAg
IiIiR2V0IGN1cnJlbnQgdXNlciBmb3IgcGF5bWVudCBlbmRwb2ludHMgLSBhbGxvd3MgcGVuZGlu
ZyBzdGF0dXMiIiIKICAgIHRva2VuID0gY3JlZGVudGlhbHMuY3JlZGVudGlhbHMKICAgIHBheWxv
YWQgPSB2ZXJpZnlfdG9rZW4odG9rZW4pCiAgICB1c2VyX2lkID0gcGF5bG9hZC5nZXQoInN1YiIp
CiAgICB1c2VyX3R5cGUgPSBwYXlsb2FkLmdldCgidHlwZSIsICJ1c2VyIikKICAgIAogICAgaWYg
bm90IHVzZXJfaWQ6CiAgICAgICAgcmFpc2UgSFRUUEV4Y2VwdGlvbihzdGF0dXNfY29kZT00MDEs
IGRldGFpbD0iSW52YWxpZCB0b2tlbiIpCiAgICAKICAgICMgRmV0Y2ggdXNlciBmcm9tIGRhdGFi
YXNlCiAgICBpZiB1c2VyX3R5cGUgPT0gImFkbWluIjoKICAgICAgICB1c2VyID0gYXdhaXQgZGIu
YWRtaW5zLmZpbmRfb25lKHsiX2lkIjogT2JqZWN0SWQodXNlcl9pZCl9KQogICAgZWxzZToKICAg
ICAgICB1c2VyID0gYXdhaXQgZGIudXNlcnMuZmluZF9vbmUoeyJfaWQiOiBPYmplY3RJZCh1c2Vy
X2lkKX0pCiAgICAKICAgIGlmIG5vdCB1c2VyOgogICAgICAgIHJhaXNlIEhUVFBFeGNlcHRpb24o
c3RhdHVzX2NvZGU9NDAxLCBkZXRhaWw9IlVzZXIgbm90IGZvdW5kIikKICAgIAogICAgIyBBbGxv
dyBwZW5kaW5nIHVzZXJzIHRvIGFjY2VzcyBwYXltZW50ICh0aGV5IG5lZWQgdG8gcGF5IHRvIHBy
b2NlZWQpCiAgICAjIE9ubHkgYmxvY2sgaWYgdHJ1bHkgZGVhY3RpdmF0ZWQvaW5hY3RpdmUKICAg
IGlmIHVzZXJfdHlwZSAhPSAiYWRtaW4iIGFuZCB1c2VyLmdldCgic3RhdHVzIikgPT0gImluYWN0
aXZlIjoKICAgICAgICByYWlzZSBIVFRQRXhjZXB0aW9uKHN0YXR1c19jb2RlPTQwMywgZGV0YWls
PSJBY2NvdW50IGlzIGRlYWN0aXZhdGVkLiBQbGVhc2UgY29udGFjdCBhZG1pbi4iKQogICAgCiAg
ICByZXR1cm4gc2VyaWFsaXplX2RvYyh1c2VyKQoKIyBQdXNoIE5vdGlmaWNhdGlvbiBIZWxwZXIg
RnVuY3Rpb24KYXN5bmMgZGVmIHNlbmRfcHVzaF9ub3RpZmljYXRpb25zX2JhdGNoKG1lc3NhZ2Vz
OiBMaXN0W2RpY3RdKToKICAgICIiIgogICAgU2VuZCBwdXNoIG5vdGlmaWNhdGlvbnMgaW4gYmF0
Y2ggdXNpbmcgRXhwbyBQdXNoIE5vdGlmaWNhdGlvbiBTZXJ2aWNlCiAgICAKICAgIEFyZ3M6CiAg
ICAgICAgbWVzc2FnZXM6IExpc3Qgb2Ygbm90aWZpY2F0aW9uIG1lc3NhZ2VzIGluIGZvcm1hdDoK
ICAgICAgICAgICAgW3sKICAgICAgICAgICAgICAgICJ0byI6ICJFeHBvbmVudFB1c2hUb2tlblt4
eHhdIiwKICAgICAgICAgICAgICAgICJzb3VuZCI6ICJkZWZhdWx0IiwKICAgICAgICAgICAgICAg
ICJ0aXRsZSI6ICJOb3RpZmljYXRpb24gVGl0bGUiLAogICAgICAgICAgICAgICAgImJvZHkiOiAi
Tm90aWZpY2F0aW9uIGJvZHkgdGV4dCIsCiAgICAgICAgICAgICAgICAiZGF0YSI6IHsia2V5Ijog
InZhbHVlIn0KICAgICAgICAgICAgfV0KICAgICIiIgogICAgaWYgbm90IG1lc3NhZ2VzOgogICAg
ICAgIHJldHVybgogICAgCiAgICB0cnk6CiAgICAgICAgYXN5bmMgd2l0aCBodHRweC5Bc3luY0Ns
aWVudCgpIGFzIGNsaWVudDoKICAgICAgICAgICAgcmVzcG9uc2UgPSBhd2FpdCBjbGllbnQucG9z
dCgKICAgICAgICAgICAgICAgICdodHRwczovL2V4cC5ob3N0Ly0tL2FwaS92Mi9wdXNoL3NlbmQn
LAogICAgICAgICAgICAgICAganNvbj1tZXNzYWdlcywKICAgICAgICAgICAgICAgIGhlYWRlcnM9
ewogICAgICAgICAgICAgICAgICAgICdBY2NlcHQnOiAnYXBwbGljYXRpb24vanNvbicsCiAgICAg
ICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJywKICAgICAg
ICAgICAgICAgICAgICAnQWNjZXB0LUVuY29kaW5nJzogJ2d6aXAsIGRlZmxhdGUnLAogICAgICAg
ICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHRpbWVvdXQ9MTAuMAogICAgICAgICAgICApCiAg
ICAgICAgICAgIAogICAgICAgICAgICBpZiByZXNwb25zZS5zdGF0dXNfY29kZSA9PSAyMDA6CiAg
ICAgICAgICAgICAgICByZXN1bHQgPSByZXNwb25zZS5qc29uKCkKICAgICAgICAgICAgICAgIGxv
Z2dlci5pbmZvKGYi4pyFIFB1c2ggbm90aWZpY2F0aW9ucyBzZW50IHN1Y2Nlc3NmdWxseToge2xl
bihtZXNzYWdlcyl9IG1lc3NhZ2VzIikKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAg
IyBMb2cgYW55IGVycm9ycyBmcm9tIEV4cG8KICAgICAgICAgICAgICAgIGlmICdkYXRhJyBpbiBy
ZXN1bHQ6CiAgICAgICAgICAgICAgICAgICAgZm9yIGlkeCwgaXRlbSBpbiBlbnVtZXJhdGUocmVz
dWx0WydkYXRhJ10pOgogICAgICAgICAgICAgICAgICAgICAgICBpZiBpdGVtLmdldCgnc3RhdHVz
JykgPT0gJ2Vycm9yJzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlci5lcnJvcihm
IlB1c2ggbm90aWZpY2F0aW9uIGVycm9yIGZvciBtZXNzYWdlIHtpZHh9OiB7aXRlbS5nZXQoJ21l
c3NhZ2UnKX0iKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgbG9nZ2VyLmVycm9y
KGYi4p2MIFB1c2ggbm90aWZpY2F0aW9uIGZhaWxlZDoge3Jlc3BvbnNlLnN0YXR1c19jb2RlfSAt
IHtyZXNwb25zZS50ZXh0fSIpCiAgICAgICAgICAgICAgICAKICAgIGV4Y2VwdCBFeGNlcHRpb24g
YXMgZToKICAgICAgICBsb2dnZXIuZXJyb3IoZiLinYwgRXJyb3Igc2VuZGluZyBwdXNoIG5vdGlm
aWNhdGlvbnM6IHtzdHIoZSl9IikKCgoKIyBEZXBlbmRlbmN5IHRvIGdldCBjdXJyZW50IGFkbWlu
CmFzeW5jIGRlZiBnZXRfY3VycmVudF9hZG1pbihjcmVkZW50aWFsczogSFRUUEF1dGhvcml6YXRp
b25DcmVkZW50aWFscyA9IERlcGVuZHMoc2VjdXJpdHkpKToKICAgIHVzZXIgPSBhd2FpdCBnZXRf
Y3VycmVudF91c2VyKGNyZWRlbnRpYWxzKQogICAgIyBDaGVjayBpZiB1c2VyIGlzIGZyb20gYWRt
aW5zIGNvbGxlY3Rpb24gKGhhcyAncm9sZScgZmllbGQpCiAgICBpZiAncm9sZScgbm90IGluIHVz
ZXI6CiAgICAgICAgcmFpc2UgSFRUUEV4Y2VwdGlvbihzdGF0dXNfY29kZT00MDMsIGRldGFpbD0i
QWRtaW4gYWNjZXNzIHJlcXVpcmVkIikKICAgIHJldHVybiB1c2VyCgojIERlcGVuZGVuY3kgdG8g
Z2V0IGN1cnJlbnQgbWVudG9yCmFzeW5jIGRlZiBnZXRfY3VycmVudF9tZW50b3IoY3JlZGVudGlh
bHM6IEhUVFBBdXRob3JpemF0aW9uQ3JlZGVudGlhbHMgPSBEZXBlbmRzKHNlY3VyaXR5KSk6CiAg
ICB0b2tlbiA9IGNyZWRlbnRpYWxzLmNyZWRlbnRpYWxzCiAgICBwYXlsb2FkID0gdmVyaWZ5X3Rv
a2VuKHRva2VuKQogICAgaWYgbm90IHBheWxvYWQ6CiAgICAgICAgcmFpc2UgSFRUUEV4Y2VwdGlv
bihzdGF0dXNfY29kZT00MDEsIGRldGFpbD0iSW52YWxpZCBvciBleHBpcmVkIHRva2VuIikKICAg
IAogICAgdXNlcl9pZCA9IHBheWxvYWQuZ2V0KCJzdWIiKQogICAgdXNlcl90eXBlID0gcGF5bG9h
ZC5nZXQoInR5cGUiKQogICAgCiAgICBpZiB1c2VyX3R5cGUgIT0gIm1lbnRvciI6CiAgICAgICAg
cmFpc2UgSFRUUEV4Y2VwdGlvbihzdGF0dXNfY29kZT00MDMsIGRldGFpbD0iTWVudG9yIGFjY2Vz
cyByZXF1aXJlZCIpCiAgICAKICAgICMgRmV0Y2ggbWVudG9yIGZyb20gZGF0YWJhc2UKICAgIG1l
bnRvciA9IGF3YWl0IGRiLm1lbnRvcnMuZmluZF9vbmUoeyJfaWQiOiBPYmplY3RJZCh1c2VyX2lk
KX0pCiAgICAKICAgIGlmIG5vdCBtZW50b3I6CiAgICAgICAgcmFpc2UgSFRUUEV4Y2VwdGlvbihz
dGF0dXNfY29kZT00MDEsIGRldGFpbD0iTWVudG9yIG5vdCBmb3VuZCIpCiAgICAKICAgIGlmIG1l
bnRvci5nZXQoInN0YXR1cyIpICE9ICJhY3RpdmUiOgogICAgICAgIHJhaXNlIEhUVFBFeGNlcHRp
b24oc3RhdHVzX2NvZGU9NDAzLCBkZXRhaWw9Ik1lbnRvciBhY2NvdW50IGlzIG5vdCBhY3RpdmUi
KQogICAgCiAgICByZXR1cm4gc2VyaWFsaXplX2RvYyhtZW50b3IpCgojIE9wdGlvbmFsIGF1dGgg
LSByZXR1cm5zIE5vbmUgaWYgbm8gdG9rZW4gcHJvdmlkZWQKYXN5bmMgZGVmIGdldF9jdXJyZW50
X3VzZXJfb3B0aW9uYWwoYXV0aG9yaXphdGlvbjogT3B0aW9uYWxbc3RyXSA9IEhlYWRlcihOb25l
KSk6CiAgICBpZiBub3QgYXV0aG9yaXphdGlvbjoKICAgICAgICByZXR1cm4gTm9uZQogICAgdHJ5
OgogICAgICAgIHRva2VuID0gYXV0aG9yaXphdGlvbi5yZXBsYWNlKCJCZWFyZXIgIiwgIiIpCiAg
ICAgICAgcGF5bG9hZCA9IHZlcmlmeV90b2tlbih0b2tlbikKICAgICAgICBpZiBwYXlsb2FkOgog
ICAgICAgICAgICB1c2VyX2lkID0gcGF5bG9hZC5nZXQoInN1YiIpCiAgICAgICAgICAgIHVzZXIg
PSBhd2FpdCBkYi51c2Vycy5maW5kX29uZSh7Il9pZCI6IE9iamVjdElkKHVzZXJfaWQpfSkKICAg
ICAgICAgICAgcmV0dXJuIHNlcmlhbGl6ZV9kb2ModXNlcikgaWYgdXNlciBlbHNlIE5vbmUKICAg
IGV4Y2VwdDoKICAgICAgICByZXR1cm4gTm9uZQogICAgcmV0dXJuIE5vbmUKCiMgRGVmaW5lIE1v
ZGVscwpjbGFzcyBJbmRpY2F0b3JTZXR0aW5ncyhCYXNlTW9kZWwpOgogICAgdHlwZTogc3RyICAj
IE1BX0NST1NTT1ZFUiwgUlNJLCBNQUNELCBCT0xMSU5HRVJfQkFORFMsIFNUT0NIQVNUSUMKICAg
IHBhcmFtZXRlcnM6IERpY3QgICMgQ3VzdG9tIHBhcmFtZXRlcnMgZm9yIGVhY2ggaW5kaWNhdG9y
CgpjbGFzcyBFQUNvbmZpZyhCYXNlTW9kZWwpOgogICAgc3ltYm9sOiBzdHIKICAgIHRpbWVmcmFt
ZTogc3RyICAjIDFtLCA1bSwgMTVtLCAzMG0sIDFoLCA0aCwgMWQsIDF3CiAgICBpbmRpY2F0b3I6
IEluZGljYXRvclNldHRpbmdzCgpjbGFzcyBFQUNyZWF0ZShCYXNlTW9kZWwpOgogICAgbmFtZTog
c3RyCiAgICBjb25maWc6IEVBQ29uZmlnCgpjbGFzcyBFQVVwZGF0ZShCYXNlTW9kZWwpOgogICAg
bmFtZTogT3B0aW9uYWxbc3RyXSA9IE5vbmUKICAgIGNvbmZpZzogT3B0aW9uYWxbRUFDb25maWdd
ID0gTm9uZQogICAgc3RhdHVzOiBPcHRpb25hbFtzdHJdID0gTm9uZQoKY2xhc3MgUXVvdGUoQmFz
ZU1vZGVsKToKICAgIHN5bWJvbDogc3RyCiAgICBjYXRlZ29yeTogc3RyCiAgICBiaWQ6IGZsb2F0
CiAgICBhc2s6IGZsb2F0CiAgICBjaGFuZ2U6IGZsb2F0CiAgICB0aW1lc3RhbXA6IHN0cgoKY2xh
c3MgUHVzaFRva2VuKEJhc2VNb2RlbCk6CiAgICB0b2tlbjogc3RyCgojID09PT09PT09PT09PT09
PT09PT09IEhFQUxUSCBDSEVDSyBFTkRQT0lOVCA9PT09PT09PT09PT09PT09PT09PQoKQGFwaV9y
b3V0ZXIuZ2V0KCIvaGVhbHRoIikKYXN5bmMgZGVmIGhlYWx0aF9jaGVjaygpOgogICAgIiIiCiAg
ICBMaWdodHdlaWdodCBoZWFsdGggY2hlY2sgZW5kcG9pbnQgZm9yIGtlZXAtYWxpdmUgc2Vydmlj
ZS4KICAgIFJldHVybnMgc2VydmVyIHN0YXR1cyBhbmQgdXB0aW1lIGluZm8uCiAgICAiIiIKICAg
IHJldHVybiB7CiAgICAgICAgInN0YXR1cyI6ICJoZWFsdGh5IiwKICAgICAgICAibWVzc2FnZSI6
ICJCYWNrZW5kIGlzIGFsaXZlIGFuZCBydW5uaW5nIiwKICAgICAgICAidGltZXN0YW1wIjogZGF0
ZXRpbWUudXRjbm93KCkuaXNvZm9ybWF0KCksCiAgICAgICAgImRhdGFiYXNlIjogImNvbm5lY3Rl
ZCIKICAgIH0KCiMgPT09PT09PT09PT09PT09PT09PT0gQVVUSEVOVElDQVRJT04gUk9VVEVTID09
PT09PT09PT09PT09PT09PT09CgpAYXBpX3JvdXRlci5wb3N0KCIvYXV0aC9yZWdpc3RlciIsIHJl
c3BvbnNlX21vZGVsPWRpY3QpCmFzeW5jIGRlZiByZWdpc3Rlcl91c2VyKHVzZXJfZGF0YTogVXNl
clJlZ2lzdGVyKToKICAgICIiIlJlZ2lzdGVyIGEgbmV3IHVzZXIiIiIKICAgICMgQ2hlY2sgaWYg
ZW1haWwgYWxyZWFkeSBleGlzdHMKICAgIGV4aXN0aW5nX3VzZXIgPSBhd2FpdCBkYi51c2Vycy5m
aW5kX29uZSh7ImVtYWlsIjogdXNlcl9kYXRhLmVtYWlsfSkKICAgIGlmIGV4aXN0aW5nX3VzZXI6
CiAgICAgICAgcmFpc2UgSFRUUEV4Y2VwdGlvbihzdGF0dXNfY29kZT00MDAsIGRldGFpbD0iRW1h
aWwgYWxyZWFkeSByZWdpc3RlcmVkIikKICAgIAogICAgIyBWYWxpZGF0ZSBsaWNlbnNlIGtleQog
ICAgaXNfdmFsaWQgPSBhd2FpdCBMaWNlbnNlTWFuYWdlci5pc19saWNlbnNlX3ZhbGlkKGRiLCB1
c2VyX2RhdGEubGljZW5zZV9rZXkpCiAgICBpZiBub3QgaXNfdmFsaWQ6CiAgICAgICAgcmFpc2Ug
SFRUUEV4Y2VwdGlvbihzdGF0dXNfY29kZT00MDAsIGRldGFpbD0iSW52YWxpZCBvciBhbHJlYWR5
IHVzZWQgbGljZW5zZSBrZXkiKQogICAgCiAgICAjIEVuc3VyZSBtZW50b3IgSUQgZXhpc3RzIGlu
IG1lbnRvcnMgY29sbGVjdGlvbiAoY3JlYXRlIGlmIGRvZXNuJ3QgZXhpc3QpCiAgICBpZiB1c2Vy
X2RhdGEubWVudG9yX2lkOgogICAgICAgIGV4aXN0aW5nX21lbnRvciA9IGF3YWl0IGRiLm1lbnRv
cnMuZmluZF9vbmUoeyJtZW50b3JfaWQiOiB1c2VyX2RhdGEubWVudG9yX2lkfSkKICAgICAgICBp
ZiBub3QgZXhpc3RpbmdfbWVudG9yOgogICAgICAgICAgICAjIENyZWF0ZSBtZW50b3IgcmVjb3Jk
IGlmIGl0IGRvZXNuJ3QgZXhpc3QKICAgICAgICAgICAgbWVudG9yX2RvYyA9IHsKICAgICAgICAg
ICAgICAgICJtZW50b3JfaWQiOiB1c2VyX2RhdGEubWVudG9yX2lkLAogICAgICAgICAgICAgICAg
ImNyZWF0ZWRfYXQiOiBkYXRldGltZS51dGNub3coKSwKICAgICAgICAgICAgICAgICJjcmVhdGVk
X2J5IjogInVzZXJfc2lnbnVwIiwKICAgICAgICAgICAgICAgICJhY3RpdmUiOiBUcnVlLAogICAg
ICAgICAgICAgICAgImNvcGllZCI6IEZhbHNlLAogICAgICAgICAgICAgICAgImNvcGllZF9hdCI6
IE5vbmUsCiAgICAgICAgICAgICAgICAidG90YWxfcmVmZXJyYWxzIjogMAogICAgICAgICAgICB9
CiAgICAgICAgICAgIGF3YWl0IGRiLm1lbnRvcnMuaW5zZXJ0X29uZShtZW50b3JfZG9jKQogICAg
CiAgICAjIENyZWF0ZSB1c2VyIHdpdGggcGVuZGluZyBzdGF0dXMgKHJlcXVpcmVzIGFkbWluIGFw
cHJvdmFsKQogICAgaGFzaGVkX3Bhc3N3b3JkID0gZ2V0X3Bhc3N3b3JkX2hhc2godXNlcl9kYXRh
LnBhc3N3b3JkKQogICAgdXNlcl9kb2MgPSB7CiAgICAgICAgImVtYWlsIjogdXNlcl9kYXRhLmVt
YWlsLAogICAgICAgICJwYXNzd29yZF9oYXNoIjogaGFzaGVkX3Bhc3N3b3JkLAogICAgICAgICJu
YW1lIjogdXNlcl9kYXRhLm5hbWUsCiAgICAgICAgIm1lbnRvcl9pZCI6IHVzZXJfZGF0YS5tZW50
b3JfaWQsCiAgICAgICAgImxpY2Vuc2Vfa2V5IjogdXNlcl9kYXRhLmxpY2Vuc2Vfa2V5LAogICAg
ICAgICJzdGF0dXMiOiAicGVuZGluZyIsICAjIENoYW5nZWQgZnJvbSAiYWN0aXZlIiB0byAicGVu
ZGluZyIKICAgICAgICAicGF5bWVudF9zdGF0dXMiOiAidW5wYWlkIiwgICMgTmV3IHVzZXJzIG11
c3QgcGF5CiAgICAgICAgImNyZWF0ZWRfYXQiOiBkYXRldGltZS51dGNub3coKSwKICAgICAgICAi
bGFzdF9sb2dpbiI6IE5vbmUKICAgIH0KICAgIAogICAgcmVzdWx0ID0gYXdhaXQgZGIudXNlcnMu
aW5zZXJ0X29uZSh1c2VyX2RvYykKICAgIHVzZXJfaWQgPSBzdHIocmVzdWx0Lmluc2VydGVkX2lk
KQogICAgCiAgICAjIE1hcmsgbGljZW5zZSBhcyB1c2VkIGFuZCBzdG9yZSB1c2VyIHJlZmVyZW5j
ZQogICAgYXdhaXQgZGIubGljZW5zZXMudXBkYXRlX29uZSgKICAgICAgICB7ImtleSI6IHVzZXJf
ZGF0YS5saWNlbnNlX2tleX0sCiAgICAgICAgeyIkc2V0IjogeyJ1c2VkIjogVHJ1ZSwgInVzZWRf
YnkiOiB1c2VyX2lkLCAidXNlZF9hdCI6IGRhdGV0aW1lLnV0Y25vdygpLCAidXNlcl9lbWFpbCI6
IHVzZXJfZGF0YS5lbWFpbH19CiAgICApCiAgICAKICAgICMgSW5jcmVtZW50IG1lbnRvciByZWZl
cnJhbCBjb3VudAogICAgaWYgdXNlcl9kYXRhLm1lbnRvcl9pZDoKICAgICAgICBhd2FpdCBkYi5t
ZW50b3JzLnVwZGF0ZV9vbmUoCiAgICAgICAgICAgIHsibWVudG9yX2lkIjogdXNlcl9kYXRhLm1l
bnRvcl9pZH0sCiAgICAgICAgICAgIHsiJGluYyI6IHsidG90YWxfcmVmZXJyYWxzIjogMX19CiAg
ICAgICAgKQogICAgCiAgICAjIExvZyBhY3Rpdml0eQogICAgYXdhaXQgZGIudXNlcl9hY3Rpdml0
eS5pbnNlcnRfb25lKHsKICAgICAgICAidXNlcl9pZCI6IHVzZXJfaWQsCiAgICAgICAgImFjdGlv
biI6ICJ1c2VyX3JlZ2lzdGVyZWQiLAogICAgICAgICJkZXRhaWxzIjogeyJlbWFpbCI6IHVzZXJf
ZGF0YS5lbWFpbCwgIm5hbWUiOiB1c2VyX2RhdGEubmFtZSwgIm1lbnRvcl9pZCI6IHVzZXJfZGF0
YS5tZW50b3JfaWQsICJsaWNlbnNlX2tleSI6IHVzZXJfZGF0YS5saWNlbnNlX2tleX0sCiAgICAg
ICAgInRpbWVzdGFtcCI6IGRhdGV0aW1lLnV0Y25vdygpCiAgICB9KQogICAgCiAgICAjIENyZWF0
ZSBhY2Nlc3MgdG9rZW4KICAgIGFjY2Vzc190b2tlbiA9IGNyZWF0ZV9hY2Nlc3NfdG9rZW4oZGF0
YT17InN1YiI6IHVzZXJfaWQsICJ0eXBlIjogInVzZXIifSkKICAgIAogICAgcmV0dXJuIHsKICAg
ICAgICAibWVzc2FnZSI6ICJSZWdpc3RyYXRpb24gc3VjY2Vzc2Z1bC4gUGxlYXNlIGNvbXBsZXRl
IHBheW1lbnQgdG8gcHJvY2VlZC4iLAogICAgICAgICJhY2Nlc3NfdG9rZW4iOiBhY2Nlc3NfdG9r
ZW4sCiAgICAgICAgInRva2VuX3R5cGUiOiAiYmVhcmVyIiwKICAgICAgICAidXNlcl9pZCI6IHVz
ZXJfaWQsCiAgICAgICAgInN0YXR1cyI6ICJwZW5kaW5nIiwKICAgICAgICAicGF5bWVudF9yZXF1
aXJlZCI6IFRydWUsICAjIEZsYWcgdG8gaW5kaWNhdGUgcGF5bWVudCBpcyBuZWVkZWQKICAgICAg
ICAicGF5bWVudF9zdGF0dXMiOiAidW5wYWlkIiwKICAgICAgICAidXNlciI6IHsKICAgICAgICAg
ICAgImVtYWlsIjogdXNlcl9kYXRhLmVtYWlsLAogICAgICAgICAgICAibmFtZSI6IHVzZXJfZGF0
YS5uYW1lLAogICAgICAgICAgICAibWVudG9yX2lkIjogdXNlcl9kYXRhLm1lbnRvcl9pZAogICAg
ICAgIH0KICAgIH0KCkBhcGlfcm91dGVyLnBvc3QoIi9hdXRoL2xvZ2luIiwgcmVzcG9uc2VfbW9k
ZWw9ZGljdCkKYXN5bmMgZGVmIGxvZ2luX3VzZXIobG9naW5fZGF0YTogVXNlckxvZ2luKToKICAg
ICIiIkxvZ2luIHVzZXIiIiIKICAgIGxvZ2dlci5pbmZvKGYi8J+UkCBMb2dpbiBhdHRlbXB0IGZv
cjoge2xvZ2luX2RhdGEuZW1haWx9IikKICAgIHVzZXIgPSBhd2FpdCBkYi51c2Vycy5maW5kX29u
ZSh7ImVtYWlsIjogbG9naW5fZGF0YS5lbWFpbH0pCiAgICAKICAgIGlmIG5vdCB1c2VyOgogICAg
ICAgIGxvZ2dlci53YXJuaW5nKGYi4p2MIFVzZXIgbm90IGZvdW5kOiB7bG9naW5fZGF0YS5lbWFp
bH0iKQogICAgICAgIHJhaXNlIEhUVFBFeGNlcHRpb24oc3RhdHVzX2NvZGU9NDAxLCBkZXRhaWw9
IkludmFsaWQgZW1haWwgb3IgcGFzc3dvcmQiKQogICAgCiAgICBsb2dnZXIuaW5mbyhmIuKchSBV
c2VyIGZvdW5kOiB7dXNlci5nZXQoJ2VtYWlsJyl9IHwgUm9sZToge3VzZXIuZ2V0KCdyb2xlJyl9
IikKICAgIGxvZ2dlci5pbmZvKGYiICAgSGFzIHBhc3N3b3JkX2hhc2g6IHtib29sKHVzZXIuZ2V0
KCdwYXNzd29yZF9oYXNoJykpfSIpCiAgICAKICAgIHBhc3N3b3JkX3ZhbGlkID0gdmVyaWZ5X3Bh
c3N3b3JkKGxvZ2luX2RhdGEucGFzc3dvcmQsIHVzZXJbInBhc3N3b3JkX2hhc2giXSkKICAgIGxv
Z2dlci5pbmZvKGYiICAgUGFzc3dvcmQgdmVyaWZpY2F0aW9uOiB7cGFzc3dvcmRfdmFsaWR9IikK
ICAgIAogICAgaWYgbm90IHBhc3N3b3JkX3ZhbGlkOgogICAgICAgIGxvZ2dlci53YXJuaW5nKGYi
4p2MIEludmFsaWQgcGFzc3dvcmQgZm9yOiB7bG9naW5fZGF0YS5lbWFpbH0iKQogICAgICAgIHJh
aXNlIEhUVFBFeGNlcHRpb24oc3RhdHVzX2NvZGU9NDAxLCBkZXRhaWw9IkludmFsaWQgZW1haWwg
b3IgcGFzc3dvcmQiKQogICAgCiAgICAjIENoZWNrIGFjY291bnQgc3RhdHVzCiAgICBzdGF0dXMg
PSB1c2VyLmdldCgic3RhdHVzIikKICAgIHBheW1lbnRfc3RhdHVzID0gdXNlci5nZXQoInBheW1l
bnRfc3RhdHVzIiwgInVucGFpZCIpCiAgICAKICAgICMgQmxvY2sgb25seSBpZiBkZWFjdGl2YXRl
ZCBieSBhZG1pbgogICAgaWYgc3RhdHVzID09ICJpbmFjdGl2ZSI6CiAgICAgICAgcmFpc2UgSFRU
UEV4Y2VwdGlvbihzdGF0dXNfY29kZT00MDMsIGRldGFpbD0iWW91ciBhY2NvdW50IGhhcyBiZWVu
IGRlYWN0aXZhdGVkLiBQbGVhc2UgY29udGFjdCBzdXBwb3J0LiIpCiAgICAKICAgICMgQWxsb3cg
cGVuZGluZyB1c2VycyB0byBsb2dpbiBJRiB0aGV5IGhhdmUgcGFpZCAoYXV0b21hdGljIGFjdGl2
YXRpb24gc2hvdWxkIGhhdmUgaGFwcGVuZWQpCiAgICAjIElmIHBlbmRpbmcgYnV0IHVucGFpZCwg
dGhleSBuZWVkIHRvIGNvbXBsZXRlIHBheW1lbnQKICAgIGlmIHN0YXR1cyA9PSAicGVuZGluZyIg
YW5kIHBheW1lbnRfc3RhdHVzID09ICJ1bnBhaWQiOgogICAgICAgICMgQWxsb3cgbG9naW4gYnV0
IGZyb250ZW5kIHdpbGwgcmVkaXJlY3QgdG8gcGF5bWVudAogICAgICAgIHBhc3MKICAgIGVsaWYg
c3RhdHVzIG5vdCBpbiBbImFjdGl2ZSIsICJwZW5kaW5nIl06CiAgICAgICAgcmFpc2UgSFRUUEV4
Y2VwdGlvbihzdGF0dXNfY29kZT00MDMsIGRldGFpbD0iQWNjb3VudCBpcyBub3QgYWN0aXZlIikK
ICAgIAogICAgdXNlcl9pZCA9IHN0cih1c2VyWyJfaWQiXSkKICAgIAogICAgIyBVcGRhdGUgbGFz
dCBsb2dpbgogICAgYXdhaXQgZGIudXNlcnMudXBkYXRlX29uZSgKICAgICAgICB7Il9pZCI6IHVz
ZXJbIl9pZCJdfSwKICAgICAgICB7IiRzZXQiOiB7Imxhc3RfbG9naW4iOiBkYXRldGltZS51dGNu
b3coKX19CiAgICApCiAgICAKICAgICMgTG9nIGFjdGl2aXR5CiAgICBhd2FpdCBkYi51c2VyX2Fj
dGl2aXR5Lmluc2VydF9vbmUoewogICAgICAgICJ1c2VyX2lkIjogdXNlcl9pZCwKICAgICAgICAi
YWN0aW9uIjogInVzZXJfbG9naW4iLAogICAgICAgICJkZXRhaWxzIjogeyJlbWFpbCI6IGxvZ2lu
X2RhdGEuZW1haWx9LAogICAgICAgICJ0aW1lc3RhbXAiOiBkYXRldGltZS51dGNub3coKQogICAg
fSkKICAgIAogICAgIyBDcmVhdGUgYWNjZXNzIHRva2VuCiAgICBhY2Nlc3NfdG9rZW4gPSBjcmVh
dGVfYWNjZXNzX3Rva2VuKGRhdGE9eyJzdWIiOiB1c2VyX2lkLCAidHlwZSI6ICJ1c2VyIn0pCiAg
ICAKICAgIHJldHVybiB7CiAgICAgICAgImFjY2Vzc190b2tlbiI6IGFjY2Vzc190b2tlbiwKICAg
ICAgICAidG9rZW5fdHlwZSI6ICJiZWFyZXIiLAogICAgICAgICJ1c2VyX3R5cGUiOiAidXNlciIs
CiAgICAgICAgInVzZXJfaWQiOiB1c2VyX2lkLAogICAgICAgICJ1c2VyIjogewogICAgICAgICAg
ICAiZW1haWwiOiB1c2VyWyJlbWFpbCJdLAogICAgICAgICAgICAibmFtZSI6IHVzZXIuZ2V0KCJu
YW1lIiwgdXNlclsiZW1haWwiXS5zcGxpdCgiQCIpWzBdKSwgICMgRGVmYXVsdCB0byBlbWFpbCBw
cmVmaXggaWYgbm8gbmFtZQogICAgICAgICAgICAibWVudG9yX2lkIjogdXNlci5nZXQoIm1lbnRv
cl9pZCIpLAogICAgICAgICAgICAic3RhdHVzIjogdXNlci5nZXQoInN0YXR1cyIpLAogICAgICAg
ICAgICAicGF5bWVudF9zdGF0dXMiOiB1c2VyLmdldCgicGF5bWVudF9zdGF0dXMiLCAidW5wYWlk
IikKICAgICAgICB9LAogICAgICAgICJwYXltZW50X3N0YXR1cyI6IHBheW1lbnRfc3RhdHVzLCAg
IyBJbmNsdWRlIHBheW1lbnQgc3RhdHVzIGluIHJlc3BvbnNlCiAgICAgICAgInN0YXR1cyI6IHN0
YXR1cywgICMgSW5jbHVkZSBhY2NvdW50IHN0YXR1cwogICAgICAgICJyZXF1aXJlc19wYXltZW50
IjogcGF5bWVudF9zdGF0dXMgIT0gInBhaWQiLCAgIyBGbGFnIGZvciBmcm9udGVuZCByb3V0aW5n
CiAgICAgICAgInJlcXVpcmVzX3Bhc3N3b3JkX2NoYW5nZSI6IHVzZXIuZ2V0KCJyZXF1aXJlc19w
YXNzd29yZF9jaGFuZ2UiLCBGYWxzZSkKICAgIH0KCgpAYXBpX3JvdXRlci5wb3N0KCIvYXV0aC9m
b3Jnb3QtcGFzc3dvcmQiKQphc3luYyBkZWYgZm9yZ290X3Bhc3N3b3JkKGVtYWlsOiBzdHIgPSBC
b2R5KC4uLiwgZW1iZWQ9VHJ1ZSkpOgogICAgIiIiCiAgICBVc2VyLWZhY2luZyBwYXNzd29yZCBy
ZXNldCBlbmRwb2ludC4KICAgIEdlbmVyYXRlcyB0ZW1wb3JhcnkgcGFzc3dvcmQgYW5kIGVtYWls
cyBpdCB0byB0aGUgdXNlci4KICAgICIiIgogICAgdHJ5OgogICAgICAgICMgRmluZCB1c2VyIGJ5
IGVtYWlsCiAgICAgICAgdXNlciA9IGF3YWl0IGRiLnVzZXJzLmZpbmRfb25lKHsiZW1haWwiOiBl
bWFpbC5sb3dlcigpfSkKICAgICAgICAKICAgICAgICBpZiBub3QgdXNlcjoKICAgICAgICAgICAg
IyBEb24ndCByZXZlYWwgaWYgZW1haWwgZXhpc3RzIG9yIG5vdCBmb3Igc2VjdXJpdHkKICAgICAg
ICAgICAgbG9nZ2VyLmluZm8oZiJQYXNzd29yZCByZXNldCBhdHRlbXB0ZWQgZm9yIG5vbi1leGlz
dGVudCBlbWFpbDoge2VtYWlsfSIpCiAgICAgICAgICAgICMgU3RpbGwgcmV0dXJuIHN1Y2Nlc3Mg
dG8gcHJldmVudCBlbWFpbCBlbnVtZXJhdGlvbgogICAgICAgICAgICByZXR1cm4gewogICAgICAg
ICAgICAgICAgIm1lc3NhZ2UiOiAiSWYgYW4gYWNjb3VudCBleGlzdHMgd2l0aCB0aGlzIGVtYWls
LCBhIHRlbXBvcmFyeSBwYXNzd29yZCBoYXMgYmVlbiBzZW50LiIKICAgICAgICAgICAgfQogICAg
ICAgIAogICAgICAgICMgR2VuZXJhdGUgdGVtcG9yYXJ5IHBhc3N3b3JkCiAgICAgICAgdGVtcF9w
YXNzd29yZCA9IGdlbmVyYXRlX3JhbmRvbV9zdHJpbmcoMTIpCiAgICAgICAgcGFzc3dvcmRfaGFz
aCA9IGdldF9wYXNzd29yZF9oYXNoKHRlbXBfcGFzc3dvcmQpCiAgICAgICAgCiAgICAgICAgIyBV
cGRhdGUgdXNlciB3aXRoIG5ldyBwYXNzd29yZCBhbmQgc2V0IHJlcXVpcmVzX3Bhc3N3b3JkX2No
YW5nZSBmbGFnCiAgICAgICAgYXdhaXQgZGIudXNlcnMudXBkYXRlX29uZSgKICAgICAgICAgICAg
eyJfaWQiOiB1c2VyWyJfaWQiXX0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICIkc2V0
IjogewogICAgICAgICAgICAgICAgICAgICJwYXNzd29yZF9oYXNoIjogcGFzc3dvcmRfaGFzaCwK
ICAgICAgICAgICAgICAgICAgICAicmVxdWlyZXNfcGFzc3dvcmRfY2hhbmdlIjogVHJ1ZSwKICAg
ICAgICAgICAgICAgICAgICAicGFzc3dvcmRfcmVzZXRfYXQiOiBkYXRldGltZS51dGNub3coKQog
ICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgKQogICAgICAgIAogICAgICAg
IGxvZ2dlci5pbmZvKGYi4pyFIFBhc3N3b3JkIHJlc2V0IGZvciB1c2VyOiB7ZW1haWx9IikKICAg
ICAgICBsb2dnZXIuaW5mbyhmIvCflJEgVEVNUE9SQVJZIFBBU1NXT1JEIEZPUiB7ZW1haWx9OiB7
dGVtcF9wYXNzd29yZH0iKQogICAgICAgIAogICAgICAgICMgU2VuZCBlbWFpbCB3aXRoIHRlbXBv
cmFyeSBwYXNzd29yZAogICAgICAgIGVtYWlsX3NlbnQgPSBhd2FpdCBlbWFpbF9zZXJ2aWNlLnNl
bmRfcGFzc3dvcmRfcmVzZXRfZW1haWwoCiAgICAgICAgICAgIHRvX2VtYWlsPWVtYWlsLAogICAg
ICAgICAgICB1c2VyX25hbWU9dXNlci5nZXQoIm5hbWUiLCAiVXNlciIpLAogICAgICAgICAgICB0
ZW1wb3JhcnlfcGFzc3dvcmQ9dGVtcF9wYXNzd29yZAogICAgICAgICkKICAgICAgICAKICAgICAg
ICBpZiBlbWFpbF9zZW50OgogICAgICAgICAgICBsb2dnZXIuaW5mbyhmIuKchSBQYXNzd29yZCBy
ZXNldCBlbWFpbCBzZW50IHRvOiB7ZW1haWx9IikKICAgICAgICBlbHNlOgogICAgICAgICAgICBs
b2dnZXIud2FybmluZyhmIuKaoO+4jyBFbWFpbCBzZXJ2aWNlIHVuYXZhaWxhYmxlLCBidXQgcGFz
c3dvcmQgd2FzIHJlc2V0IGZvcjoge2VtYWlsfSIpCiAgICAgICAgICAgIGxvZ2dlci53YXJuaW5n
KGYi8J+TpyBNQU5VQUwgQUNUSU9OIFJFUVVJUkVEOiBTZW5kIHRoaXMgcGFzc3dvcmQgdG8ge2Vt
YWlsfToge3RlbXBfcGFzc3dvcmR9IikKICAgICAgICAKICAgICAgICAjIExvZyBhY3Rpdml0eQog
ICAgICAgIGF3YWl0IGRiLnVzZXJfYWN0aXZpdHkuaW5zZXJ0X29uZSh7CiAgICAgICAgICAgICJ1
c2VyX2lkIjogc3RyKHVzZXJbIl9pZCJdKSwKICAgICAgICAgICAgImFjdGlvbiI6ICJwYXNzd29y
ZF9yZXNldF9yZXF1ZXN0ZWQiLAogICAgICAgICAgICAiZGV0YWlscyI6IHsiZW1haWwiOiBlbWFp
bCwgImVtYWlsX3NlbnQiOiBlbWFpbF9zZW50fSwKICAgICAgICAgICAgInRpbWVzdGFtcCI6IGRh
dGV0aW1lLnV0Y25vdygpCiAgICAgICAgfSkKICAgICAgICAKICAgICAgICByZXR1cm4gewogICAg
ICAgICAgICAibWVzc2FnZSI6ICJJZiBhbiBhY2NvdW50IGV4aXN0cyB3aXRoIHRoaXMgZW1haWws
IGEgdGVtcG9yYXJ5IHBhc3N3b3JkIGhhcyBiZWVuIHNlbnQuIiwKICAgICAgICAgICAgImVtYWls
X3NlbnQiOiBlbWFpbF9zZW50CiAgICAgICAgfQogICAgICAgIAogICAgZXhjZXB0IEV4Y2VwdGlv
biBhcyBlOgogICAgICAgIGxvZ2dlci5lcnJvcihmIkVycm9yIGluIG1lbnRvciBmb3Jnb3QgcGFz
c3dvcmQ6IHtzdHIoZSl9IikKICAgICAgICByYWlzZSBIVFRQRXhjZXB0aW9uKHN0YXR1c19jb2Rl
PTUwMCwgZGV0YWlsPSJGYWlsZWQgdG8gcHJvY2VzcyBwYXNzd29yZCByZXNldCIpCgoKQGFwaV9y
b3V0ZXIucG9zdCgiL2F1dGgvcmVzZXQtcGFzc3dvcmQtd2l0aC1saWNlbnNlIikKYXN5bmMgZGVm
IHJlc2V0X3Bhc3N3b3JkX3dpdGhfbGljZW5zZV9rZXkoZW1haWw6IHN0ciA9IEJvZHkoLi4uKSwg
bGljZW5zZV9rZXk6IHN0ciA9IEJvZHkoLi4uKSk6CiAgICAiIiIKICAgIFJlc2V0IHBhc3N3b3Jk
IHVzaW5nIGVtYWlsIGFuZCBsaWNlbnNlIGtleS4KICAgIFRoaXMgYWxsb3dzIHVzZXJzIHRvIHJl
c2V0IHRoZWlyIHBhc3N3b3JkIGlmIHRoZXkgaGF2ZSB0aGVpciBsaWNlbnNlIGtleS4KICAgICIi
IgogICAgdHJ5OgogICAgICAgICMgRmluZCB1c2VyIHdpdGggbWF0Y2hpbmcgZW1haWwgYW5kIGxp
Y2Vuc2Uga2V5CiAgICAgICAgdXNlciA9IGF3YWl0IGRiLnVzZXJzLmZpbmRfb25lKHsKICAgICAg
ICAgICAgImVtYWlsIjogZW1haWwubG93ZXIoKSwKICAgICAgICAgICAgImxpY2Vuc2Vfa2V5Ijog
bGljZW5zZV9rZXkudXBwZXIoKSAgIyBMaWNlbnNlIGtleXMgYXJlIHR5cGljYWxseSB1cHBlcmNh
c2UKICAgICAgICB9KQogICAgICAgIAogICAgICAgIGlmIG5vdCB1c2VyOgogICAgICAgICAgICAj
IERvbid0IHJldmVhbCBpZiB1c2VyIGV4aXN0cyBmb3Igc2VjdXJpdHkKICAgICAgICAgICAgbG9n
Z2VyLmluZm8oZiJQYXNzd29yZCByZXNldCBhdHRlbXB0ZWQgd2l0aCBpbnZhbGlkIGVtYWlsL2xp
Y2Vuc2U6IHtlbWFpbH0iKQogICAgICAgICAgICAjIFN0aWxsIHJldHVybiBzdWNjZXNzIHRvIHBy
ZXZlbnQgZW51bWVyYXRpb24KICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgICJt
ZXNzYWdlIjogIklmIHRoZSBlbWFpbCBhbmQgbGljZW5zZSBrZXkgbWF0Y2ggYW4gYWNjb3VudCwg
YSB0ZW1wb3JhcnkgcGFzc3dvcmQgaGFzIGJlZW4gZ2VuZXJhdGVkLiIsCiAgICAgICAgICAgICAg
ICAic3VjY2VzcyI6IEZhbHNlCiAgICAgICAgICAgIH0KICAgICAgICAKICAgICAgICAjIEdlbmVy
YXRlIHRlbXBvcmFyeSBwYXNzd29yZAogICAgICAgIHRlbXBfcGFzc3dvcmQgPSBnZW5lcmF0ZV9y
YW5kb21fc3RyaW5nKDEyKQogICAgICAgIHBhc3N3b3JkX2hhc2ggPSBnZXRfcGFzc3dvcmRfaGFz
aCh0ZW1wX3Bhc3N3b3JkKQogICAgICAgIAogICAgICAgICMgVXBkYXRlIHVzZXIgcGFzc3dvcmQK
ICAgICAgICBhd2FpdCBkYi51c2Vycy51cGRhdGVfb25lKAogICAgICAgICAgICB7Il9pZCI6IHVz
ZXJbIl9pZCJdfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgIiRzZXQiOiB7CiAgICAg
ICAgICAgICAgICAgICAgInBhc3N3b3JkX2hhc2giOiBwYXNzd29yZF9oYXNoLAogICAgICAgICAg
ICAgICAgICAgICJyZXF1aXJlc19wYXNzd29yZF9jaGFuZ2UiOiBUcnVlLAogICAgICAgICAgICAg
ICAgICAgICJwYXNzd29yZF9yZXNldF9hdCI6IGRhdGV0aW1lLnV0Y25vdygpLAogICAgICAgICAg
ICAgICAgICAgICJwYXNzd29yZF9yZXNldF9tZXRob2QiOiAibGljZW5zZV9rZXkiCiAgICAgICAg
ICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICApCiAgICAgICAgCiAgICAgICAgbG9nZ2Vy
LmluZm8oZiLinIUgUGFzc3dvcmQgcmVzZXQgdmlhIGxpY2Vuc2Uga2V5IGZvciB1c2VyOiB7ZW1h
aWx9IikKICAgICAgICBsb2dnZXIuaW5mbyhmIvCflJEgVEVNUE9SQVJZIFBBU1NXT1JEIEZPUiB7
ZW1haWx9OiB7dGVtcF9wYXNzd29yZH0iKQogICAgICAgIAogICAgICAgICMgU2VuZCBlbWFpbCB3
aXRoIHRlbXBvcmFyeSBwYXNzd29yZAogICAgICAgIGVtYWlsX3NlbnQgPSBhd2FpdCBlbWFpbF9z
ZXJ2aWNlLnNlbmRfcGFzc3dvcmRfcmVzZXRfZW1haWwoCiAgICAgICAgICAgIHRvX2VtYWlsPWVt
YWlsLAogICAgICAgICAgICB1c2VyX25hbWU9dXNlci5nZXQoIm5hbWUiLCAiVXNlciIpLAogICAg
ICAgICAgICB0ZW1wb3JhcnlfcGFzc3dvcmQ9dGVtcF9wYXNzd29yZAogICAgICAgICkKICAgICAg
ICAKICAgICAgICBpZiBlbWFpbF9zZW50OgogICAgICAgICAgICBsb2dnZXIuaW5mbyhmIuKchSBQ
YXNzd29yZCByZXNldCBlbWFpbCBzZW50IHRvOiB7ZW1haWx9IikKICAgICAgICBlbHNlOgogICAg
ICAgICAgICBsb2dnZXIud2FybmluZyhmIuKaoO+4jyBFbWFpbCBzZXJ2aWNlIHVuYXZhaWxhYmxl
LCBidXQgcGFzc3dvcmQgd2FzIHJlc2V0IGZvcjoge2VtYWlsfSIpCiAgICAgICAgICAgIGxvZ2dl
ci53YXJuaW5nKGYi8J+TpyBNQU5VQUwgQUNUSU9OIFJFUVVJUkVEOiBTZW5kIHRoaXMgcGFzc3dv
cmQgdG8ge2VtYWlsfToge3RlbXBfcGFzc3dvcmR9IikKICAgICAgICAKICAgICAgICAjIExvZyBh
Y3Rpdml0eQogICAgICAgIGF3YWl0IGRiLnVzZXJfYWN0aXZpdHkuaW5zZXJ0X29uZSh7CiAgICAg
ICAgICAgICJ1c2VyX2lkIjogc3RyKHVzZXJbIl9pZCJdKSwKICAgICAgICAgICAgImFjdGlvbiI6
ICJwYXNzd29yZF9yZXNldF92aWFfbGljZW5zZV9rZXkiLAogICAgICAgICAgICAiZGV0YWlscyI6
IHsKICAgICAgICAgICAgICAgICJlbWFpbCI6IGVtYWlsLAogICAgICAgICAgICAgICAgImxpY2Vu
c2Vfa2V5IjogbGljZW5zZV9rZXksCiAgICAgICAgICAgICAgICAiZW1haWxfc2VudCI6IGVtYWls
X3NlbnQKICAgICAgICAgICAgfSwKICAgICAgICAgICAgInRpbWVzdGFtcCI6IGRhdGV0aW1lLnV0
Y25vdygpCiAgICAgICAgfSkKICAgICAgICAKICAgICAgICByZXR1cm4gewogICAgICAgICAgICAi
bWVzc2FnZSI6ICJQYXNzd29yZCByZXNldCBzdWNjZXNzZnVsbHkhIEEgdGVtcG9yYXJ5IHBhc3N3
b3JkIGhhcyBiZWVuIGdlbmVyYXRlZC4iLAogICAgICAgICAgICAic3VjY2VzcyI6IFRydWUsCiAg
ICAgICAgICAgICJ0ZW1wb3JhcnlfcGFzc3dvcmQiOiB0ZW1wX3Bhc3N3b3JkLAogICAgICAgICAg
ICAiZW1haWxfc2VudCI6IGVtYWlsX3NlbnQsCiAgICAgICAgICAgICJ1c2VyX2VtYWlsIjogZW1h
aWwKICAgICAgICB9CiAgICAgICAgCiAgICBleGNlcHQgSFRUUEV4Y2VwdGlvbjoKICAgICAgICBy
YWlzZQogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIGxvZ2dlci5lcnJvcihmIkVy
cm9yIGluIGxpY2Vuc2Uga2V5IHBhc3N3b3JkIHJlc2V0OiB7c3RyKGUpfSIpCiAgICAgICAgcmFp
c2UgSFRUUEV4Y2VwdGlvbihzdGF0dXNfY29kZT01MDAsIGRldGFpbD0iRmFpbGVkIHRvIHByb2Nl
c3MgcGFzc3dvcmQgcmVzZXQiKQoKCkBhcGlfcm91dGVyLnBvc3QoIi9hdXRoL3Jlc2V0LXBhc3N3
b3JkLXdpdGgtbGljZW5zZS1kaXJlY3QiKQphc3luYyBkZWYgcmVzZXRfcGFzc3dvcmRfd2l0aF9s
aWNlbnNlX2RpcmVjdCgKICAgIGVtYWlsOiBzdHIgPSBCb2R5KC4uLiksCiAgICBsaWNlbnNlX2tl
eTogc3RyID0gQm9keSguLi4pLAogICAgbmV3X3Bhc3N3b3JkOiBzdHIgPSBCb2R5KC4uLikKKToK
ICAgICIiIgogICAgUmVzZXQgcGFzc3dvcmQgZGlyZWN0bHkgd2l0aCBlbWFpbCwgbGljZW5zZSBr
ZXksIGFuZCBuZXcgcGFzc3dvcmQuCiAgICBVc2VyIHByb3ZpZGVzIHRoZWlyIG5ldyBwYXNzd29y
ZCBkaXJlY3RseSAtIG5vIHRlbXBvcmFyeSBwYXNzd29yZCBuZWVkZWQuCiAgICAiIiIKICAgIHRy
eToKICAgICAgICAjIFZhbGlkYXRlIG5ldyBwYXNzd29yZAogICAgICAgIGlmIGxlbihuZXdfcGFz
c3dvcmQpIDwgODoKICAgICAgICAgICAgcmFpc2UgSFRUUEV4Y2VwdGlvbihzdGF0dXNfY29kZT00
MDAsIGRldGFpbD0iUGFzc3dvcmQgbXVzdCBiZSBhdCBsZWFzdCA4IGNoYXJhY3RlcnMgbG9uZyIp
CiAgICAgICAgCiAgICAgICAgIyBGaW5kIHVzZXIgd2l0aCBtYXRjaGluZyBlbWFpbCBhbmQgbGlj
ZW5zZSBrZXkKICAgICAgICB1c2VyID0gYXdhaXQgZGIudXNlcnMuZmluZF9vbmUoewogICAgICAg
ICAgICAiZW1haWwiOiBlbWFpbC5sb3dlcigpLAogICAgICAgICAgICAibGljZW5zZV9rZXkiOiBs
aWNlbnNlX2tleS51cHBlcigpCiAgICAgICAgfSkKICAgICAgICAKICAgICAgICBpZiBub3QgdXNl
cjoKICAgICAgICAgICAgIyBEb24ndCByZXZlYWwgaWYgdXNlciBleGlzdHMgZm9yIHNlY3VyaXR5
CiAgICAgICAgICAgIGxvZ2dlci5pbmZvKGYiUGFzc3dvcmQgcmVzZXQgYXR0ZW1wdGVkIHdpdGgg
aW52YWxpZCBlbWFpbC9saWNlbnNlOiB7ZW1haWx9IikKICAgICAgICAgICAgcmV0dXJuIHsKICAg
ICAgICAgICAgICAgICJtZXNzYWdlIjogIklmIHRoZSBlbWFpbCBhbmQgbGljZW5zZSBrZXkgbWF0
Y2ggYW4gYWNjb3VudCwgeW91ciBwYXNzd29yZCBoYXMgYmVlbiByZXNldC4iLAogICAgICAgICAg
ICAgICAgInN1Y2Nlc3MiOiBGYWxzZQogICAgICAgICAgICB9CiAgICAgICAgCiAgICAgICAgIyBI
YXNoIHRoZSBuZXcgcGFzc3dvcmQKICAgICAgICBwYXNzd29yZF9oYXNoID0gZ2V0X3Bhc3N3b3Jk
X2hhc2gobmV3X3Bhc3N3b3JkKQogICAgICAgIAogICAgICAgICMgVXBkYXRlIHVzZXIgcGFzc3dv
cmQKICAgICAgICBhd2FpdCBkYi51c2Vycy51cGRhdGVfb25lKAogICAgICAgICAgICB7Il9pZCI6
IHVzZXJbIl9pZCJdfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgIiRzZXQiOiB7CiAg
ICAgICAgICAgICAgICAgICAgInBhc3N3b3JkX2hhc2giOiBwYXNzd29yZF9oYXNoLAogICAgICAg
ICAgICAgICAgICAgICJyZXF1aXJlc19wYXNzd29yZF9jaGFuZ2UiOiBGYWxzZSwKICAgICAgICAg
ICAgICAgICAgICAicGFzc3dvcmRfcmVzZXRfYXQiOiBkYXRldGltZS51dGNub3coKSwKICAgICAg
ICAgICAgICAgICAgICAicGFzc3dvcmRfcmVzZXRfbWV0aG9kIjogImxpY2Vuc2Vfa2V5X2RpcmVj
dCIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICkKICAgICAgICAKICAg
ICAgICBsb2dnZXIuaW5mbyhmIuKchSBQYXNzd29yZCByZXNldCBkaXJlY3RseSB2aWEgbGljZW5z
ZSBrZXkgZm9yIHVzZXI6IHtlbWFpbH0iKQogICAgICAgIGxvZ2dlci5pbmZvKGYi8J+UkSBVc2Vy
IGNhbiBub3cgbG9naW4gd2l0aCB0aGVpciBuZXcgcGFzc3dvcmQ6IHtlbWFpbH0iKQogICAgICAg
IAogICAgICAgICMgTG9nIGFjdGl2aXR5CiAgICAgICAgYXdhaXQgZGIudXNlcl9hY3Rpdml0eS5p
bnNlcnRfb25lKHsKICAgICAgICAgICAgInVzZXJfaWQiOiBzdHIodXNlclsiX2lkIl0pLAogICAg
ICAgICAgICAiYWN0aW9uIjogInBhc3N3b3JkX3Jlc2V0X2RpcmVjdF92aWFfbGljZW5zZV9rZXki
LAogICAgICAgICAgICAiZGV0YWlscyI6IHsKICAgICAgICAgICAgICAgICJlbWFpbCI6IGVtYWls
LAogICAgICAgICAgICAgICAgImxpY2Vuc2Vfa2V5IjogbGljZW5zZV9rZXkKICAgICAgICAgICAg
fSwKICAgICAgICAgICAgInRpbWVzdGFtcCI6IGRhdGV0aW1lLnV0Y25vdygpCiAgICAgICAgfSkK
ICAgICAgICAKICAgICAgICByZXR1cm4gewogICAgICAgICAgICAibWVzc2FnZSI6ICJQYXNzd29y
ZCByZXNldCBzdWNjZXNzZnVsbHkhIFlvdSBjYW4gbm93IGxvZ2luIHdpdGggeW91ciBuZXcgcGFz
c3dvcmQuIiwKICAgICAgICAgICAgInN1Y2Nlc3MiOiBUcnVlLAogICAgICAgICAgICAidXNlcl9l
bWFpbCI6IGVtYWlsCiAgICAgICAgfQogICAgICAgIAogICAgZXhjZXB0IEhUVFBFeGNlcHRpb246
CiAgICAgICAgcmFpc2UKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICBsb2dnZXIu
ZXJyb3IoZiJFcnJvciBpbiBkaXJlY3QgbGljZW5zZSBrZXkgcGFzc3dvcmQgcmVzZXQ6IHtzdHIo
ZSl9IikKICAgICAgICByYWlzZSBIVFRQRXhjZXB0aW9uKHN0YXR1c19jb2RlPTUwMCwgZGV0YWls
PSJGYWlsZWQgdG8gcHJvY2VzcyBwYXNzd29yZCByZXNldCIpCgoKQGFwaV9yb3V0ZXIucG9zdCgi
L2F1dGgvcmVzZXQtcGFzc3dvcmQtbGljZW5zZS1vbmx5IikKYXN5bmMgZGVmIHJlc2V0X3Bhc3N3
b3JkX2xpY2Vuc2Vfb25seSgKICAgIGVtYWlsOiBzdHIgPSBCb2R5KC4uLiksCiAgICBsaWNlbnNl
X2tleTogc3RyID0gQm9keSguLi4pLAogICAgbmV3X3Bhc3N3b3JkOiBzdHIgPSBCb2R5KC4uLikK
KToKICAgICIiIgogICAgUmVzZXQgcGFzc3dvcmQgdXNpbmcgZW1haWwgKyBsaWNlbnNlIGtleSAr
IG5ldyBwYXNzd29yZC4KICAgIEVtYWlsIGlkZW50aWZpZXMgdGhlIHVzZXIsIGxpY2Vuc2Uga2V5
IGF1dGhvcml6ZXMgdGhlIHJlc2V0LgogICAgV29ya3MgZm9yIGJvdGggdXNlcnMgYW5kIG1lbnRv
cnMuCiAgICBSZXR1cm5zIEpXVCB0b2tlbiBmb3IgYXV0by1sb2dpbi4KICAgICIiIgogICAgdHJ5
OgogICAgICAgICMgVmFsaWRhdGUgaW5wdXRzIGFyZSBub3QgZW1wdHkKICAgICAgICBpZiBub3Qg
ZW1haWwgb3Igbm90IGVtYWlsLnN0cmlwKCk6CiAgICAgICAgICAgIHJhaXNlIEhUVFBFeGNlcHRp
b24oc3RhdHVzX2NvZGU9NDIyLCBkZXRhaWw9IkVtYWlsIGlzIHJlcXVpcmVkIikKICAgICAgICAK
ICAgICAgICBpZiBub3QgbGljZW5zZV9rZXkgb3Igbm90IGxpY2Vuc2Vfa2V5LnN0cmlwKCk6CiAg
ICAgICAgICAgIHJhaXNlIEhUVFBFeGNlcHRpb24oc3RhdHVzX2NvZGU9NDIyLCBkZXRhaWw9Ikxp
Y2Vuc2Uga2V5IGlzIHJlcXVpcmVkIikKICAgICAgICAKICAgICAgICBpZiBub3QgbmV3X3Bhc3N3
b3JkIG9yIG5vdCBuZXdfcGFzc3dvcmQuc3RyaXAoKToKICAgICAgICAgICAgcmFpc2UgSFRUUEV4
Y2VwdGlvbihzdGF0dXNfY29kZT00MjIsIGRldGFpbD0iTmV3IHBhc3N3b3JkIGlzIHJlcXVpcmVk
IikKICAgICAgICAKICAgICAgICAjIFRyaW0gd2hpdGVzcGFjZSBhbmQgdmFsaWRhdGUgcGFzc3dv
cmQgbGVuZ3RoCiAgICAgICAgZW1haWwgPSBlbWFpbC5zdHJpcCgpCiAgICAgICAgbGljZW5zZV9r
ZXkgPSBsaWNlbnNlX2tleS5zdHJpcCgpCiAgICAgICAgbmV3X3Bhc3N3b3JkID0gbmV3X3Bhc3N3
b3JkLnN0cmlwKCkKICAgICAgICAKICAgICAgICBpZiBsZW4obmV3X3Bhc3N3b3JkKSA8IDg6CiAg
ICAgICAgICAgIHJhaXNlIEhUVFBFeGNlcHRpb24oc3RhdHVzX2NvZGU9NDAwLCBkZXRhaWw9IlBh
c3N3b3JkIG11c3QgYmUgYXQgbGVhc3QgOCBjaGFyYWN0ZXJzIGxvbmciKQogICAgICAgIAogICAg
ICAgICMgVHJ5IHRvIGZpbmQgdXNlciBmaXJzdCB3aXRoIEJPVEggZW1haWwgYW5kIGxpY2Vuc2Ug
a2V5CiAgICAgICAgdXNlciA9IGF3YWl0IGRiLnVzZXJzLmZpbmRfb25lKHsKICAgICAgICAgICAg
ImVtYWlsIjogZW1haWwubG93ZXIoKSwKICAgICAgICAgICAgImxpY2Vuc2Vfa2V5IjogbGljZW5z
ZV9rZXkudXBwZXIoKQogICAgICAgIH0pCiAgICAgICAgdXNlcl90eXBlID0gInVzZXIiCiAgICAg
ICAgCiAgICAgICAgIyBJZiBub3QgZm91bmQgaW4gdXNlcnMsIHRyeSBtZW50b3JzCiAgICAgICAg
aWYgbm90IHVzZXI6CiAgICAgICAgICAgIHVzZXIgPSBhd2FpdCBkYi5tZW50b3JzLmZpbmRfb25l
KHsKICAgICAgICAgICAgICAgICJlbWFpbCI6IGVtYWlsLmxvd2VyKCksCiAgICAgICAgICAgICAg
ICAibGljZW5zZV9rZXkiOiBsaWNlbnNlX2tleS51cHBlcigpCiAgICAgICAgICAgIH0pCiAgICAg
ICAgICAgIHVzZXJfdHlwZSA9ICJtZW50b3IiCiAgICAgICAgCiAgICAgICAgIyBJZiBzdGlsbCBu
b3QgZm91bmQsIHJldHVybiBlcnJvcgogICAgICAgIGlmIG5vdCB1c2VyOgogICAgICAgICAgICBs
b2dnZXIuaW5mbyhmIlBhc3N3b3JkIHJlc2V0IGF0dGVtcHRlZCB3aXRoIGludmFsaWQgZW1haWwv
bGljZW5zZToge2VtYWlsfSIpCiAgICAgICAgICAgIHJhaXNlIEhUVFBFeGNlcHRpb24oc3RhdHVz
X2NvZGU9NDA0LCBkZXRhaWw9IkludmFsaWQgZW1haWwgb3IgbGljZW5zZSBrZXkgY29tYmluYXRp
b24iKQogICAgICAgIAogICAgICAgICMgSGFzaCB0aGUgbmV3IHBhc3N3b3JkCiAgICAgICAgcGFz
c3dvcmRfaGFzaCA9IGdldF9wYXNzd29yZF9oYXNoKG5ld19wYXNzd29yZCkKICAgICAgICAKICAg
ICAgICAjIFVwZGF0ZSBwYXNzd29yZCBpbiB0aGUgYXBwcm9wcmlhdGUgY29sbGVjdGlvbgogICAg
ICAgIGNvbGxlY3Rpb24gPSBkYi51c2VycyBpZiB1c2VyX3R5cGUgPT0gInVzZXIiIGVsc2UgZGIu
bWVudG9ycwogICAgICAgIGF3YWl0IGNvbGxlY3Rpb24udXBkYXRlX29uZSgKICAgICAgICAgICAg
eyJfaWQiOiB1c2VyWyJfaWQiXX0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICIkc2V0
IjogewogICAgICAgICAgICAgICAgICAgICJwYXNzd29yZF9oYXNoIjogcGFzc3dvcmRfaGFzaCwK
ICAgICAgICAgICAgICAgICAgICAicmVxdWlyZXNfcGFzc3dvcmRfY2hhbmdlIjogRmFsc2UsCiAg
ICAgICAgICAgICAgICAgICAgInBhc3N3b3JkX3Jlc2V0X2F0IjogZGF0ZXRpbWUudXRjbm93KCks
CiAgICAgICAgICAgICAgICAgICAgInBhc3N3b3JkX3Jlc2V0X21ldGhvZCI6ICJlbWFpbF9saWNl
bnNlX2tleSIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICkKICAgICAg
ICAKICAgICAgICBsb2dnZXIuaW5mbyhmIuKchSBQYXNzd29yZCByZXNldCB2aWEgZW1haWwrbGlj
ZW5zZSBmb3Ige3VzZXJfdHlwZX06IHt1c2VyLmdldCgnZW1haWwnLCAnTi9BJyl9IikKICAgICAg
ICAKICAgICAgICAjIExvZyBhY3Rpdml0eQogICAgICAgIGFjdGl2aXR5X2NvbGxlY3Rpb24gPSBk
Yi51c2VyX2FjdGl2aXR5IGlmIHVzZXJfdHlwZSA9PSAidXNlciIgZWxzZSBkYi5tZW50b3JfYWN0
aXZpdHkKICAgICAgICBhd2FpdCBhY3Rpdml0eV9jb2xsZWN0aW9uLmluc2VydF9vbmUoewogICAg
ICAgICAgICAidXNlcl9pZCI6IHN0cih1c2VyWyJfaWQiXSksCiAgICAgICAgICAgICJhY3Rpb24i
OiAicGFzc3dvcmRfcmVzZXRfdmlhX2VtYWlsX2xpY2Vuc2Vfa2V5IiwKICAgICAgICAgICAgImRl
dGFpbHMiOiB7CiAgICAgICAgICAgICAgICAiZW1haWwiOiBlbWFpbCwKICAgICAgICAgICAgICAg
ICJsaWNlbnNlX2tleSI6IGxpY2Vuc2Vfa2V5LAogICAgICAgICAgICAgICAgInVzZXJfdHlwZSI6
IHVzZXJfdHlwZQogICAgICAgICAgICB9LAogICAgICAgICAgICAidGltZXN0YW1wIjogZGF0ZXRp
bWUudXRjbm93KCkKICAgICAgICB9KQogICAgICAgIAogICAgICAgICMgR2VuZXJhdGUgSldUIHRv
a2VuIGZvciBhdXRvLWxvZ2luCiAgICAgICAgYWNjZXNzX3Rva2VuID0gY3JlYXRlX2FjY2Vzc190
b2tlbigKICAgICAgICAgICAgZGF0YT17CiAgICAgICAgICAgICAgICAic3ViIjogc3RyKHVzZXJb
Il9pZCJdKSwKICAgICAgICAgICAgICAgICJ0eXBlIjogdXNlcl90eXBlCiAgICAgICAgICAgIH0K
ICAgICAgICApCiAgICAgICAgCiAgICAgICAgIyBQcmVwYXJlIHVzZXIgZGF0YSBmb3IgcmVzcG9u
c2UKICAgICAgICB1c2VyX2RhdGEgPSB7CiAgICAgICAgICAgICJ1c2VyX2lkIjogc3RyKHVzZXJb
Il9pZCJdKSwKICAgICAgICAgICAgImVtYWlsIjogdXNlci5nZXQoImVtYWlsIiwgIiIpLAogICAg
ICAgICAgICAibmFtZSI6IHVzZXIuZ2V0KCJuYW1lIiwgIiIpLAogICAgICAgICAgICAidXNlcl90
eXBlIjogdXNlcl90eXBlLAogICAgICAgICAgICAic3RhdHVzIjogdXNlci5nZXQoInN0YXR1cyIs
ICJhY3RpdmUiKSwKICAgICAgICAgICAgInBheW1lbnRfc3RhdHVzIjogdXNlci5nZXQoInBheW1l
bnRfc3RhdHVzIiwgInBhaWQiKSwKICAgICAgICAgICAgIm1lbnRvcl9pZCI6IHVzZXIuZ2V0KCJt
ZW50b3JfaWQiLCAiIikKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgcmV0dXJuIHsKICAgICAg
ICAgICAgIm1lc3NhZ2UiOiAiUGFzc3dvcmQgcmVzZXQgc3VjY2Vzc2Z1bCEgWW91IGFyZSBub3cg
bG9nZ2VkIGluLiIsCiAgICAgICAgICAgICJzdWNjZXNzIjogVHJ1ZSwKICAgICAgICAgICAgImFj
Y2Vzc190b2tlbiI6IGFjY2Vzc190b2tlbiwKICAgICAgICAgICAgInRva2VuX3R5cGUiOiAiYmVh
cmVyIiwKICAgICAgICAgICAgInVzZXIiOiB1c2VyX2RhdGEsCiAgICAgICAgICAgICJyZXF1aXJl
c19wYXltZW50IjogdXNlci5nZXQoInBheW1lbnRfc3RhdHVzIikgIT0gInBhaWQiLAogICAgICAg
ICAgICAicmVxdWlyZXNfcGFzc3dvcmRfY2hhbmdlIjogRmFsc2UKICAgICAgICB9CiAgICAgICAg
CiAgICBleGNlcHQgSFRUUEV4Y2VwdGlvbjoKICAgICAgICByYWlzZQogICAgZXhjZXB0IEV4Y2Vw
dGlvbiBhcyBlOgogICAgICAgIGxvZ2dlci5lcnJvcihmIkVycm9yIGluIGxpY2Vuc2Utb25seSBw
YXNzd29yZCByZXNldDoge3N0cihlKX0iKQogICAgICAgIHJhaXNlIEhUVFBFeGNlcHRpb24oc3Rh
dHVzX2NvZGU9NTAwLCBkZXRhaWw9IkZhaWxlZCB0byBwcm9jZXNzIHBhc3N3b3JkIHJlc2V0IikK
CgpAYXBpX3JvdXRlci5wb3N0KCIvbWVudG9yL2ZvcmdvdC1wYXNzd29yZCIpCmFzeW5jIGRlZiBt
ZW50b3JfZm9yZ290X3Bhc3N3b3JkKGVtYWlsOiBzdHIgPSBCb2R5KC4uLiwgZW1iZWQ9VHJ1ZSkp
OgogICAgIiIiCiAgICBNZW50b3IgcGFzc3dvcmQgcmVzZXQgZW5kcG9pbnQuCiAgICBHZW5lcmF0
ZXMgdGVtcG9yYXJ5IHBhc3N3b3JkIGFuZCBlbWFpbHMgaXQgdG8gdGhlIG1lbnRvci4KICAgICIi
IgogICAgdHJ5OgogICAgICAgICMgRmluZCBtZW50b3IgYnkgZW1haWwKICAgICAgICBtZW50b3Ig
PSBhd2FpdCBkYi5tZW50b3JzLmZpbmRfb25lKHsiZW1haWwiOiBlbWFpbC5sb3dlcigpfSkKICAg
ICAgICAKICAgICAgICBpZiBub3QgbWVudG9yOgogICAgICAgICAgICAjIERvbid0IHJldmVhbCBp
ZiBlbWFpbCBleGlzdHMgb3Igbm90IGZvciBzZWN1cml0eQogICAgICAgICAgICBsb2dnZXIuaW5m
byhmIlBhc3N3b3JkIHJlc2V0IGF0dGVtcHRlZCBmb3Igbm9uLWV4aXN0ZW50IG1lbnRvciBlbWFp
bDoge2VtYWlsfSIpCiAgICAgICAgICAgICMgU3RpbGwgcmV0dXJuIHN1Y2Nlc3MgdG8gcHJldmVu
dCBlbWFpbCBlbnVtZXJhdGlvbgogICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAg
Im1lc3NhZ2UiOiAiSWYgYSBtZW50b3IgYWNjb3VudCBleGlzdHMgd2l0aCB0aGlzIGVtYWlsLCBh
IHRlbXBvcmFyeSBwYXNzd29yZCBoYXMgYmVlbiBzZW50LiIKICAgICAgICAgICAgfQogICAgICAg
IAogICAgICAgICMgR2VuZXJhdGUgdGVtcG9yYXJ5IHBhc3N3b3JkCiAgICAgICAgdGVtcF9wYXNz
d29yZCA9IGdlbmVyYXRlX3JhbmRvbV9zdHJpbmcoMTIpCiAgICAgICAgcGFzc3dvcmRfaGFzaCA9
IGdldF9wYXNzd29yZF9oYXNoKHRlbXBfcGFzc3dvcmQpCiAgICAgICAgCiAgICAgICAgIyBVcGRh
dGUgbWVudG9yIHdpdGggbmV3IHBhc3N3b3JkCiAgICAgICAgYXdhaXQgZGIubWVudG9ycy51cGRh
dGVfb25lKAogICAgICAgICAgICB7Il9pZCI6IG1lbnRvclsiX2lkIl19LAogICAgICAgICAgICB7
CiAgICAgICAgICAgICAgICAiJHNldCI6IHsKICAgICAgICAgICAgICAgICAgICAicGFzc3dvcmRf
aGFzaCI6IHBhc3N3b3JkX2hhc2gsCiAgICAgICAgICAgICAgICAgICAgInBhc3N3b3JkX3Jlc2V0
X2F0IjogZGF0ZXRpbWUudXRjbm93KCkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQog
ICAgICAgICkKICAgICAgICAKICAgICAgICBsb2dnZXIuaW5mbyhmIuKchSBQYXNzd29yZCByZXNl
dCBmb3IgbWVudG9yOiB7ZW1haWx9IikKICAgICAgICAKICAgICAgICAjIFNlbmQgZW1haWwgd2l0
aCB0ZW1wb3JhcnkgcGFzc3dvcmQKICAgICAgICBlbWFpbF9zZW50ID0gYXdhaXQgZW1haWxfc2Vy
dmljZS5zZW5kX3Bhc3N3b3JkX3Jlc2V0X2VtYWlsKAogICAgICAgICAgICB0b19lbWFpbD1lbWFp
bCwKICAgICAgICAgICAgdXNlcl9uYW1lPW1lbnRvci5nZXQoIm5hbWUiLCAiTWVudG9yIiksCiAg
ICAgICAgICAgIHRlbXBvcmFyeV9wYXNzd29yZD10ZW1wX3Bhc3N3b3JkLAogICAgICAgICAgICBp
c19tZW50b3I9VHJ1ZQogICAgICAgICkKICAgICAgICAKICAgICAgICBpZiBlbWFpbF9zZW50Ogog
ICAgICAgICAgICBsb2dnZXIuaW5mbyhmIuKchSBQYXNzd29yZCByZXNldCBlbWFpbCBzZW50IHRv
IG1lbnRvcjoge2VtYWlsfSIpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgbG9nZ2VyLndhcm5p
bmcoZiLimqDvuI8gRW1haWwgc2VydmljZSB1bmF2YWlsYWJsZSwgYnV0IHBhc3N3b3JkIHdhcyBy
ZXNldCBmb3IgbWVudG9yOiB7ZW1haWx9IikKICAgICAgICAKICAgICAgICAjIExvZyBhY3Rpdml0
eQogICAgICAgIGF3YWl0IGRiLm1lbnRvcl9hY3Rpdml0eS5pbnNlcnRfb25lKHsKICAgICAgICAg
ICAgIm1lbnRvcl9pZCI6IHN0cihtZW50b3JbIl9pZCJdKSwKICAgICAgICAgICAgImFjdGlvbiI6
ICJwYXNzd29yZF9yZXNldF9yZXF1ZXN0ZWQiLAogICAgICAgICAgICAiZGV0YWlscyI6IHsiZW1h
aWwiOiBlbWFpbCwgImVtYWlsX3NlbnQiOiBlbWFpbF9zZW50fSwKICAgICAgICAgICAgInRpbWVz
dGFtcCI6IGRhdGV0aW1lLnV0Y25vdygpCiAgICAgICAgfSkKICAgICAgICAKICAgICAgICByZXR1
cm4gewogICAgICAgICAgICAibWVzc2FnZSI6ICJJZiBhIG1lbnRvciBhY2NvdW50IGV4aXN0cyB3
aXRoIHRoaXMgZW1haWwsIGEgdGVtcG9yYXJ5IHBhc3N3b3JkIGhhcyBiZWVuIHNlbnQuIiwKICAg
ICAgICAgICAgImVtYWlsX3NlbnQiOiBlbWFpbF9zZW50LAogICAgICAgICAgICAidGVtcF9wYXNz
d29yZCI6IHRlbXBfcGFzc3dvcmQgaWYgbm90IGVtYWlsX3NlbnQgZWxzZSBOb25lICAjIEluY2x1
ZGUgdGVtcCBwYXNzd29yZCBpZiBlbWFpbCBmYWlscwogICAgICAgIH0KICAgICAgICAKICAgIGV4
Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICBsb2dnZXIuZXJyb3IoZiJFcnJvciBpbiBtZW50
b3IgZm9yZ290IHBhc3N3b3JkOiB7c3RyKGUpfSIpCiAgICAgICAgcmFpc2UgSFRUUEV4Y2VwdGlv
bihzdGF0dXNfY29kZT01MDAsIGRldGFpbD0iRmFpbGVkIHRvIHByb2Nlc3MgcGFzc3dvcmQgcmVz
ZXQiKQoKCgpAYXBpX3JvdXRlci5wb3N0KCIvYXV0aC9jaGFuZ2UtcGFzc3dvcmQiKQphc3luYyBk
ZWYgY2hhbmdlX3Bhc3N3b3JkKAogICAgcmVxdWVzdDogQ2hhbmdlUGFzc3dvcmRSZXF1ZXN0LAog
ICAgY3VycmVudF91c2VyID0gRGVwZW5kcyhnZXRfY3VycmVudF91c2VyX2Zvcl9wYXltZW50KQop
OgogICAgIiIiQ2hhbmdlIHVzZXIgcGFzc3dvcmQgLSBhbGxvd3MgdXNlcnMgd2hvIGhhdmVuJ3Qg
cGFpZCB5ZXQiIiIKICAgIHVzZXJfaWRfc3RyID0gY3VycmVudF91c2VyWyJfaWQiXQogICAgY3Vy
cmVudF9wYXNzd29yZCA9IHJlcXVlc3QuY3VycmVudF9wYXNzd29yZAogICAgbmV3X3Bhc3N3b3Jk
ID0gcmVxdWVzdC5uZXdfcGFzc3dvcmQKICAgIAogICAgIyBHZXQgdXNlciBmcm9tIGRhdGFiYXNl
IChjb252ZXJ0IHN0cmluZyBJRCB0byBPYmplY3RJZCkKICAgIHVzZXIgPSBhd2FpdCBkYi51c2Vy
cy5maW5kX29uZSh7Il9pZCI6IE9iamVjdElkKHVzZXJfaWRfc3RyKX0pCiAgICBpZiBub3QgdXNl
cjoKICAgICAgICByYWlzZSBIVFRQRXhjZXB0aW9uKHN0YXR1c19jb2RlPTQwNCwgZGV0YWlsPSJV
c2VyIG5vdCBmb3VuZCIpCiAgICAKICAgICMgVmVyaWZ5IGN1cnJlbnQgcGFzc3dvcmQKICAgIGlm
IG5vdCB2ZXJpZnlfcGFzc3dvcmQoY3VycmVudF9wYXNzd29yZCwgdXNlclsicGFzc3dvcmRfaGFz
aCJdKToKICAgICAgICByYWlzZSBIVFRQRXhjZXB0aW9uKHN0YXR1c19jb2RlPTQwMCwgZGV0YWls
PSJDdXJyZW50IHBhc3N3b3JkIGlzIGluY29ycmVjdCIpCiAgICAKICAgICMgVmFsaWRhdGUgbmV3
IHBhc3N3b3JkCiAgICBpZiBsZW4obmV3X3Bhc3N3b3JkKSA8IDg6CiAgICAgICAgcmFpc2UgSFRU
UEV4Y2VwdGlvbihzdGF0dXNfY29kZT00MDAsIGRldGFpbD0iTmV3IHBhc3N3b3JkIG11c3QgYmUg
YXQgbGVhc3QgOCBjaGFyYWN0ZXJzIikKICAgIAogICAgIyBIYXNoIG5ldyBwYXNzd29yZAogICAg
bmV3X3Bhc3N3b3JkX2hhc2ggPSBnZXRfcGFzc3dvcmRfaGFzaChuZXdfcGFzc3dvcmQpCiAgICAK
ICAgICMgVXBkYXRlIHBhc3N3b3JkIGFuZCByZW1vdmUgcmVxdWlyZXNfcGFzc3dvcmRfY2hhbmdl
IGZsYWcKICAgIHJlc3VsdCA9IGF3YWl0IGRiLnVzZXJzLnVwZGF0ZV9vbmUoCiAgICAgICAgeyJf
aWQiOiB1c2VyWyJfaWQiXX0sCiAgICAgICAgewogICAgICAgICAgICAiJHNldCI6IHsKICAgICAg
ICAgICAgICAgICJwYXNzd29yZF9oYXNoIjogbmV3X3Bhc3N3b3JkX2hhc2gsCiAgICAgICAgICAg
ICAgICAicmVxdWlyZXNfcGFzc3dvcmRfY2hhbmdlIjogRmFsc2UsCiAgICAgICAgICAgICAgICAi
cGFzc3dvcmRfY2hhbmdlZF9hdCI6IGRhdGV0aW1lLnV0Y25vdygpCiAgICAgICAgICAgIH0KICAg
ICAgICB9CiAgICApCiAgICAKICAgIGlmIHJlc3VsdC5tb2RpZmllZF9jb3VudCA+IDA6CiAgICAg
ICAgIyBMb2cgYWN0aXZpdHkKICAgICAgICBhd2FpdCBkYi51c2VyX2FjdGl2aXR5Lmluc2VydF9v
bmUoewogICAgICAgICAgICAidXNlcl9pZCI6IHVzZXJfaWRfc3RyLAogICAgICAgICAgICAiYWN0
aW9uIjogInBhc3N3b3JkX2NoYW5nZWQiLAogICAgICAgICAgICAiZGV0YWlscyI6IHsiZW1haWwi
OiB1c2VyLmdldCgiZW1haWwiKX0sCiAgICAgICAgICAgICJ0aW1lc3RhbXAiOiBkYXRldGltZS51
dGNub3coKQogICAgICAgIH0pCiAgICAgICAgCiAgICAgICAgcmV0dXJuIHsibWVzc2FnZSI6ICJQ
YXNzd29yZCBjaGFuZ2VkIHN1Y2Nlc3NmdWxseSJ9CiAgICBlbHNlOgogICAgICAgIHJhaXNlIEhU
VFBFeGNlcHRpb24oc3RhdHVzX2NvZGU9NTAwLCBkZXRhaWw9IkZhaWxlZCB0byBjaGFuZ2UgcGFz
c3dvcmQiKQoKQGFwaV9yb3V0ZXIuZ2V0KCIvdXNlci9wcm9maWxlIikKYXN5bmMgZGVmIGdldF91
c2VyX3Byb2ZpbGUoY3VycmVudF91c2VyID0gRGVwZW5kcyhnZXRfY3VycmVudF91c2VyX2Zvcl9w
YXltZW50KSk6CiAgICAiIiJHZXQgY3VycmVudCB1c2VyIHByb2ZpbGUgLSBhbGxvd3MgY2hlY2tp
bmcgc3RhdHVzIGZvciBhbGwgYXV0aGVudGljYXRlZCB1c2VycyIiIgogICAgIyBjdXJyZW50X3Vz
ZXIgaXMgYWxyZWFkeSB0aGUgZnVsbCB1c2VyIGRvY3VtZW50IGZyb20gZ2V0X2N1cnJlbnRfdXNl
cl9mb3JfcGF5bWVudAogICAgIyBSZXR1cm4gYWxsIHJlbGV2YW50IGZpZWxkcyBpbmNsdWRpbmcg
cGF5bWVudF9zdGF0dXMKICAgIAogICAgcmV0dXJuIHsKICAgICAgICAiZW1haWwiOiBjdXJyZW50
X3VzZXIuZ2V0KCJlbWFpbCIpLAogICAgICAgICJuYW1lIjogY3VycmVudF91c2VyLmdldCgibmFt
ZSIpLAogICAgICAgICJtZW50b3JfaWQiOiBjdXJyZW50X3VzZXIuZ2V0KCJtZW50b3JfaWQiKSwK
ICAgICAgICAibGljZW5zZV9rZXkiOiBjdXJyZW50X3VzZXIuZ2V0KCJsaWNlbnNlX2tleSIpLAog
ICAgICAgICJzdGF0dXMiOiBjdXJyZW50X3VzZXIuZ2V0KCJzdGF0dXMiKSwKICAgICAgICAicGF5
bWVudF9zdGF0dXMiOiBjdXJyZW50X3VzZXIuZ2V0KCJwYXltZW50X3N0YXR1cyIsICJ1bnBhaWQi
KSwKICAgICAgICAiY3JlYXRlZF9hdCI6IGN1cnJlbnRfdXNlci5nZXQoImNyZWF0ZWRfYXQiKQog
ICAgfQoKQGFwaV9yb3V0ZXIuZ2V0KCIvdXNlci9tZW50b3ItaW5mbyIpCmFzeW5jIGRlZiBnZXRf
dXNlcl9tZW50b3JfaW5mbyhjdXJyZW50X3VzZXIgPSBEZXBlbmRzKGdldF9jdXJyZW50X3VzZXIp
KToKICAgICIiIkdldCBtZW50b3IgaW5mb3JtYXRpb24gZm9yIGN1cnJlbnQgdXNlciIiIgogICAg
dXNlcl9pZCA9IGN1cnJlbnRfdXNlclsiX2lkIl0KICAgIAogICAgIyBDb252ZXJ0IHRvIE9iamVj
dElkIGlmIGl0J3MgYSBzdHJpbmcKICAgIGlmIGlzaW5zdGFuY2UodXNlcl9pZCwgc3RyKToKICAg
ICAgICBmcm9tIGJzb24gaW1wb3J0IE9iamVjdElkCiAgICAgICAgdXNlcl9pZCA9IE9iamVjdElk
KHVzZXJfaWQpCiAgICAKICAgICMgR2V0IHVzZXIKICAgIHVzZXIgPSBhd2FpdCBkYi51c2Vycy5m
aW5kX29uZSh7Il9pZCI6IHVzZXJfaWR9KQogICAgaWYgbm90IHVzZXI6CiAgICAgICAgcmFpc2Ug
SFRUUEV4Y2VwdGlvbihzdGF0dXNfY29kZT00MDQsIGRldGFpbD0iVXNlciBub3QgZm91bmQiKQog
ICAgCiAgICBtZW50b3JfaWQgPSB1c2VyLmdldCgibWVudG9yX2lkIikKICAgIGlmIG5vdCBtZW50
b3JfaWQ6CiAgICAgICAgcmV0dXJuIHsic3lzdGVtX25hbWUiOiAiU2lnbmFsIE1hc3RlciIsICJi
YWNrZ3JvdW5kX2ltYWdlIjogTm9uZSwgImJhY2tncm91bmRfY29sb3IiOiBOb25lfQogICAgCiAg
ICAjIEdldCBtZW50b3IgaW5mbwogICAgbWVudG9yID0gYXdhaXQgZGIubWVudG9ycy5maW5kX29u
ZSh7Im1lbnRvcl9pZCI6IG1lbnRvcl9pZH0pCiAgICBpZiBtZW50b3I6CiAgICAgICAgcmV0dXJu
IHsKICAgICAgICAgICAgIm1lbnRvcl9pZCI6IG1lbnRvcl9pZCwKICAgICAgICAgICAgInN5c3Rl
bV9uYW1lIjogbWVudG9yLmdldCgic3lzdGVtX25hbWUiKSBvciAiU2lnbmFsIE1hc3RlciIsCiAg
ICAgICAgICAgICJiYWNrZ3JvdW5kX2ltYWdlIjogbWVudG9yLmdldCgiYmFja2dyb3VuZF9pbWFn
ZSIsIE5vbmUpLAogICAgICAgICAgICAiYmFja2dyb3VuZF9jb2xvciI6IG1lbnRvci5nZXQoImJh
Y2tncm91bmRfY29sb3IiLCBOb25lKQogICAgICAgIH0KICAgIAogICAgcmV0dXJuIHsibWVudG9y
X2lkIjogbWVudG9yX2lkLCAic3lzdGVtX25hbWUiOiAiU2lnbmFsIE1hc3RlciIsICJiYWNrZ3Jv
dW5kX2ltYWdlIjogTm9uZSwgImJhY2tncm91bmRfY29sb3IiOiBOb25lfQoKQGFwaV9yb3V0ZXIu
cG9zdCgiL2FkbWluL2xvZ2luIiwgcmVzcG9uc2VfbW9kZWw9ZGljdCkKYXN5bmMgZGVmIGxvZ2lu
X2FkbWluKGxvZ2luX2RhdGE6IEFkbWluTG9naW4pOgogICAgIiIiTG9naW4gYWRtaW4iIiIKICAg
IGFkbWluID0gYXdhaXQgZGIuYWRtaW5zLmZpbmRfb25lKHsiZW1haWwiOiBsb2dpbl9kYXRhLmVt
YWlsfSkKICAgIGlmIG5vdCBhZG1pbiBvciBub3QgdmVyaWZ5X3Bhc3N3b3JkKGxvZ2luX2RhdGEu
cGFzc3dvcmQsIGFkbWluWyJwYXNzd29yZF9oYXNoIl0pOgogICAgICAgIHJhaXNlIEhUVFBFeGNl
cHRpb24oc3RhdHVzX2NvZGU9NDAxLCBkZXRhaWw9IkludmFsaWQgZW1haWwgb3IgcGFzc3dvcmQi
KQogICAgCiAgICBhZG1pbl9pZCA9IHN0cihhZG1pblsiX2lkIl0pCiAgICAKICAgICMgVXBkYXRl
IGxhc3QgbG9naW4KICAgIGF3YWl0IGRiLmFkbWlucy51cGRhdGVfb25lKAogICAgICAgIHsiX2lk
IjogYWRtaW5bIl9pZCJdfSwKICAgICAgICB7IiRzZXQiOiB7Imxhc3RfbG9naW4iOiBkYXRldGlt
ZS51dGNub3coKX19CiAgICApCiAgICAKICAgICMgQ3JlYXRlIGFjY2VzcyB0b2tlbgogICAgYWNj
ZXNzX3Rva2VuID0gY3JlYXRlX2FjY2Vzc190b2tlbihkYXRhPXsic3ViIjogYWRtaW5faWQsICJ0
eXBlIjogImFkbWluIn0pCiAgICAKICAgIHJldHVybiB7CiAgICAgICAgImFjY2Vzc190b2tlbiI6
IGFjY2Vzc190b2tlbiwKICAgICAgICAidG9rZW5fdHlwZSI6ICJiZWFyZXIiLAogICAgICAgICJ1
c2VyX3R5cGUiOiAiYWRtaW4iLAogICAgICAgICJ1c2VyX2lkIjogYWRtaW5faWQsCiAgICAgICAg
ImFkbWluIjogewogICAgICAgICAgICAiZW1haWwiOiBhZG1pblsiZW1haWwiXSwKICAgICAgICAg
ICAgIm5hbWUiOiBhZG1pblsibmFtZSJdLAogICAgICAgICAgICAicm9sZSI6IGFkbWluLmdldCgi
cm9sZSIsICJhZG1pbiIpCiAgICAgICAgfQogICAgfQoKQGFwaV9yb3V0ZXIucG9zdCgiL21lbnRv
ci9yZWdpc3RlciIsIHJlc3BvbnNlX21vZGVsPWRpY3QpCmFzeW5jIGRlZiByZWdpc3Rlcl9tZW50
b3IoCiAgICBuYW1lOiBzdHIgPSBCb2R5KC4uLiksCiAgICBlbWFpbDogc3RyID0gQm9keSguLi4p
LAogICAgcGhvbmU6IHN0ciA9IEJvZHkoLi4uKSwKICAgIHNvY2lhbF9tZWRpYTogc3RyID0gQm9k
eSguLi4pLAogICAgbGljZW5zZV9rZXk6IHN0ciA9IEJvZHkoLi4uKSwKICAgIHBhc3N3b3JkOiBz
dHIgPSBCb2R5KC4uLiksCiAgICBjb21wYW55X25hbWU6IHN0ciA9IEJvZHkoTm9uZSkgICMgT3B0
aW9uYWwgZmllbGQKKToKICAgICIiIlJlZ2lzdGVyIGEgbmV3IG1lbnRvciAocmVxdWlyZXMgYWRt
aW4gYXBwcm92YWwgYW5kIHZhbGlkIGxpY2Vuc2Uga2V5KSIiIgogICAgIyBDaGVjayBpZiBtZW50
b3IgYWxyZWFkeSBleGlzdHMKICAgIGV4aXN0aW5nID0gYXdhaXQgZGIubWVudG9ycy5maW5kX29u
ZSh7ImVtYWlsIjogZW1haWx9KQogICAgaWYgZXhpc3Rpbmc6CiAgICAgICAgcmFpc2UgSFRUUEV4
Y2VwdGlvbihzdGF0dXNfY29kZT00MDAsIGRldGFpbD0iRW1haWwgYWxyZWFkeSByZWdpc3RlcmVk
IikKICAgIAogICAgIyBWYWxpZGF0ZSBsaWNlbnNlIGtleSBleGlzdHMgYW5kIGlzIG5vdCB1c2Vk
CiAgICBsaWNlbnNlX2RvYyA9IGF3YWl0IGRiLmxpY2Vuc2VzLmZpbmRfb25lKHsKICAgICAgICAi
a2V5IjogbGljZW5zZV9rZXksCiAgICAgICAgInVzZWQiOiBGYWxzZQogICAgfSkKICAgIAogICAg
aWYgbm90IGxpY2Vuc2VfZG9jOgogICAgICAgIHJhaXNlIEhUVFBFeGNlcHRpb24oCiAgICAgICAg
ICAgIHN0YXR1c19jb2RlPTQwMCwgCiAgICAgICAgICAgIGRldGFpbD0iSW52YWxpZCBvciBhbHJl
YWR5IHVzZWQgbGljZW5zZSBrZXkuIFBsZWFzZSBjb250YWN0IGFkbWluIGZvciBhIGxpY2Vuc2Ug
a2V5LiIKICAgICAgICApCiAgICAKICAgICMgQ3JlYXRlIG1lbnRvciB3aXRoIHBlbmRpbmcgc3Rh
dHVzCiAgICBtZW50b3JfZGF0YSA9IHsKICAgICAgICAibmFtZSI6IG5hbWUsCiAgICAgICAgImVt
YWlsIjogZW1haWwsCiAgICAgICAgInBob25lIjogcGhvbmUsCiAgICAgICAgInNvY2lhbF9tZWRp
YSI6IHNvY2lhbF9tZWRpYSwKICAgICAgICAicGFzc3dvcmRfaGFzaCI6IGdldF9wYXNzd29yZF9o
YXNoKHBhc3N3b3JkKSwKICAgICAgICAicGFzc3dvcmRfcGxhaW4iOiBwYXNzd29yZCwgICMgVGVt
cG9yYXJ5IHN0b3JhZ2UgZm9yIGVtYWlsCiAgICAgICAgImxpY2Vuc2Vfa2V5IjogbGljZW5zZV9r
ZXksCiAgICAgICAgInN0YXR1cyI6ICJwZW5kaW5nIiwgICMgUmVxdWlyZXMgYWRtaW4gYXBwcm92
YWwKICAgICAgICAibWF4X3VzZXJzIjogNTAsCiAgICAgICAgIm1heF9saWNlbnNlcyI6IDEwMCwK
ICAgICAgICAiY3JlYXRlZF9hdCI6IGRhdGV0aW1lLm5vdygpCiAgICB9CiAgICAKICAgICMgT25s
eSBhZGQgY29tcGFueV9uYW1lIGlmIHByb3ZpZGVkCiAgICBpZiBjb21wYW55X25hbWU6CiAgICAg
ICAgbWVudG9yX2RhdGFbImNvbXBhbnlfbmFtZSJdID0gY29tcGFueV9uYW1lCiAgICAKICAgIHJl
c3VsdCA9IGF3YWl0IGRiLm1lbnRvcnMuaW5zZXJ0X29uZShtZW50b3JfZGF0YSkKICAgIAogICAg
IyBNYXJrIGxpY2Vuc2Uga2V5IGFzIHVzZWQgYnkgbWVudG9yCiAgICBhd2FpdCBkYi5saWNlbnNl
cy51cGRhdGVfb25lKAogICAgICAgIHsiX2lkIjogbGljZW5zZV9kb2NbIl9pZCJdfSwKICAgICAg
ICB7IiRzZXQiOiB7CiAgICAgICAgICAgICJ1c2VkIjogVHJ1ZSwKICAgICAgICAgICAgInVzZWRf
YnkiOiBlbWFpbCwKICAgICAgICAgICAgInVzZWRfYnlfdHlwZSI6ICJtZW50b3IiLAogICAgICAg
ICAgICAidXNlZF9hdCI6IGRhdGV0aW1lLm5vdygpCiAgICAgICAgfX0KICAgICkKICAgIAogICAg
cmV0dXJuIHsKICAgICAgICAibWVzc2FnZSI6ICJSZWdpc3RyYXRpb24gc3VjY2Vzc2Z1bCEgUGxl
YXNlIHdhaXQgZm9yIGFkbWluIGFwcHJvdmFsLiBZb3Ugd2lsbCByZWNlaXZlIGFuIGVtYWlsIHdp
dGggeW91ciBsb2dpbiBjcmVkZW50aWFscyBvbmNlIGFwcHJvdmVkLiIsCiAgICAgICAgInN0YXR1
cyI6ICJwZW5kaW5nIgogICAgfQoKQGFwaV9yb3V0ZXIucG9zdCgiL21lbnRvci9sb2dpbiIsIHJl
c3BvbnNlX21vZGVsPWRpY3QpCmFzeW5jIGRlZiBsb2dpbl9tZW50b3IobG9naW5fZGF0YTogQWRt
aW5Mb2dpbik6CiAgICAiIiJMb2dpbiBtZW50b3IiIiIKICAgIGxvZ2dlci5pbmZvKGYi8J+UkCBN
ZW50b3IgbG9naW4gYXR0ZW1wdDoge2xvZ2luX2RhdGEuZW1haWx9IikKICAgIG1lbnRvciA9IGF3
YWl0IGRiLm1lbnRvcnMuZmluZF9vbmUoeyJlbWFpbCI6IGxvZ2luX2RhdGEuZW1haWx9KQogICAg
CiAgICBpZiBub3QgbWVudG9yOgogICAgICAgIGxvZ2dlci53YXJuaW5nKGYi4p2MIE1lbnRvciBu
b3QgZm91bmQ6IHtsb2dpbl9kYXRhLmVtYWlsfSIpCiAgICAgICAgcmFpc2UgSFRUUEV4Y2VwdGlv
bihzdGF0dXNfY29kZT00MDEsIGRldGFpbD0iSW52YWxpZCBlbWFpbCBvciBwYXNzd29yZCIpCiAg
ICAKICAgIGxvZ2dlci5pbmZvKGYi4pyFIE1lbnRvciBmb3VuZCEiKQogICAgbG9nZ2VyLmluZm8o
ZiIgICBNZW50b3IgSUQ6IHttZW50b3IuZ2V0KCdtZW50b3JfaWQnKX0iKQogICAgbG9nZ2VyLmlu
Zm8oZiIgICBFbWFpbDoge21lbnRvci5nZXQoJ2VtYWlsJyl9IikKICAgIGxvZ2dlci5pbmZvKGYi
ICAgU3RhdHVzOiB7bWVudG9yLmdldCgnc3RhdHVzJyl9IikKICAgIGxvZ2dlci5pbmZvKGYiICAg
X2lkOiB7bWVudG9yLmdldCgnX2lkJyl9IikKICAgIGxvZ2dlci5pbmZvKGYiICAgS2V5cyBpbiBt
ZW50b3IgZG9jOiB7bGlzdChtZW50b3Iua2V5cygpKX0iKQogICAgbG9nZ2VyLmluZm8oZiIgICBI
YXMgcGFzc3dvcmRfaGFzaCBrZXk6IHsncGFzc3dvcmRfaGFzaCcgaW4gbWVudG9yfSIpCiAgICBs
b2dnZXIuaW5mbyhmIiAgIG1lbnRvci5nZXQoJ3Bhc3N3b3JkX2hhc2gnKToge21lbnRvci5nZXQo
J3Bhc3N3b3JkX2hhc2gnKX0iKQogICAgbG9nZ2VyLmluZm8oZiIgICBib29sKG1lbnRvci5nZXQo
J3Bhc3N3b3JkX2hhc2gnKSk6IHtib29sKG1lbnRvci5nZXQoJ3Bhc3N3b3JkX2hhc2gnKSl9IikK
ICAgIGlmIG1lbnRvci5nZXQoInBhc3N3b3JkX2hhc2giKToKICAgICAgICBsb2dnZXIuaW5mbyhm
IiAgIFBhc3N3b3JkIGhhc2ggc3RhcnRzIHdpdGg6IHttZW50b3IuZ2V0KCdwYXNzd29yZF9oYXNo
JylbOjEwXX0iKQogICAgCiAgICAjIENoZWNrIGlmIG1lbnRvciBpcyBhcHByb3ZlZAogICAgaWYg
bWVudG9yLmdldCgic3RhdHVzIikgIT0gImFjdGl2ZSI6CiAgICAgICAgaWYgbWVudG9yLmdldCgi
c3RhdHVzIikgPT0gInBlbmRpbmciOgogICAgICAgICAgICByYWlzZSBIVFRQRXhjZXB0aW9uKAog
ICAgICAgICAgICAgICAgc3RhdHVzX2NvZGU9NDAzLCAKICAgICAgICAgICAgICAgIGRldGFpbD0i
WW91ciBhY2NvdW50IGlzIHBlbmRpbmcgYWRtaW4gYXBwcm92YWwuIFBsZWFzZSB3YWl0IGZvciBh
cHByb3ZhbC4iCiAgICAgICAgICAgICkKICAgICAgICBlbGlmIG1lbnRvci5nZXQoInN0YXR1cyIp
ID09ICJkZWNsaW5lZCI6CiAgICAgICAgICAgIHJhaXNlIEhUVFBFeGNlcHRpb24oCiAgICAgICAg
ICAgICAgICBzdGF0dXNfY29kZT00MDMsIAogICAgICAgICAgICAgICAgZGV0YWlsPSJZb3VyIGFj
Y291bnQgcmVnaXN0cmF0aW9uIHdhcyBkZWNsaW5lZC4gUGxlYXNlIGNvbnRhY3Qgc3VwcG9ydC4i
CiAgICAgICAgICAgICkKICAgICAgICBlbHNlOgogICAgICAgICAgICByYWlzZSBIVFRQRXhjZXB0
aW9uKHN0YXR1c19jb2RlPTQwMywgZGV0YWlsPSJBY2NvdW50IGlzIG5vdCBhY3RpdmUuIikKICAg
IAogICAgIyBDaGVjayBpZiBtZW50b3IgaGFzIHBhc3N3b3JkX2hhc2gKICAgIGlmIG5vdCBtZW50
b3IuZ2V0KCJwYXNzd29yZF9oYXNoIik6CiAgICAgICAgbG9nZ2VyLmVycm9yKGYi4p2MIE1lbnRv
ciBtaXNzaW5nIHBhc3N3b3JkX2hhc2ggZmllbGQhIikKICAgICAgICByYWlzZSBIVFRQRXhjZXB0
aW9uKAogICAgICAgICAgICBzdGF0dXNfY29kZT00MDEsIAogICAgICAgICAgICBkZXRhaWw9IkFj
Y291bnQgbm90IGFjdGl2YXRlZC4gUGxlYXNlIGNvbnRhY3QgYWRtaW4gdG8gc2V0IHVwIHlvdXIg
cGFzc3dvcmQuIgogICAgICAgICkKICAgIAogICAgaWYgbm90IHZlcmlmeV9wYXNzd29yZChsb2dp
bl9kYXRhLnBhc3N3b3JkLCBtZW50b3JbInBhc3N3b3JkX2hhc2giXSk6CiAgICAgICAgcmFpc2Ug
SFRUUEV4Y2VwdGlvbihzdGF0dXNfY29kZT00MDEsIGRldGFpbD0iSW52YWxpZCBlbWFpbCBvciBw
YXNzd29yZCIpCiAgICAKICAgICMgQ2hlY2sgaWYgbWVudG9yIGlzIGFjdGl2ZQogICAgaWYgbWVu
dG9yLmdldCgic3RhdHVzIikgIT0gImFjdGl2ZSI6CiAgICAgICAgcmFpc2UgSFRUUEV4Y2VwdGlv
bigKICAgICAgICAgICAgc3RhdHVzX2NvZGU9NDAzLCAKICAgICAgICAgICAgZGV0YWlsPWYiWW91
ciBtZW50b3IgYWNjb3VudCBpcyB7bWVudG9yLmdldCgnc3RhdHVzJywgJ2luYWN0aXZlJyl9LiBQ
bGVhc2UgY29udGFjdCBhZG1pbi4iCiAgICAgICAgKQogICAgCiAgICBtZW50b3JfaWRfc3RyID0g
c3RyKG1lbnRvclsiX2lkIl0pCiAgICAKICAgICMgVXBkYXRlIGxhc3QgbG9naW4KICAgIGF3YWl0
IGRiLm1lbnRvcnMudXBkYXRlX29uZSgKICAgICAgICB7Il9pZCI6IG1lbnRvclsiX2lkIl19LAog
ICAgICAgIHsiJHNldCI6IHsibGFzdF9sb2dpbiI6IGRhdGV0aW1lLnV0Y25vdygpfX0KICAgICkK
ICAgIAogICAgIyBDcmVhdGUgYWNjZXNzIHRva2VuIHdpdGggbWVudG9yIHJvbGUKICAgIGFjY2Vz
c190b2tlbiA9IGNyZWF0ZV9hY2Nlc3NfdG9rZW4oCiAgICAgICAgZGF0YT17CiAgICAgICAgICAg
ICJzdWIiOiBtZW50b3JfaWRfc3RyLCAKICAgICAgICAgICAgInR5cGUiOiAibWVudG9yIiwKICAg
ICAgICAgICAgIm1lbnRvcl9pZCI6IG1lbnRvci5nZXQoIm1lbnRvcl9pZCIpCiAgICAgICAgfQog
ICAgKQogICAgCiAgICByZXR1cm4gewogICAgICAgICJhY2Nlc3NfdG9rZW4iOiBhY2Nlc3NfdG9r
ZW4sCiAgICAgICAgInRva2VuX3R5cGUiOiAiYmVhcmVyIiwKICAgICAgICAidXNlcl90eXBlIjog
Im1lbnRvciIsCiAgICAgICAgInVzZXJfaWQiOiBtZW50b3JfaWRfc3RyLAogICAgICAgICJtZW50
b3IiOiB7CiAgICAgICAgICAgICJlbWFpbCI6IG1lbnRvclsiZW1haWwiXSwKICAgICAgICAgICAg
Im1lbnRvcl9pZCI6IG1lbnRvci5nZXQoIm1lbnRvcl9pZCIpLAogICAgICAgICAgICAiY29tcGFu
eV9uYW1lIjogbWVudG9yLmdldCgiY29tcGFueV9uYW1lIiksCiAgICAgICAgICAgICJzeXN0ZW1f
bmFtZSI6IG1lbnRvci5nZXQoInN5c3RlbV9uYW1lIiksCiAgICAgICAgICAgICJzdGF0dXMiOiBt
ZW50b3IuZ2V0KCJzdGF0dXMiKQogICAgICAgIH0KICAgIH0KCkBhcGlfcm91dGVyLmdldCgiL2F1
dGgvbWUiKQphc3luYyBkZWYgZ2V0X2N1cnJlbnRfdXNlcl9pbmZvKGN1cnJlbnRfdXNlciA9IERl
cGVuZHMoZ2V0X2N1cnJlbnRfdXNlcikpOgogICAgIiIiR2V0IGN1cnJlbnQgbG9nZ2VkIGluIHVz
ZXIgaW5mbyIiIgogICAgcmV0dXJuIHsidXNlciI6IGN1cnJlbnRfdXNlcn0KCiMgPT09PT09PT09
PT09PT09PT09PT0gTUVOVE9SIFJPVVRFUyA9PT09PT09PT09PT09PT09PT09PQoKQGFwaV9yb3V0
ZXIuZ2V0KCIvbWVudG9yL2Rhc2hib2FyZCIpCmFzeW5jIGRlZiBnZXRfbWVudG9yX2Rhc2hib2Fy
ZChjdXJyZW50X21lbnRvciA9IERlcGVuZHMoZ2V0X2N1cnJlbnRfbWVudG9yKSk6CiAgICAiIiJH
ZXQgbWVudG9yIGRhc2hib2FyZCBzdGF0aXN0aWNzIiIiCiAgICBtZW50b3JfaWQgPSBjdXJyZW50
X21lbnRvci5nZXQoIm1lbnRvcl9pZCIpCiAgICAKICAgICMgR2V0IHVzZXJzIHVuZGVyIHRoaXMg
bWVudG9yCiAgICB1c2VycyA9IGF3YWl0IGRiLnVzZXJzLmZpbmQoeyJtZW50b3JfaWQiOiBtZW50
b3JfaWR9KS50b19saXN0KGxlbmd0aD1Ob25lKQogICAgCiAgICAjIEdldCBsaWNlbnNlcyBmb3Ig
dGhpcyBtZW50b3IKICAgIGxpY2Vuc2VzID0gYXdhaXQgZGIubGljZW5zZXMuZmluZCh7Im1lbnRv
cl9pZCI6IG1lbnRvcl9pZH0pLnRvX2xpc3QobGVuZ3RoPU5vbmUpCiAgICAKICAgIHN0YXRzID0g
ewogICAgICAgICJ0b3RhbF91c2VycyI6IGxlbih1c2VycyksCiAgICAgICAgImFjdGl2ZV91c2Vy
cyI6IGxlbihbdSBmb3IgdSBpbiB1c2VycyBpZiB1LmdldCgic3RhdHVzIikgPT0gImFjdGl2ZSJd
KSwKICAgICAgICAicGVuZGluZ191c2VycyI6IGxlbihbdSBmb3IgdSBpbiB1c2VycyBpZiB1Lmdl
dCgic3RhdHVzIikgPT0gInBlbmRpbmciXSksCiAgICAgICAgImluYWN0aXZlX3VzZXJzIjogbGVu
KFt1IGZvciB1IGluIHVzZXJzIGlmIHUuZ2V0KCJzdGF0dXMiKSA9PSAiaW5hY3RpdmUiXSksCiAg
ICAgICAgInRvdGFsX2xpY2Vuc2VzIjogbGVuKGxpY2Vuc2VzKSwKICAgICAgICAidXNlZF9saWNl
bnNlcyI6IGxlbihbbCBmb3IgbCBpbiBsaWNlbnNlcyBpZiBsLmdldCgidXNlZCIpXSksCiAgICAg
ICAgImF2YWlsYWJsZV9saWNlbnNlcyI6IGxlbihbbCBmb3IgbCBpbiBsaWNlbnNlcyBpZiBub3Qg
bC5nZXQoInVzZWQiKV0pLAogICAgICAgICJtZW50b3IiOiB7CiAgICAgICAgICAgICJtZW50b3Jf
aWQiOiBtZW50b3JfaWQsCiAgICAgICAgICAgICJjb21wYW55X25hbWUiOiBjdXJyZW50X21lbnRv
ci5nZXQoImNvbXBhbnlfbmFtZSIpLAogICAgICAgICAgICAic3lzdGVtX25hbWUiOiBjdXJyZW50
X21lbnRvci5nZXQoInN5c3RlbV9uYW1lIiksCiAgICAgICAgICAgICJiYWNrZ3JvdW5kX2ltYWdl
IjogY3VycmVudF9tZW50b3IuZ2V0KCJiYWNrZ3JvdW5kX2ltYWdlIiksCiAgICAgICAgICAgICJi
YWNrZ3JvdW5kX2NvbG9yIjogY3VycmVudF9tZW50b3IuZ2V0KCJiYWNrZ3JvdW5kX2NvbG9yIiks
CiAgICAgICAgICAgICJtYXhfdXNlcnMiOiBjdXJyZW50X21lbnRvci5nZXQoIm1heF91c2VycyIs
IDUwKSwKICAgICAgICAgICAgIm1heF9saWNlbnNlcyI6IGN1cnJlbnRfbWVudG9yLmdldCgibWF4
X2xpY2Vuc2VzIiwgMTAwKQogICAgICAgIH0KICAgIH0KICAgIAogICAgcmV0dXJuIHN0YXRzCgpA
YXBpX3JvdXRlci5nZXQoIi9tZW50b3IvdXNlcnMiKQphc3luYyBkZWYgZ2V0X21lbnRvcl91c2Vy
cyhjdXJyZW50X21lbnRvciA9IERlcGVuZHMoZ2V0X2N1cnJlbnRfbWVudG9yKSk6CiAgICAiIiJH
ZXQgYWxsIHVzZXJzIHVuZGVyIHRoaXMgbWVudG9yIiIiCiAgICBtZW50b3JfaWQgPSBjdXJyZW50
X21lbnRvci5nZXQoIm1lbnRvcl9pZCIpCiAgICAKICAgIHVzZXJzID0gYXdhaXQgZGIudXNlcnMu
ZmluZCh7Im1lbnRvcl9pZCI6IG1lbnRvcl9pZH0pLnRvX2xpc3QobGVuZ3RoPU5vbmUpCiAgICAK
ICAgIHJldHVybiB7InVzZXJzIjogW3NlcmlhbGl6ZV9kb2ModXNlcikgZm9yIHVzZXIgaW4gdXNl
cnNdfQoKQGFwaV9yb3V0ZXIucG9zdCgiL21lbnRvci91c2Vycy97dXNlcl9pZH0vYWN0aXZhdGUi
KQphc3luYyBkZWYgbWVudG9yX2FjdGl2YXRlX3VzZXIodXNlcl9pZDogc3RyLCBjdXJyZW50X21l
bnRvciA9IERlcGVuZHMoZ2V0X2N1cnJlbnRfbWVudG9yKSk6CiAgICAiIiJBY3RpdmF0ZSBhIHVz
ZXIgKG1lbnRvciBvbmx5IGZvciB0aGVpciB1c2VycykiIiIKICAgIG1lbnRvcl9pZCA9IGN1cnJl
bnRfbWVudG9yLmdldCgibWVudG9yX2lkIikKICAgIAogICAgIyBWZXJpZnkgdXNlciBiZWxvbmdz
IHRvIHRoaXMgbWVudG9yCiAgICB1c2VyID0gYXdhaXQgZGIudXNlcnMuZmluZF9vbmUoeyJfaWQi
OiBPYmplY3RJZCh1c2VyX2lkKSwgIm1lbnRvcl9pZCI6IG1lbnRvcl9pZH0pCiAgICBpZiBub3Qg
dXNlcjoKICAgICAgICByYWlzZSBIVFRQRXhjZXB0aW9uKHN0YXR1c19jb2RlPTQwNCwgZGV0YWls
PSJVc2VyIG5vdCBmb3VuZCBvciBub3QgdW5kZXIgeW91ciBtZW50b3IgSUQiKQogICAgCiAgICBy
ZXN1bHQgPSBhd2FpdCBkYi51c2Vycy51cGRhdGVfb25lKAogICAgICAgIHsiX2lkIjogT2JqZWN0
SWQodXNlcl9pZCl9LAogICAgICAgIHsiJHNldCI6IHsic3RhdHVzIjogImFjdGl2ZSJ9fQogICAg
KQogICAgCiAgICBpZiByZXN1bHQubW9kaWZpZWRfY291bnQgPiAwOgogICAgICAgIHJldHVybiB7
Im1lc3NhZ2UiOiAiVXNlciBhY3RpdmF0ZWQgc3VjY2Vzc2Z1bGx5In0KICAgIGVsc2U6CiAgICAg
ICAgcmFpc2UgSFRUUEV4Y2VwdGlvbihzdGF0dXNfY29kZT00MDAsIGRldGFpbD0iRmFpbGVkIHRv
IGFjdGl2YXRlIHVzZXIiKQoKQGFwaV9yb3V0ZXIucG9zdCgiL21lbnRvci91c2Vycy97dXNlcl9p
ZH0vZGVhY3RpdmF0ZSIpCmFzeW5jIGRlZiBtZW50b3JfZGVhY3RpdmF0ZV91c2VyKHVzZXJfaWQ6
IHN0ciwgY3VycmVudF9tZW50b3IgPSBEZXBlbmRzKGdldF9jdXJyZW50X21lbnRvcikpOgogICAg
IiIiRGVhY3RpdmF0ZSBhIHVzZXIgKG1lbnRvciBvbmx5IGZvciB0aGVpciB1c2VycykiIiIKICAg
IG1lbnRvcl9pZCA9IGN1cnJlbnRfbWVudG9yLmdldCgibWVudG9yX2lkIikKICAgIAogICAgIyBW
ZXJpZnkgdXNlciBiZWxvbmdzIHRvIHRoaXMgbWVudG9yCiAgICB1c2VyID0gYXdhaXQgZGIudXNl
cnMuZmluZF9vbmUoeyJfaWQiOiBPYmplY3RJZCh1c2VyX2lkKSwgIm1lbnRvcl9pZCI6IG1lbnRv
cl9pZH0pCiAgICBpZiBub3QgdXNlcjoKICAgICAgICByYWlzZSBIVFRQRXhjZXB0aW9uKHN0YXR1
c19jb2RlPTQwNCwgZGV0YWlsPSJVc2VyIG5vdCBmb3VuZCBvciBub3QgdW5kZXIgeW91ciBtZW50
b3IgSUQiKQogICAgCiAgICByZXN1bHQgPSBhd2FpdCBkYi51c2Vycy51cGRhdGVfb25lKAogICAg
ICAgIHsiX2lkIjogT2JqZWN0SWQodXNlcl9pZCl9LAogICAgICAgIHsiJHNldCI6IHsic3RhdHVz
IjogImluYWN0aXZlIn19CiAgICApCiAgICAKICAgIGlmIHJlc3VsdC5tb2RpZmllZF9jb3VudCA+
IDA6CiAgICAgICAgcmV0dXJuIHsibWVzc2FnZSI6ICJVc2VyIGRlYWN0aXZhdGVkIHN1Y2Nlc3Nm
dWxseSJ9CiAgICBlbHNlOgogICAgICAgIHJhaXNlIEhUVFBFeGNlcHRpb24oc3RhdHVzX2NvZGU9
NDAwLCBkZXRhaWw9IkZhaWxlZCB0byBkZWFjdGl2YXRlIHVzZXIiKQoKQGFwaV9yb3V0ZXIucG9z
dCgiL21lbnRvci91c2Vycy97dXNlcl9pZH0vcmVzZXQtcGFzc3dvcmQiKQphc3luYyBkZWYgbWVu
dG9yX3Jlc2V0X3VzZXJfcGFzc3dvcmQodXNlcl9pZDogc3RyLCBjdXJyZW50X21lbnRvciA9IERl
cGVuZHMoZ2V0X2N1cnJlbnRfbWVudG9yKSk6CiAgICAiIiIKICAgIFJlc2V0IHVzZXIgcGFzc3dv
cmQgKG1lbnRvciBvbmx5IGZvciB0aGVpciB1c2VycykuCiAgICBTZW5kcyBlbWFpbCBub3RpZmlj
YXRpb24gdG8gdXNlciB3aXRoIHRlbXBvcmFyeSBwYXNzd29yZC4KICAgICIiIgogICAgbWVudG9y
X2lkID0gY3VycmVudF9tZW50b3IuZ2V0KCJtZW50b3JfaWQiKQogICAgCiAgICAjIFZlcmlmeSB1
c2VyIGJlbG9uZ3MgdG8gdGhpcyBtZW50b3IKICAgIHVzZXIgPSBhd2FpdCBkYi51c2Vycy5maW5k
X29uZSh7Il9pZCI6IE9iamVjdElkKHVzZXJfaWQpLCAibWVudG9yX2lkIjogbWVudG9yX2lkfSkK
ICAgIGlmIG5vdCB1c2VyOgogICAgICAgIHJhaXNlIEhUVFBFeGNlcHRpb24oc3RhdHVzX2NvZGU9
NDA0LCBkZXRhaWw9IlVzZXIgbm90IGZvdW5kIG9yIG5vdCB1bmRlciB5b3VyIG1lbnRvciBJRCIp
CiAgICAKICAgICMgR2VuZXJhdGUgdGVtcG9yYXJ5IHBhc3N3b3JkCiAgICB0ZW1wX3Bhc3N3b3Jk
ID0gZ2VuZXJhdGVfcmFuZG9tX3N0cmluZygxMikKICAgIHBhc3N3b3JkX2hhc2ggPSBoYXNoX3Bh
c3N3b3JkKHRlbXBfcGFzc3dvcmQpCiAgICAKICAgIHJlc3VsdCA9IGF3YWl0IGRiLnVzZXJzLnVw
ZGF0ZV9vbmUoCiAgICAgICAgeyJfaWQiOiBPYmplY3RJZCh1c2VyX2lkKX0sCiAgICAgICAgeyIk
c2V0IjogewogICAgICAgICAgICAicGFzc3dvcmRfaGFzaCI6IHBhc3N3b3JkX2hhc2gsCiAgICAg
ICAgICAgICJyZXF1aXJlc19wYXNzd29yZF9jaGFuZ2UiOiBUcnVlLAogICAgICAgICAgICAicGFz
c3dvcmRfcmVzZXRfYXQiOiBkYXRldGltZS51dGNub3coKQogICAgICAgIH19CiAgICApCiAgICAK
ICAgIGlmIHJlc3VsdC5tb2RpZmllZF9jb3VudCA+IDA6CiAgICAgICAgIyBTZW5kIGVtYWlsIG5v
dGlmaWNhdGlvbiB0byB1c2VyCiAgICAgICAgdXNlcl9lbWFpbCA9IHVzZXIuZ2V0KCJlbWFpbCIp
CiAgICAgICAgdXNlcl9uYW1lID0gdXNlci5nZXQoIm5hbWUiLCAiVXNlciIpCiAgICAgICAgCiAg
ICAgICAgbG9nZ2VyLmluZm8oZiLinIUgTWVudG9yIHttZW50b3JfaWR9IHJlc2V0IHBhc3N3b3Jk
IGZvciB1c2VyOiB7dXNlcl9lbWFpbH0iKQogICAgICAgIGxvZ2dlci5pbmZvKGYi8J+UkSBURU1Q
T1JBUlkgUEFTU1dPUkQgRk9SIHt1c2VyX2VtYWlsfToge3RlbXBfcGFzc3dvcmR9IikKICAgICAg
ICAKICAgICAgICBlbWFpbF9zZW50ID0gYXdhaXQgZW1haWxfc2VydmljZS5zZW5kX3Bhc3N3b3Jk
X3Jlc2V0X2VtYWlsKAogICAgICAgICAgICB0b19lbWFpbD11c2VyX2VtYWlsLAogICAgICAgICAg
ICB1c2VyX25hbWU9dXNlcl9uYW1lLAogICAgICAgICAgICB0ZW1wb3JhcnlfcGFzc3dvcmQ9dGVt
cF9wYXNzd29yZCwKICAgICAgICAgICAgaXNfbWVudG9yPUZhbHNlCiAgICAgICAgKQogICAgICAg
IAogICAgICAgIGlmIGVtYWlsX3NlbnQ6CiAgICAgICAgICAgIGxvZ2dlci5pbmZvKGYi4pyFIFBh
c3N3b3JkIHJlc2V0IGVtYWlsIHNlbnQgdG8gdXNlcjoge3VzZXJfZW1haWx9IGJ5IG1lbnRvcjog
e21lbnRvcl9pZH0iKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGxvZ2dlci53YXJuaW5nKGYi
4pqg77iPIEVtYWlsIHNlcnZpY2UgdW5hdmFpbGFibGUsIGJ1dCBwYXNzd29yZCByZXNldCBmb3I6
IHt1c2VyX2VtYWlsfSIpCiAgICAgICAgICAgIGxvZ2dlci53YXJuaW5nKGYi8J+TpyBNQU5VQUwg
QUNUSU9OIFJFUVVJUkVEOiBTZW5kIHRoaXMgcGFzc3dvcmQgdG8ge3VzZXJfZW1haWx9OiB7dGVt
cF9wYXNzd29yZH0iKQogICAgICAgIAogICAgICAgICMgTG9nIGFjdGl2aXR5CiAgICAgICAgYXdh
aXQgZGIudXNlcl9hY3Rpdml0eS5pbnNlcnRfb25lKHsKICAgICAgICAgICAgInVzZXJfaWQiOiB1
c2VyX2lkLAogICAgICAgICAgICAibWVudG9yX2lkIjogbWVudG9yX2lkLAogICAgICAgICAgICAi
YWN0aW9uIjogInBhc3N3b3JkX3Jlc2V0X2J5X21lbnRvciIsCiAgICAgICAgICAgICJkZXRhaWxz
IjogewogICAgICAgICAgICAgICAgInVzZXJfZW1haWwiOiB1c2VyX2VtYWlsLAogICAgICAgICAg
ICAgICAgIm1lbnRvcl9pZCI6IG1lbnRvcl9pZCwKICAgICAgICAgICAgICAgICJlbWFpbF9zZW50
IjogZW1haWxfc2VudAogICAgICAgICAgICB9LAogICAgICAgICAgICAidGltZXN0YW1wIjogZGF0
ZXRpbWUudXRjbm93KCkKICAgICAgICB9KQogICAgICAgIAogICAgICAgIHJldHVybiB7CiAgICAg
ICAgICAgICJtZXNzYWdlIjogIlBhc3N3b3JkIHJlc2V0IHN1Y2Nlc3NmdWxseSIsCiAgICAgICAg
ICAgICJ0ZW1wb3JhcnlfcGFzc3dvcmQiOiB0ZW1wX3Bhc3N3b3JkLAogICAgICAgICAgICAiZW1h
aWxfc2VudCI6IGVtYWlsX3NlbnQsCiAgICAgICAgICAgICJ1c2VyX2VtYWlsIjogdXNlcl9lbWFp
bAogICAgICAgIH0KICAgIGVsc2U6CiAgICAgICAgcmFpc2UgSFRUUEV4Y2VwdGlvbihzdGF0dXNf
Y29kZT00MDAsIGRldGFpbD0iRmFpbGVkIHRvIHJlc2V0IHBhc3N3b3JkIikKCkBhcGlfcm91dGVy
LnBvc3QoIi9tZW50b3IvbGljZW5zZXMvZ2VuZXJhdGUiKQphc3luYyBkZWYgbWVudG9yX2dlbmVy
YXRlX2xpY2Vuc2VzKAogICAgY291bnQ6IGludCA9IEJvZHkoLi4uLCBlbWJlZD1UcnVlKSwKICAg
IGN1cnJlbnRfbWVudG9yID0gRGVwZW5kcyhnZXRfY3VycmVudF9tZW50b3IpCik6CiAgICAiIiJH
ZW5lcmF0ZSBsaWNlbnNlIGtleXMgKG1lbnRvciBmb3IgdGhlaXIgb3duIHVzZSkiIiIKICAgIG1l
bnRvcl9pZCA9IGN1cnJlbnRfbWVudG9yLmdldCgibWVudG9yX2lkIikKICAgIAogICAgaWYgY291
bnQgPCAxIG9yIGNvdW50ID4gMTAwOgogICAgICAgIHJhaXNlIEhUVFBFeGNlcHRpb24oc3RhdHVz
X2NvZGU9NDAwLCBkZXRhaWw9IkNvdW50IG11c3QgYmUgYmV0d2VlbiAxIGFuZCAxMDAiKQogICAg
CiAgICAjIENoZWNrIGlmIG1lbnRvciBoYXMgcmVhY2hlZCBtYXggbGljZW5zZXMKICAgIGN1cnJl
bnRfbGljZW5zZXNfY291bnQgPSBhd2FpdCBkYi5saWNlbnNlcy5jb3VudF9kb2N1bWVudHMoeyJt
ZW50b3JfaWQiOiBtZW50b3JfaWR9KQogICAgbWF4X2xpY2Vuc2VzID0gY3VycmVudF9tZW50b3Iu
Z2V0KCJtYXhfbGljZW5zZXMiLCAxMDApCiAgICAKICAgIGlmIGN1cnJlbnRfbGljZW5zZXNfY291
bnQgKyBjb3VudCA+IG1heF9saWNlbnNlczoKICAgICAgICByYWlzZSBIVFRQRXhjZXB0aW9uKAog
ICAgICAgICAgICBzdGF0dXNfY29kZT00MDAsIAogICAgICAgICAgICBkZXRhaWw9ZiJDYW5ub3Qg
Z2VuZXJhdGUge2NvdW50fSBsaWNlbnNlcy4gV291bGQgZXhjZWVkIHlvdXIgbGltaXQgb2Yge21h
eF9saWNlbnNlc30iCiAgICAgICAgKQogICAgCiAgICBsaWNlbnNlX2tleXMgPSBbXQogICAgZm9y
IF8gaW4gcmFuZ2UoY291bnQpOgogICAgICAgIGxpY2Vuc2Vfa2V5ID0gZ2VuZXJhdGVfbGljZW5z
ZV9rZXkoKQogICAgICAgIGxpY2Vuc2Vfa2V5cy5hcHBlbmQoewogICAgICAgICAgICAia2V5Ijog
bGljZW5zZV9rZXksCiAgICAgICAgICAgICJtZW50b3JfaWQiOiBtZW50b3JfaWQsCiAgICAgICAg
ICAgICJ1c2VkIjogRmFsc2UsCiAgICAgICAgICAgICJ1c2VkX2J5IjogTm9uZSwKICAgICAgICAg
ICAgImNyZWF0ZWRfYXQiOiBkYXRldGltZS51dGNub3coKSwKICAgICAgICAgICAgImNvcGllZCI6
IEZhbHNlLAogICAgICAgICAgICAiY29waWVkX2F0IjogTm9uZQogICAgICAgIH0pCiAgICAKICAg
IGF3YWl0IGRiLmxpY2Vuc2VzLmluc2VydF9tYW55KGxpY2Vuc2Vfa2V5cykKICAgIAogICAgcmV0
dXJuIHsKICAgICAgICAibWVzc2FnZSI6IGYiR2VuZXJhdGVkIHtjb3VudH0gbGljZW5zZSBrZXlz
IiwKICAgICAgICAibGljZW5zZV9rZXlzIjogW2xrWyJrZXkiXSBmb3IgbGsgaW4gbGljZW5zZV9r
ZXlzXQogICAgfQoKQGFwaV9yb3V0ZXIuZ2V0KCIvbWVudG9yL2xpY2Vuc2VzIikKYXN5bmMgZGVm
IGdldF9tZW50b3JfbGljZW5zZXMoY3VycmVudF9tZW50b3IgPSBEZXBlbmRzKGdldF9jdXJyZW50
X21lbnRvcikpOgogICAgIiIiR2V0IGFsbCBsaWNlbnNlIGtleXMgZm9yIHRoaXMgbWVudG9yIiIi
CiAgICBtZW50b3JfaWQgPSBjdXJyZW50X21lbnRvci5nZXQoIm1lbnRvcl9pZCIpCiAgICAKICAg
IGxpY2Vuc2VzID0gYXdhaXQgZGIubGljZW5zZXMuZmluZCh7Im1lbnRvcl9pZCI6IG1lbnRvcl9p
ZH0pLnRvX2xpc3QobGVuZ3RoPU5vbmUpCiAgICAKICAgIHJldHVybiB7ImxpY2Vuc2VzIjogW3Nl
cmlhbGl6ZV9kb2MobGljZW5zZSkgZm9yIGxpY2Vuc2UgaW4gbGljZW5zZXNdfQoKQGFwaV9yb3V0
ZXIucHV0KCIvbWVudG9yL2JyYW5kaW5nL3N5c3RlbS1uYW1lIikKYXN5bmMgZGVmIHVwZGF0ZV9t
ZW50b3Jfc3lzdGVtX25hbWUoCiAgICBzeXN0ZW1fbmFtZTogc3RyID0gQm9keSguLi4sIGVtYmVk
PVRydWUpLAogICAgY3VycmVudF9tZW50b3IgPSBEZXBlbmRzKGdldF9jdXJyZW50X21lbnRvcikK
KToKICAgICIiIlVwZGF0ZSBtZW50b3IncyBzeXN0ZW0gbmFtZSIiIgogICAgbWVudG9yX2lkID0g
Y3VycmVudF9tZW50b3IuZ2V0KCJfaWQiKQogICAgCiAgICByZXN1bHQgPSBhd2FpdCBkYi5tZW50
b3JzLnVwZGF0ZV9vbmUoCiAgICAgICAgeyJfaWQiOiBPYmplY3RJZChtZW50b3JfaWQpfSwKICAg
ICAgICB7IiRzZXQiOiB7InN5c3RlbV9uYW1lIjogc3lzdGVtX25hbWV9fQogICAgKQogICAgCiAg
ICBpZiByZXN1bHQubW9kaWZpZWRfY291bnQgPiAwOgogICAgICAgIHJldHVybiB7Im1lc3NhZ2Ui
OiAiU3lzdGVtIG5hbWUgdXBkYXRlZCBzdWNjZXNzZnVsbHkiLCAic3lzdGVtX25hbWUiOiBzeXN0
ZW1fbmFtZX0KICAgIGVsc2U6CiAgICAgICAgcmFpc2UgSFRUUEV4Y2VwdGlvbihzdGF0dXNfY29k
ZT00MDAsIGRldGFpbD0iRmFpbGVkIHRvIHVwZGF0ZSBzeXN0ZW0gbmFtZSIpCgpAYXBpX3JvdXRl
ci5wdXQoIi9tZW50b3IvYnJhbmRpbmcvYmFja2dyb3VuZCIpCmFzeW5jIGRlZiB1cGRhdGVfbWVu
dG9yX2JhY2tncm91bmQoCiAgICBiYWNrZ3JvdW5kX2ltYWdlOiBPcHRpb25hbFtzdHJdID0gQm9k
eShOb25lKSwKICAgIGJhY2tncm91bmRfY29sb3I6IE9wdGlvbmFsW3N0cl0gPSBCb2R5KE5vbmUp
LAogICAgY3VycmVudF9tZW50b3IgPSBEZXBlbmRzKGdldF9jdXJyZW50X21lbnRvcikKKToKICAg
ICIiIlVwZGF0ZSBtZW50b3IncyBiYWNrZ3JvdW5kIGltYWdlIGFuZCBjb2xvciIiIgogICAgbWVu
dG9yX2lkID0gY3VycmVudF9tZW50b3IuZ2V0KCJfaWQiKQogICAgCiAgICB1cGRhdGVfZmllbGRz
ID0ge30KICAgIAogICAgaWYgYmFja2dyb3VuZF9pbWFnZSBpcyBub3QgTm9uZToKICAgICAgICB1
cGRhdGVfZmllbGRzWyJiYWNrZ3JvdW5kX2ltYWdlIl0gPSBiYWNrZ3JvdW5kX2ltYWdlCiAgICAg
ICAgdXBkYXRlX2ZpZWxkc1siYmFja2dyb3VuZF9pbWFnZV91cGRhdGVkX2F0Il0gPSBkYXRldGlt
ZS51dGNub3coKQogICAgCiAgICBpZiBiYWNrZ3JvdW5kX2NvbG9yIGlzIG5vdCBOb25lOgogICAg
ICAgIHVwZGF0ZV9maWVsZHNbImJhY2tncm91bmRfY29sb3IiXSA9IGJhY2tncm91bmRfY29sb3IK
ICAgICAgICB1cGRhdGVfZmllbGRzWyJiYWNrZ3JvdW5kX2NvbG9yX3VwZGF0ZWRfYXQiXSA9IGRh
dGV0aW1lLnV0Y25vdygpCiAgICAKICAgIGlmIG5vdCB1cGRhdGVfZmllbGRzOgogICAgICAgIHJh
aXNlIEhUVFBFeGNlcHRpb24oc3RhdHVzX2NvZGU9NDAwLCBkZXRhaWw9Ik5vIGJhY2tncm91bmQg
c2V0dGluZ3MgcHJvdmlkZWQiKQogICAgCiAgICByZXN1bHQgPSBhd2FpdCBkYi5tZW50b3JzLnVw
ZGF0ZV9vbmUoCiAgICAgICAgeyJfaWQiOiBPYmplY3RJZChtZW50b3JfaWQpfSwKICAgICAgICB7
IiRzZXQiOiB1cGRhdGVfZmllbGRzfQogICAgKQogICAgCiAgICBpZiByZXN1bHQubWF0Y2hlZF9j
b3VudCA+IDA6CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgIm1lc3NhZ2UiOiAiQmFja2dy
b3VuZCBzZXR0aW5ncyB1cGRhdGVkIHN1Y2Nlc3NmdWxseSIsCiAgICAgICAgICAgICJiYWNrZ3Jv
dW5kX2ltYWdlIjogdXBkYXRlX2ZpZWxkcy5nZXQoImJhY2tncm91bmRfaW1hZ2UiKSwKICAgICAg
ICAgICAgImJhY2tncm91bmRfY29sb3IiOiB1cGRhdGVfZmllbGRzLmdldCgiYmFja2dyb3VuZF9j
b2xvciIpCiAgICAgICAgfQogICAgZWxzZToKICAgICAgICByYWlzZSBIVFRQRXhjZXB0aW9uKHN0
YXR1c19jb2RlPTQwNCwgZGV0YWlsPSJNZW50b3Igbm90IGZvdW5kIikKCiMgPT09PT09PT09PT09
PT09PT09PT0gQURNSU4gUk9VVEVTID09PT09PT09PT09PT09PT09PT09CgpAYXBpX3JvdXRlci5n
ZXQoIi9hZG1pbi91c2VycyIpCmFzeW5jIGRlZiBnZXRfYWxsX3VzZXJzKGN1cnJlbnRfYWRtaW4g
PSBEZXBlbmRzKGdldF9jdXJyZW50X2FkbWluKSk6CiAgICAiIiJHZXQgYWxsIHVzZXJzIChhZG1p
biBvbmx5KSIiIgogICAgdXNlcnMgPSBhd2FpdCBkYi51c2Vycy5maW5kKCkudG9fbGlzdCgxMDAw
KQogICAgcmV0dXJuIHsidXNlcnMiOiBbc2VyaWFsaXplX2RvYyh1c2VyKSBmb3IgdXNlciBpbiB1
c2Vyc119CgpAYXBpX3JvdXRlci5nZXQoIi9hZG1pbi91c2Vycy97dXNlcl9pZH0iKQphc3luYyBk
ZWYgZ2V0X3VzZXJfYnlfaWQodXNlcl9pZDogc3RyLCBjdXJyZW50X2FkbWluID0gRGVwZW5kcyhn
ZXRfY3VycmVudF9hZG1pbikpOgogICAgIiIiR2V0IHNwZWNpZmljIHVzZXIgZGV0YWlscyAoYWRt
aW4gb25seSkiIiIKICAgIHRyeToKICAgICAgICB1c2VyID0gYXdhaXQgZGIudXNlcnMuZmluZF9v
bmUoeyJfaWQiOiBPYmplY3RJZCh1c2VyX2lkKX0pCiAgICAgICAgaWYgbm90IHVzZXI6CiAgICAg
ICAgICAgIHJhaXNlIEhUVFBFeGNlcHRpb24oc3RhdHVzX2NvZGU9NDA0LCBkZXRhaWw9IlVzZXIg
bm90IGZvdW5kIikKICAgICAgICByZXR1cm4gc2VyaWFsaXplX2RvYyh1c2VyKQogICAgZXhjZXB0
IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIHJhaXNlIEhUVFBFeGNlcHRpb24oc3RhdHVzX2NvZGU9
NDAwLCBkZXRhaWw9c3RyKGUpKQoKQGFwaV9yb3V0ZXIucHV0KCIvYWRtaW4vdXNlcnMve3VzZXJf
aWR9IikKYXN5bmMgZGVmIHVwZGF0ZV91c2VyX2J5X2FkbWluKAogICAgdXNlcl9pZDogc3RyLCAK
ICAgIHVwZGF0ZV9kYXRhOiBkaWN0LAogICAgY3VycmVudF9hZG1pbiA9IERlcGVuZHMoZ2V0X2N1
cnJlbnRfYWRtaW4pCik6CiAgICAiIiJVcGRhdGUgdXNlciBzdGF0dXMgb3IgZGV0YWlscyAoYWRt
aW4gb25seSkiIiIKICAgIHRyeToKICAgICAgICByZXN1bHQgPSBhd2FpdCBkYi51c2Vycy51cGRh
dGVfb25lKAogICAgICAgICAgICB7Il9pZCI6IE9iamVjdElkKHVzZXJfaWQpfSwKICAgICAgICAg
ICAgeyIkc2V0IjogeyoqdXBkYXRlX2RhdGEsICJ1cGRhdGVkX2F0IjogZGF0ZXRpbWUudXRjbm93
KCl9fQogICAgICAgICkKICAgICAgICBpZiByZXN1bHQubW9kaWZpZWRfY291bnQgPT0gMDoKICAg
ICAgICAgICAgcmFpc2UgSFRUUEV4Y2VwdGlvbihzdGF0dXNfY29kZT00MDQsIGRldGFpbD0iVXNl
ciBub3QgZm91bmQiKQogICAgICAgIHJldHVybiB7Im1lc3NhZ2UiOiAiVXNlciB1cGRhdGVkIHN1
Y2Nlc3NmdWxseSJ9CiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgcmFpc2UgSFRU
UEV4Y2VwdGlvbihzdGF0dXNfY29kZT00MDAsIGRldGFpbD1zdHIoZSkpCgpAYXBpX3JvdXRlci5n
ZXQoIi9hZG1pbi91c2Vycy97dXNlcl9pZH0vZWFzIikKYXN5bmMgZGVmIGdldF91c2VyX2Vhcyh1
c2VyX2lkOiBzdHIsIGN1cnJlbnRfYWRtaW4gPSBEZXBlbmRzKGdldF9jdXJyZW50X2FkbWluKSk6
CiAgICAiIiJHZXQgYWxsIEVBcyBmb3IgYSBzcGVjaWZpYyB1c2VyIChhZG1pbiBvbmx5KSIiIgog
ICAgZWFzID0gYXdhaXQgZGIuZWFzLmZpbmQoeyJ1c2VyX2lkIjogdXNlcl9pZH0pLnRvX2xpc3Qo
MTAwMCkKICAgIHJldHVybiBbc2VyaWFsaXplX2RvYyhlYSkgZm9yIGVhIGluIGVhc10KCkBhcGlf
cm91dGVyLmdldCgiL2FkbWluL2FjdGl2aXR5IikKYXN5bmMgZGVmIGdldF9hY3Rpdml0eV9sb2dz
KAogICAgbGltaXQ6IGludCA9IDEwMCwKICAgIGN1cnJlbnRfYWRtaW4gPSBEZXBlbmRzKGdldF9j
dXJyZW50X2FkbWluKQopOgogICAgIiIiR2V0IHVzZXIgYWN0aXZpdHkgbG9ncyAoYWRtaW4gb25s
eSkiIiIKICAgIGFjdGl2aXRpZXMgPSBhd2FpdCBkYi51c2VyX2FjdGl2aXR5LmZpbmQoKS5zb3J0
KCJ0aW1lc3RhbXAiLCAtMSkubGltaXQobGltaXQpLnRvX2xpc3QobGltaXQpCiAgICByZXR1cm4g
W3NlcmlhbGl6ZV9kb2MoYWN0aXZpdHkpIGZvciBhY3Rpdml0eSBpbiBhY3Rpdml0aWVzXQoKQGFw
aV9yb3V0ZXIuZ2V0KCIvYWRtaW4vc3RhdHMiKQphc3luYyBkZWYgZ2V0X2FkbWluX3N0YXRzKGN1
cnJlbnRfYWRtaW4gPSBEZXBlbmRzKGdldF9jdXJyZW50X2FkbWluKSk6CiAgICAiIiJHZXQgZGFz
aGJvYXJkIHN0YXRpc3RpY3MgKGFkbWluIG9ubHkpIiIiCiAgICB0b3RhbF91c2VycyA9IGF3YWl0
IGRiLnVzZXJzLmNvdW50X2RvY3VtZW50cyh7fSkKICAgIGFjdGl2ZV91c2VycyA9IGF3YWl0IGRi
LnVzZXJzLmNvdW50X2RvY3VtZW50cyh7InN0YXR1cyI6ICJhY3RpdmUifSkKICAgIHBlbmRpbmdf
dXNlcnMgPSBhd2FpdCBkYi51c2Vycy5jb3VudF9kb2N1bWVudHMoeyJzdGF0dXMiOiAicGVuZGlu
ZyJ9KQogICAgdG90YWxfZWFzID0gYXdhaXQgZGIuZWFzLmNvdW50X2RvY3VtZW50cyh7fSkKICAg
IHRvdGFsX2xpY2Vuc2VzID0gYXdhaXQgZGIubGljZW5zZXMuY291bnRfZG9jdW1lbnRzKHt9KQog
ICAgdXNlZF9saWNlbnNlcyA9IGF3YWl0IGRiLmxpY2Vuc2VzLmNvdW50X2RvY3VtZW50cyh7InVz
ZWQiOiBUcnVlfSkKICAgIAogICAgcmV0dXJuIHsKICAgICAgICAidG90YWxfdXNlcnMiOiB0b3Rh
bF91c2VycywKICAgICAgICAiYWN0aXZlX3VzZXJzIjogYWN0aXZlX3VzZXJzLAogICAgICAgICJw
ZW5kaW5nX3VzZXJzIjogcGVuZGluZ191c2VycywKICAgICAgICAiaW5hY3RpdmVfdXNlcnMiOiB0
b3RhbF91c2VycyAtIGFjdGl2ZV91c2VycyAtIHBlbmRpbmdfdXNlcnMsCiAgICAgICAgInRvdGFs
X2VhcyI6IHRvdGFsX2VhcywKICAgICAgICAidG90YWxfbGljZW5zZXMiOiB0b3RhbF9saWNlbnNl
cywKICAgICAgICAidXNlZF9saWNlbnNlcyI6IHVzZWRfbGljZW5zZXMsCiAgICAgICAgImF2YWls
YWJsZV9saWNlbnNlcyI6IHRvdGFsX2xpY2Vuc2VzIC0gdXNlZF9saWNlbnNlcwogICAgfQoKQGFw
aV9yb3V0ZXIucG9zdCgiL2FkbWluL2xpY2Vuc2VzL2dlbmVyYXRlIikKYXN5bmMgZGVmIGdlbmVy
YXRlX2xpY2Vuc2VzKGNvdW50OiBpbnQsIGN1cnJlbnRfYWRtaW4gPSBEZXBlbmRzKGdldF9jdXJy
ZW50X2FkbWluKSk6CiAgICAiIiJHZW5lcmF0ZSBuZXcgbGljZW5zZSBrZXlzIChhZG1pbiBvbmx5
KSIiIgogICAgdHJ5OgogICAgICAgIGlmIGNvdW50IDw9IDAgb3IgY291bnQgPiAxMDAwOgogICAg
ICAgICAgICByYWlzZSBIVFRQRXhjZXB0aW9uKHN0YXR1c19jb2RlPTQwMCwgZGV0YWlsPSJDb3Vu
dCBtdXN0IGJlIGJldHdlZW4gMSBhbmQgMTAwMCIpCiAgICAgICAgCiAgICAgICAga2V5cyA9IExp
Y2Vuc2VNYW5hZ2VyLmdlbmVyYXRlX211bHRpcGxlX2tleXMoY291bnQpCiAgICAgICAgbGljZW5z
ZXMgPSBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICJrZXkiOiBrZXksCiAgICAgICAg
ICAgICAgICAidXNlZCI6IEZhbHNlLAogICAgICAgICAgICAgICAgImNyZWF0ZWRfYXQiOiBkYXRl
dGltZS51dGNub3coKSwKICAgICAgICAgICAgICAgICJjcmVhdGVkX2J5Ijogc3RyKGN1cnJlbnRf
YWRtaW5bIl9pZCJdKQogICAgICAgICAgICB9CiAgICAgICAgICAgIGZvciBrZXkgaW4ga2V5cwog
ICAgICAgIF0KICAgICAgICBhd2FpdCBkYi5saWNlbnNlX2tleXMuaW5zZXJ0X21hbnkobGljZW5z
ZXMpCiAgICAgICAgcmV0dXJuIHsibWVzc2FnZSI6IGYiR2VuZXJhdGVkIHtjb3VudH0gbGljZW5z
ZSBrZXlzIiwgImtleXMiOiBrZXlzfQogICAgCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAg
ICAgICAgcHJpbnQoZiJFcnJvciBnZW5lcmF0aW5nIGxpY2Vuc2Uga2V5czoge2V9IikKICAgICAg
ICByYWlzZSBIVFRQRXhjZXB0aW9uKHN0YXR1c19jb2RlPTUwMCwgZGV0YWlsPWYiRmFpbGVkIHRv
IGdlbmVyYXRlIGxpY2Vuc2Uga2V5czoge3N0cihlKX0iKQoKQGFwaV9yb3V0ZXIuZ2V0KCIvYWRt
aW4vbGljZW5zZXMiKQphc3luYyBkZWYgZ2V0X2FsbF9saWNlbnNlcyhjdXJyZW50X2FkbWluID0g
RGVwZW5kcyhnZXRfY3VycmVudF9hZG1pbikpOgogICAgIiIiR2V0IGFsbCBsaWNlbnNlIGtleXMg
KGFkbWluIG9ubHkpIiIiCiAgICBsaWNlbnNlcyA9IGF3YWl0IGRiLmxpY2Vuc2VzLmZpbmQoKS5z
b3J0KCJjcmVhdGVkX2F0IiwgLTEpLnRvX2xpc3QoMTAwMCkKICAgIHJldHVybiBbc2VyaWFsaXpl
X2RvYyhsaWNlbnNlKSBmb3IgbGljZW5zZSBpbiBsaWNlbnNlc10KCkBhcGlfcm91dGVyLmRlbGV0
ZSgiL2FkbWluL2xpY2Vuc2VzL3tsaWNlbnNlX2tleX0iKQphc3luYyBkZWYgZGVsZXRlX2xpY2Vu
c2UobGljZW5zZV9rZXk6IHN0ciwgY3VycmVudF9hZG1pbiA9IERlcGVuZHMoZ2V0X2N1cnJlbnRf
YWRtaW4pKToKICAgICIiIkRlbGV0ZSBhIGxpY2Vuc2Uga2V5IChhZG1pbiBvbmx5KSIiIgogICAg
cmVzdWx0ID0gYXdhaXQgZGIubGljZW5zZXMuZGVsZXRlX29uZSh7ImtleSI6IGxpY2Vuc2Vfa2V5
fSkKICAgIGlmIHJlc3VsdC5kZWxldGVkX2NvdW50ID09IDA6CiAgICAgICAgcmFpc2UgSFRUUEV4
Y2VwdGlvbihzdGF0dXNfY29kZT00MDQsIGRldGFpbD0iTGljZW5zZSBrZXkgbm90IGZvdW5kIikK
ICAgIHJldHVybiB7Im1lc3NhZ2UiOiAiTGljZW5zZSBkZWxldGVkIHN1Y2Nlc3NmdWxseSJ9Cgoj
IER1cGxpY2F0ZSBkZWxldGVfdXNlciBlbmRwb2ludCByZW1vdmVkIC0gc2VlIGxpbmUgMTAzOSBm
b3IgdGhlIGNvbXBsZXRlIGltcGxlbWVudGF0aW9uCgpAYXBpX3JvdXRlci5wb3N0KCIvYWRtaW4v
dXNlcnMve3VzZXJfaWR9L2FjdGl2YXRlIikKYXN5bmMgZGVmIGFjdGl2YXRlX3VzZXIodXNlcl9p
ZDogc3RyLCBjdXJyZW50X2FkbWluID0gRGVwZW5kcyhnZXRfY3VycmVudF9hZG1pbikpOgogICAg
IiIiQWN0aXZhdGUgYSB1c2VyIChhZG1pbiBvbmx5KSIiIgogICAgdHJ5OgogICAgICAgICMgR2V0
IHVzZXIgZmlyc3QgZm9yIGVtYWlsCiAgICAgICAgdXNlciA9IGF3YWl0IGRiLnVzZXJzLmZpbmRf
b25lKHsiX2lkIjogT2JqZWN0SWQodXNlcl9pZCl9KQogICAgICAgIGlmIG5vdCB1c2VyOgogICAg
ICAgICAgICByYWlzZSBIVFRQRXhjZXB0aW9uKHN0YXR1c19jb2RlPTQwNCwgZGV0YWlsPSJVc2Vy
IG5vdCBmb3VuZCIpCiAgICAgICAgCiAgICAgICAgcmVzdWx0ID0gYXdhaXQgZGIudXNlcnMudXBk
YXRlX29uZSgKICAgICAgICAgICAgeyJfaWQiOiBPYmplY3RJZCh1c2VyX2lkKX0sCiAgICAgICAg
ICAgIHsiJHNldCI6IHsic3RhdHVzIjogImFjdGl2ZSIsICJ1cGRhdGVkX2F0IjogZGF0ZXRpbWUu
dXRjbm93KCl9fQogICAgICAgICkKICAgICAgICBpZiByZXN1bHQubW9kaWZpZWRfY291bnQgPT0g
MDoKICAgICAgICAgICAgcmFpc2UgSFRUUEV4Y2VwdGlvbihzdGF0dXNfY29kZT00MDQsIGRldGFp
bD0iVXNlciBub3QgZm91bmQiKQogICAgICAgIAogICAgICAgICMgU2VuZCBhcHByb3ZhbCBlbWFp
bAogICAgICAgIHVzZXJfZW1haWwgPSB1c2VyLmdldCgnZW1haWwnLCAnJykKICAgICAgICB1c2Vy
X25hbWUgPSB1c2VyLmdldCgnbmFtZScsICdVc2VyJykKICAgICAgICBhd2FpdCBlbWFpbF9zZXJ2
aWNlLnNlbmRfYXBwcm92YWxfZW1haWwodXNlcl9lbWFpbCwgdXNlcl9uYW1lKQogICAgICAgIAog
ICAgICAgIHJldHVybiB7Im1lc3NhZ2UiOiAiVXNlciBhY3RpdmF0ZWQgc3VjY2Vzc2Z1bGx5In0K
ICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICByYWlzZSBIVFRQRXhjZXB0aW9uKHN0
YXR1c19jb2RlPTQwMCwgZGV0YWlsPXN0cihlKSkKCkBhcGlfcm91dGVyLnBvc3QoIi9hZG1pbi91
c2Vycy97dXNlcl9pZH0vZGVhY3RpdmF0ZSIpCmFzeW5jIGRlZiBkZWFjdGl2YXRlX3VzZXIodXNl
cl9pZDogc3RyLCBjdXJyZW50X2FkbWluID0gRGVwZW5kcyhnZXRfY3VycmVudF9hZG1pbikpOgog
ICAgIiIiRGVhY3RpdmF0ZSBhIHVzZXIgKGFkbWluIG9ubHkpIiIiCiAgICByZXN1bHQgPSBhd2Fp
dCBkYi51c2Vycy51cGRhdGVfb25lKAogICAgICAgIHsiX2lkIjogT2JqZWN0SWQodXNlcl9pZCl9
LAogICAgICAgIHsiJHNldCI6IHsic3RhdHVzIjogImluYWN0aXZlIiwgInVwZGF0ZWRfYXQiOiBk
YXRldGltZS51dGNub3coKX19CiAgICApCiAgICAKICAgIGlmIHJlc3VsdC5tb2RpZmllZF9jb3Vu
dCA+IDA6CiAgICAgICAgcmV0dXJuIHsibWVzc2FnZSI6ICJVc2VyIGRlYWN0aXZhdGVkIHN1Y2Nl
c3NmdWxseSJ9CiAgICBlbHNlOgogICAgICAgIHJhaXNlIEhUVFBFeGNlcHRpb24oc3RhdHVzX2Nv
ZGU9NDA0LCBkZXRhaWw9IlVzZXIgbm90IGZvdW5kIikKCkBhcGlfcm91dGVyLnBvc3QoIi9hZG1p
bi91c2Vycy97dXNlcl9pZH0vcmVzZXQtcGFzc3dvcmQiKQphc3luYyBkZWYgcmVzZXRfdXNlcl9w
YXNzd29yZCh1c2VyX2lkOiBzdHIsIGN1cnJlbnRfYWRtaW4gPSBEZXBlbmRzKGdldF9jdXJyZW50
X2FkbWluKSk6CiAgICAiIiJHZW5lcmF0ZSB0ZW1wb3JhcnkgcGFzc3dvcmQgZm9yIHVzZXIgKGFk
bWluIG9ubHkpIiIiCiAgICAjIEdldCB1c2VyCiAgICB1c2VyID0gYXdhaXQgZGIudXNlcnMuZmlu
ZF9vbmUoeyJfaWQiOiBPYmplY3RJZCh1c2VyX2lkKX0pCiAgICBpZiBub3QgdXNlcjoKICAgICAg
ICByYWlzZSBIVFRQRXhjZXB0aW9uKHN0YXR1c19jb2RlPTQwNCwgZGV0YWlsPSJVc2VyIG5vdCBm
b3VuZCIpCiAgICAKICAgICMgR2VuZXJhdGUgc2VjdXJlIHRlbXBvcmFyeSBwYXNzd29yZCAoMTIg
Y2hhcmFjdGVyczogbGV0dGVycywgZGlnaXRzLCBzcGVjaWFsIGNoYXJzKQogICAgYWxwaGFiZXQg
PSBzdHJpbmcuYXNjaWlfbGV0dGVycyArIHN0cmluZy5kaWdpdHMgKyAiIUAjJCVeJioiCiAgICB0
ZW1wX3Bhc3N3b3JkID0gJycuam9pbihzZWNyZXRzLmNob2ljZShhbHBoYWJldCkgZm9yIGkgaW4g
cmFuZ2UoMTIpKQogICAgCiAgICAjIEhhc2ggdGhlIHRlbXBvcmFyeSBwYXNzd29yZAogICAgaGFz
aGVkX3Bhc3N3b3JkID0gZ2V0X3Bhc3N3b3JkX2hhc2godGVtcF9wYXNzd29yZCkKICAgIAogICAg
IyBVcGRhdGUgdXNlciBwYXNzd29yZCBhbmQgc2V0IGZsYWcgZm9yIHBhc3N3b3JkIGNoYW5nZQog
ICAgcmVzdWx0ID0gYXdhaXQgZGIudXNlcnMudXBkYXRlX29uZSgKICAgICAgICB7Il9pZCI6IE9i
amVjdElkKHVzZXJfaWQpfSwKICAgICAgICB7CiAgICAgICAgICAgICIkc2V0IjogewogICAgICAg
ICAgICAgICAgInBhc3N3b3JkX2hhc2giOiBoYXNoZWRfcGFzc3dvcmQsCiAgICAgICAgICAgICAg
ICAicmVxdWlyZXNfcGFzc3dvcmRfY2hhbmdlIjogVHJ1ZSwKICAgICAgICAgICAgICAgICJwYXNz
d29yZF9yZXNldF9hdCI6IGRhdGV0aW1lLnV0Y25vdygpLAogICAgICAgICAgICAgICAgInBhc3N3
b3JkX3Jlc2V0X2J5IjogImFkbWluIgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgKQogICAg
CiAgICBpZiByZXN1bHQubW9kaWZpZWRfY291bnQgPiAwOgogICAgICAgIHVzZXJfZW1haWwgPSB1
c2VyLmdldCgnZW1haWwnLCAnJykKICAgICAgICB1c2VyX25hbWUgPSB1c2VyLmdldCgnbmFtZScs
ICdVc2VyJykKICAgICAgICAKICAgICAgICBsb2dnZXIuaW5mbyhmIuKchSBBZG1pbiByZXNldCBw
YXNzd29yZCBmb3IgdXNlcjoge3VzZXJfZW1haWx9IikKICAgICAgICBsb2dnZXIuaW5mbyhmIvCf
lJEgVEVNUE9SQVJZIFBBU1NXT1JEIEZPUiB7dXNlcl9lbWFpbH06IHt0ZW1wX3Bhc3N3b3JkfSIp
CiAgICAgICAgCiAgICAgICAgIyBMb2cgYWN0aXZpdHkKICAgICAgICBhd2FpdCBkYi51c2VyX2Fj
dGl2aXR5Lmluc2VydF9vbmUoewogICAgICAgICAgICAidXNlcl9pZCI6IHVzZXJfaWQsCiAgICAg
ICAgICAgICJhY3Rpb24iOiAicGFzc3dvcmRfcmVzZXRfYnlfYWRtaW4iLAogICAgICAgICAgICAi
ZGV0YWlscyI6IHsiZW1haWwiOiB1c2VyX2VtYWlsLCAiYWRtaW5faWQiOiBzdHIoY3VycmVudF9h
ZG1pblsiX2lkIl0pfSwKICAgICAgICAgICAgInRpbWVzdGFtcCI6IGRhdGV0aW1lLnV0Y25vdygp
CiAgICAgICAgfSkKICAgICAgICAKICAgICAgICAjIFNlbmQgcGFzc3dvcmQgcmVzZXQgZW1haWwK
ICAgICAgICBlbWFpbF9zZW50ID0gYXdhaXQgZW1haWxfc2VydmljZS5zZW5kX3Bhc3N3b3JkX3Jl
c2V0X2VtYWlsKHVzZXJfZW1haWwsIHVzZXJfbmFtZSwgdGVtcF9wYXNzd29yZCwgaXNfbWVudG9y
PUZhbHNlKQogICAgICAgIAogICAgICAgIGlmIG5vdCBlbWFpbF9zZW50OgogICAgICAgICAgICBs
b2dnZXIud2FybmluZyhmIvCfk6cgTUFOVUFMIEFDVElPTiBSRVFVSVJFRDogU2VuZCB0aGlzIHBh
c3N3b3JkIHRvIHt1c2VyX2VtYWlsfToge3RlbXBfcGFzc3dvcmR9IikKICAgICAgICAKICAgICAg
ICByZXR1cm4gewogICAgICAgICAgICAibWVzc2FnZSI6ICJUZW1wb3JhcnkgcGFzc3dvcmQgZ2Vu
ZXJhdGVkIHN1Y2Nlc3NmdWxseSIsCiAgICAgICAgICAgICJ0ZW1wb3JhcnlfcGFzc3dvcmQiOiB0
ZW1wX3Bhc3N3b3JkLAogICAgICAgICAgICAidXNlcl9lbWFpbCI6IHVzZXIuZ2V0KCJlbWFpbCIp
CiAgICAgICAgfQogICAgZWxzZToKICAgICAgICByYWlzZSBIVFRQRXhjZXB0aW9uKHN0YXR1c19j
b2RlPTUwMCwgZGV0YWlsPSJGYWlsZWQgdG8gcmVzZXQgcGFzc3dvcmQiKQoKQGFwaV9yb3V0ZXIu
cG9zdCgiL2FkbWluL21lbnRvcnMve21lbnRvcl9pZH0vcmVzZXQtcGFzc3dvcmQiKQphc3luYyBk
ZWYgcmVzZXRfbWVudG9yX3Bhc3N3b3JkKG1lbnRvcl9pZDogc3RyLCBjdXJyZW50X2FkbWluID0g
RGVwZW5kcyhnZXRfY3VycmVudF9hZG1pbikpOgogICAgIiIiR2VuZXJhdGUgdGVtcG9yYXJ5IHBh
c3N3b3JkIGZvciBtZW50b3IgKGFkbWluIG9ubHkpIiIiCiAgICAjIEdldCBtZW50b3IKICAgIG1l
bnRvciA9IGF3YWl0IGRiLm1lbnRvcnMuZmluZF9vbmUoeyJfaWQiOiBPYmplY3RJZChtZW50b3Jf
aWQpfSkKICAgIGlmIG5vdCBtZW50b3I6CiAgICAgICAgcmFpc2UgSFRUUEV4Y2VwdGlvbihzdGF0
dXNfY29kZT00MDQsIGRldGFpbD0iTWVudG9yIG5vdCBmb3VuZCIpCiAgICAKICAgICMgR2VuZXJh
dGUgc2VjdXJlIHRlbXBvcmFyeSBwYXNzd29yZCAoMTIgY2hhcmFjdGVyczogbGV0dGVycywgZGln
aXRzLCBzcGVjaWFsIGNoYXJzKQogICAgYWxwaGFiZXQgPSBzdHJpbmcuYXNjaWlfbGV0dGVycyAr
IHN0cmluZy5kaWdpdHMgKyAiIUAjJCVeJioiCiAgICB0ZW1wX3Bhc3N3b3JkID0gJycuam9pbihz
ZWNyZXRzLmNob2ljZShhbHBoYWJldCkgZm9yIGkgaW4gcmFuZ2UoMTIpKQogICAgCiAgICAjIEhh
c2ggdGhlIHRlbXBvcmFyeSBwYXNzd29yZAogICAgaGFzaGVkX3Bhc3N3b3JkID0gZ2V0X3Bhc3N3
b3JkX2hhc2godGVtcF9wYXNzd29yZCkKICAgIAogICAgIyBVcGRhdGUgbWVudG9yIHBhc3N3b3Jk
IGFuZCBzZXQgZmxhZyBmb3IgcGFzc3dvcmQgY2hhbmdlCiAgICByZXN1bHQgPSBhd2FpdCBkYi5t
ZW50b3JzLnVwZGF0ZV9vbmUoCiAgICAgICAgeyJfaWQiOiBPYmplY3RJZChtZW50b3JfaWQpfSwK
ICAgICAgICB7CiAgICAgICAgICAgICIkc2V0IjogewogICAgICAgICAgICAgICAgInBhc3N3b3Jk
X2hhc2giOiBoYXNoZWRfcGFzc3dvcmQsCiAgICAgICAgICAgICAgICAicmVxdWlyZXNfcGFzc3dv
cmRfY2hhbmdlIjogVHJ1ZSwKICAgICAgICAgICAgICAgICJwYXNzd29yZF9yZXNldF9hdCI6IGRh
dGV0aW1lLnV0Y25vdygpLAogICAgICAgICAgICAgICAgInBhc3N3b3JkX3Jlc2V0X2J5IjogImFk
bWluIgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgKQogICAgCiAgICBpZiByZXN1bHQubW9k
aWZpZWRfY291bnQgPiAwOgogICAgICAgIG1lbnRvcl9lbWFpbCA9IG1lbnRvci5nZXQoJ2VtYWls
JywgJycpCiAgICAgICAgbWVudG9yX25hbWUgPSBtZW50b3IuZ2V0KCduYW1lJywgJ01lbnRvcicp
CiAgICAgICAgCiAgICAgICAgbG9nZ2VyLmluZm8oZiLinIUgQWRtaW4gcmVzZXQgcGFzc3dvcmQg
Zm9yIG1lbnRvcjoge21lbnRvcl9lbWFpbH0iKQogICAgICAgIGxvZ2dlci5pbmZvKGYi8J+UkSBU
RU1QT1JBUlkgUEFTU1dPUkQgRk9SIHttZW50b3JfZW1haWx9OiB7dGVtcF9wYXNzd29yZH0iKQog
ICAgICAgIAogICAgICAgICMgTG9nIGFjdGl2aXR5CiAgICAgICAgYXdhaXQgZGIubWVudG9yX2Fj
dGl2aXR5Lmluc2VydF9vbmUoewogICAgICAgICAgICAibWVudG9yX2lkIjogbWVudG9yX2lkLAog
ICAgICAgICAgICAiYWN0aW9uIjogInBhc3N3b3JkX3Jlc2V0X2J5X2FkbWluIiwKICAgICAgICAg
ICAgImRldGFpbHMiOiB7ImVtYWlsIjogbWVudG9yX2VtYWlsLCAiYWRtaW5faWQiOiBzdHIoY3Vy
cmVudF9hZG1pblsiX2lkIl0pfSwKICAgICAgICAgICAgInRpbWVzdGFtcCI6IGRhdGV0aW1lLnV0
Y25vdygpCiAgICAgICAgfSkKICAgICAgICAKICAgICAgICAjIFNlbmQgcGFzc3dvcmQgcmVzZXQg
ZW1haWwgKG1lbnRvcnMgdXNlIHNhbWUgZW1haWwgc2VydmljZSkKICAgICAgICBlbWFpbF9zZW50
ID0gYXdhaXQgZW1haWxfc2VydmljZS5zZW5kX3Bhc3N3b3JkX3Jlc2V0X2VtYWlsKG1lbnRvcl9l
bWFpbCwgbWVudG9yX25hbWUsIHRlbXBfcGFzc3dvcmQsIGlzX21lbnRvcj1UcnVlKQogICAgICAg
IAogICAgICAgIGlmIG5vdCBlbWFpbF9zZW50OgogICAgICAgICAgICBsb2dnZXIud2FybmluZyhm
IvCfk6cgTUFOVUFMIEFDVElPTiBSRVFVSVJFRDogU2VuZCB0aGlzIHBhc3N3b3JkIHRvIG1lbnRv
ciB7bWVudG9yX2VtYWlsfToge3RlbXBfcGFzc3dvcmR9IikKICAgICAgICAKICAgICAgICByZXR1
cm4gewogICAgICAgICAgICAibWVzc2FnZSI6ICJUZW1wb3JhcnkgcGFzc3dvcmQgZ2VuZXJhdGVk
IHN1Y2Nlc3NmdWxseSBmb3IgbWVudG9yIiwKICAgICAgICAgICAgInRlbXBvcmFyeV9wYXNzd29y
ZCI6IHRlbXBfcGFzc3dvcmQsCiAgICAgICAgICAgICJtZW50b3JfZW1haWwiOiBtZW50b3IuZ2V0
KCJlbWFpbCIpCiAgICAgICAgfQogICAgZWxzZToKICAgICAgICByYWlzZSBIVFRQRXhjZXB0aW9u
KHN0YXR1c19jb2RlPTUwMCwgZGV0YWlsPSJGYWlsZWQgdG8gcmVzZXQgbWVudG9yIHBhc3N3b3Jk
IikKCkBhcGlfcm91dGVyLmRlbGV0ZSgiL2FkbWluL3VzZXJzL3t1c2VyX2lkfSIpCmFzeW5jIGRl
ZiBkZWxldGVfdXNlcih1c2VyX2lkOiBzdHIsIGN1cnJlbnRfYWRtaW4gPSBEZXBlbmRzKGdldF9j
dXJyZW50X2FkbWluKSk6CiAgICAiIiJEZWxldGUgYSB1c2VyIHBlcm1hbmVudGx5IChhZG1pbiBv
bmx5KSIiIgogICAgdHJ5OgogICAgICAgICMgR2V0IHVzZXIgaW5mbyBiZWZvcmUgZGVsZXRpb24g
Zm9yIGxvZ2dpbmcKICAgICAgICB1c2VyID0gYXdhaXQgZGIudXNlcnMuZmluZF9vbmUoeyJfaWQi
OiBPYmplY3RJZCh1c2VyX2lkKX0pCiAgICAgICAgaWYgbm90IHVzZXI6CiAgICAgICAgICAgIHJh
aXNlIEhUVFBFeGNlcHRpb24oc3RhdHVzX2NvZGU9NDA0LCBkZXRhaWw9IlVzZXIgbm90IGZvdW5k
IikKICAgICAgICAKICAgICAgICAjIERlbGV0ZSB1c2VyCiAgICAgICAgcmVzdWx0ID0gYXdhaXQg
ZGIudXNlcnMuZGVsZXRlX29uZSh7Il9pZCI6IE9iamVjdElkKHVzZXJfaWQpfSkKICAgICAgICAK
ICAgICAgICBpZiByZXN1bHQuZGVsZXRlZF9jb3VudCA+IDA6CiAgICAgICAgICAgICMgTG9nIHRo
ZSBkZWxldGlvbgogICAgICAgICAgICBhd2FpdCBkYi51c2VyX2FjdGl2aXR5Lmluc2VydF9vbmUo
ewogICAgICAgICAgICAgICAgInVzZXJfaWQiOiB1c2VyX2lkLAogICAgICAgICAgICAgICAgImFj
dGlvbiI6ICJ1c2VyX2RlbGV0ZWRfYnlfYWRtaW4iLAogICAgICAgICAgICAgICAgImRldGFpbHMi
OiB7CiAgICAgICAgICAgICAgICAgICAgImVtYWlsIjogdXNlci5nZXQoImVtYWlsIiksCiAgICAg
ICAgICAgICAgICAgICAgIm5hbWUiOiB1c2VyLmdldCgibmFtZSIpLAogICAgICAgICAgICAgICAg
ICAgICJhZG1pbl9pZCI6IHN0cihjdXJyZW50X2FkbWluWyJfaWQiXSkKICAgICAgICAgICAgICAg
IH0sCiAgICAgICAgICAgICAgICAidGltZXN0YW1wIjogZGF0ZXRpbWUudXRjbm93KCkKICAgICAg
ICAgICAgfSkKICAgICAgICAgICAgCiAgICAgICAgICAgICMgQWxzbyBkZWxldGUgcmVsYXRlZCBk
YXRhIChFQXMsIHBheW1lbnQgdHJhbnNhY3Rpb25zKQogICAgICAgICAgICBhd2FpdCBkYi5lYXMu
ZGVsZXRlX21hbnkoeyJ1c2VyX2lkIjogdXNlcl9pZH0pCiAgICAgICAgICAgIGF3YWl0IGRiLnBh
eW1lbnRfdHJhbnNhY3Rpb25zLmRlbGV0ZV9tYW55KHsidXNlcl9pZCI6IHVzZXJfaWR9KQogICAg
ICAgICAgICAKICAgICAgICAgICAgcmV0dXJuIHsibWVzc2FnZSI6ICJVc2VyIGRlbGV0ZWQgc3Vj
Y2Vzc2Z1bGx5IiwgImRlbGV0ZWRfZW1haWwiOiB1c2VyLmdldCgiZW1haWwiKX0KICAgICAgICBl
bHNlOgogICAgICAgICAgICByYWlzZSBIVFRQRXhjZXB0aW9uKHN0YXR1c19jb2RlPTQwNCwgZGV0
YWlsPSJVc2VyIG5vdCBmb3VuZCIpCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAg
bG9nZ2VyLmVycm9yKGYiRXJyb3IgZGVsZXRpbmcgdXNlcjoge3N0cihlKX0iKQogICAgICAgIHJh
aXNlIEhUVFBFeGNlcHRpb24oc3RhdHVzX2NvZGU9NTAwLCBkZXRhaWw9ZiJGYWlsZWQgdG8gZGVs
ZXRlIHVzZXI6IHtzdHIoZSl9IikKCkBhcGlfcm91dGVyLmdldCgiL2FkbWluL21lbnRvcnMiKQph
c3luYyBkZWYgZ2V0X21lbnRvcnMoY3VycmVudF9hZG1pbiA9IERlcGVuZHMoZ2V0X2N1cnJlbnRf
YWRtaW4pKToKICAgICIiIkdldCBhbGwgbWVudG9ycyAoaW5jbHVkaW5nIHBlbmRpbmcpIiIiCiAg
ICBtZW50b3JzID0gYXdhaXQgZGIubWVudG9ycy5maW5kKHt9KS50b19saXN0KGxlbmd0aD1Ob25l
KQogICAgCiAgICByZXN1bHQgPSBbXQogICAgZm9yIG1lbnRvciBpbiBtZW50b3JzOgogICAgICAg
ICMgQ291bnQgdXNlcnMgZm9yIHRoaXMgbWVudG9yIChvbmx5IGlmIG1lbnRvciBoYXMgbWVudG9y
X2lkKQogICAgICAgIHVzZXJfY291bnQgPSAwCiAgICAgICAgaWYgbWVudG9yLmdldCgibWVudG9y
X2lkIik6CiAgICAgICAgICAgIHVzZXJfY291bnQgPSBhd2FpdCBkYi51c2Vycy5jb3VudF9kb2N1
bWVudHMoeyJtZW50b3JfaWQiOiBtZW50b3IuZ2V0KCJtZW50b3JfaWQiKX0pCiAgICAgICAgCiAg
ICAgICAgIyBHZXQgbGljZW5zZSBrZXlzIGZvciB0aGlzIG1lbnRvciAob25seSBpZiBtZW50b3Ig
aGFzIG1lbnRvcl9pZCkKICAgICAgICBsaWNlbnNlcyA9IFtdCiAgICAgICAgaWYgbWVudG9yLmdl
dCgibWVudG9yX2lkIik6CiAgICAgICAgICAgIGxpY2Vuc2VzID0gYXdhaXQgZGIubGljZW5zZXMu
ZmluZCh7Im1lbnRvcl9pZCI6IG1lbnRvci5nZXQoIm1lbnRvcl9pZCIpfSkudG9fbGlzdChsZW5n
dGg9Tm9uZSkKICAgICAgICAKICAgICAgICByZXN1bHQuYXBwZW5kKHsKICAgICAgICAgICAgIl9p
ZCI6IHN0cihtZW50b3IuZ2V0KCJfaWQiKSksCiAgICAgICAgICAgICJuYW1lIjogbWVudG9yLmdl
dCgibmFtZSIpLAogICAgICAgICAgICAiZW1haWwiOiBtZW50b3IuZ2V0KCJlbWFpbCIpLAogICAg
ICAgICAgICAicGhvbmUiOiBtZW50b3IuZ2V0KCJwaG9uZSIpLAogICAgICAgICAgICAic29jaWFs
X21lZGlhIjogbWVudG9yLmdldCgic29jaWFsX21lZGlhIiksCiAgICAgICAgICAgICJsaWNlbnNl
X2tleSI6IG1lbnRvci5nZXQoImxpY2Vuc2Vfa2V5IiksCiAgICAgICAgICAgICJtZW50b3JfaWQi
OiBtZW50b3IuZ2V0KCJtZW50b3JfaWQiKSwKICAgICAgICAgICAgImNvbXBhbnlfbmFtZSI6IG1l
bnRvci5nZXQoImNvbXBhbnlfbmFtZSIpLAogICAgICAgICAgICAic3RhdHVzIjogbWVudG9yLmdl
dCgic3RhdHVzIiwgImFjdGl2ZSIpLAogICAgICAgICAgICAidXNlcl9jb3VudCI6IHVzZXJfY291
bnQsCiAgICAgICAgICAgICJjcmVhdGVkX2F0IjogbWVudG9yLmdldCgiY3JlYXRlZF9hdCIpLAog
ICAgICAgICAgICAibGljZW5zZXMiOiBbc2VyaWFsaXplX2RvYyhsaWMpIGZvciBsaWMgaW4gbGlj
ZW5zZXNdCiAgICAgICAgfSkKICAgIAogICAgcmV0dXJuIHJlc3VsdAoKQGFwaV9yb3V0ZXIucG9z
dCgiL2FkbWluL21lbnRvci1hY2Nlc3Mta2V5cy9nZW5lcmF0ZSIpCmFzeW5jIGRlZiBnZW5lcmF0
ZV9tZW50b3JfYWNjZXNzX2tleXMoCiAgICByZXF1ZXN0X2RhdGE6IGRpY3QgPSBCb2R5KC4uLiks
CiAgICBjdXJyZW50X2FkbWluID0gRGVwZW5kcyhnZXRfY3VycmVudF9hZG1pbikKKToKICAgICIi
IkdlbmVyYXRlIG1lbnRvciBhY2Nlc3Mga2V5cyAoYWRtaW4gb25seSkiIiIKICAgIGNvdW50ID0g
cmVxdWVzdF9kYXRhLmdldCgiY291bnQiLCAxKQogICAgCiAgICAjIFZhbGlkYXRlIGNvdW50CiAg
ICBpZiBub3QgaXNpbnN0YW5jZShjb3VudCwgaW50KSBvciBjb3VudCA8IDEgb3IgY291bnQgPiA1
MDoKICAgICAgICByYWlzZSBIVFRQRXhjZXB0aW9uKHN0YXR1c19jb2RlPTQwMCwgZGV0YWlsPSJD
b3VudCBtdXN0IGJlIGJldHdlZW4gMSBhbmQgNTAiKQogICAgCiAgICBrZXlzID0gW10KICAgIAog
ICAgZm9yIF8gaW4gcmFuZ2UoY291bnQpOgogICAgICAgICMgR2VuZXJhdGUgdW5pcXVlIGFjY2Vz
cyBrZXkKICAgICAgICBhY2Nlc3Nfa2V5ID0gJycuam9pbihzZWNyZXRzLmNob2ljZShzdHJpbmcu
YXNjaWlfdXBwZXJjYXNlICsgc3RyaW5nLmRpZ2l0cykgZm9yIF8gaW4gcmFuZ2UoMTYpKQogICAg
ICAgIGFjY2Vzc19rZXlfZm9ybWF0dGVkID0gZiJNQUste2FjY2Vzc19rZXlbOjRdfS17YWNjZXNz
X2tleVs0OjhdfS17YWNjZXNzX2tleVs4OjEyXX0te2FjY2Vzc19rZXlbMTI6MTZdfSIKICAgICAg
ICAKICAgICAgICBrZXlfZGF0YSA9IHsKICAgICAgICAgICAgImtleSI6IGFjY2Vzc19rZXlfZm9y
bWF0dGVkLAogICAgICAgICAgICAidXNlZCI6IEZhbHNlLAogICAgICAgICAgICAiY3JlYXRlZF9h
dCI6IGRhdGV0aW1lLm5vdygpLAogICAgICAgICAgICAiY3JlYXRlZF9ieSI6ICJhZG1pbiIKICAg
ICAgICB9CiAgICAgICAgCiAgICAgICAgYXdhaXQgZGIubWVudG9yX2FjY2Vzc19rZXlzLmluc2Vy
dF9vbmUoa2V5X2RhdGEpCiAgICAgICAga2V5cy5hcHBlbmQoYWNjZXNzX2tleV9mb3JtYXR0ZWQp
CiAgICAKICAgIHJldHVybiB7CiAgICAgICAgIm1lc3NhZ2UiOiBmIkdlbmVyYXRlZCB7Y291bnR9
IG1lbnRvciBhY2Nlc3Mga2V5KHMpIiwKICAgICAgICAia2V5cyI6IGtleXMKICAgIH0KCkBhcGlf
cm91dGVyLmdldCgiL2FkbWluL21lbnRvci1hY2Nlc3Mta2V5cyIpCmFzeW5jIGRlZiBnZXRfbWVu
dG9yX2FjY2Vzc19rZXlzKGN1cnJlbnRfYWRtaW4gPSBEZXBlbmRzKGdldF9jdXJyZW50X2FkbWlu
KSk6CiAgICAiIiJHZXQgYWxsIG1lbnRvciBhY2Nlc3Mga2V5cyAoYWRtaW4gb25seSkiIiIKICAg
IGtleXMgPSBhd2FpdCBkYi5tZW50b3JfYWNjZXNzX2tleXMuZmluZCh7fSkuc29ydCgiY3JlYXRl
ZF9hdCIsIC0xKS50b19saXN0KGxlbmd0aD1Ob25lKQogICAgcmV0dXJuIFtzZXJpYWxpemVfZG9j
KGtleSkgZm9yIGtleSBpbiBrZXlzXQoKQGFwaV9yb3V0ZXIucG9zdCgiL2FkbWluL21lbnRvcnMv
e21lbnRvcl9kYl9pZH0vYXBwcm92ZSIpCmFzeW5jIGRlZiBhcHByb3ZlX21lbnRvcihtZW50b3Jf
ZGJfaWQ6IHN0ciwgY3VycmVudF9hZG1pbiA9IERlcGVuZHMoZ2V0X2N1cnJlbnRfYWRtaW4pKToK
ICAgICIiIkFwcHJvdmUgYSBwZW5kaW5nIG1lbnRvciBhbmQgZ2VuZXJhdGUgbWVudG9yIElEIiIi
CiAgICBmcm9tIGJzb24gaW1wb3J0IE9iamVjdElkCiAgICAKICAgICMgRmluZCBwZW5kaW5nIG1l
bnRvcgogICAgbWVudG9yID0gYXdhaXQgZGIubWVudG9ycy5maW5kX29uZSh7Il9pZCI6IE9iamVj
dElkKG1lbnRvcl9kYl9pZCl9KQogICAgaWYgbm90IG1lbnRvcjoKICAgICAgICByYWlzZSBIVFRQ
RXhjZXB0aW9uKHN0YXR1c19jb2RlPTQwNCwgZGV0YWlsPSJNZW50b3Igbm90IGZvdW5kIikKICAg
IAogICAgaWYgbWVudG9yLmdldCgic3RhdHVzIikgIT0gInBlbmRpbmciOgogICAgICAgIHJhaXNl
IEhUVFBFeGNlcHRpb24oc3RhdHVzX2NvZGU9NDAwLCBkZXRhaWw9Ik1lbnRvciBpcyBub3QgcGVu
ZGluZyBhcHByb3ZhbCIpCiAgICAKICAgICMgR2VuZXJhdGUgdW5pcXVlIG1lbnRvciBJRAogICAg
bWVudG9yX2NvdW50ID0gYXdhaXQgZGIubWVudG9ycy5jb3VudF9kb2N1bWVudHMoe30pCiAgICBt
ZW50b3JfaWQgPSBmIk1FTlRPUntzdHIobWVudG9yX2NvdW50ICsgMSkuemZpbGwoNCl9IgogICAg
CiAgICAjIFVwZGF0ZSBtZW50b3Igc3RhdHVzIGFuZCBhc3NpZ24gSUQKICAgIGF3YWl0IGRiLm1l
bnRvcnMudXBkYXRlX29uZSgKICAgICAgICB7Il9pZCI6IE9iamVjdElkKG1lbnRvcl9kYl9pZCl9
LAogICAgICAgIHsiJHNldCI6IHsKICAgICAgICAgICAgInN0YXR1cyI6ICJhY3RpdmUiLAogICAg
ICAgICAgICAibWVudG9yX2lkIjogbWVudG9yX2lkLAogICAgICAgICAgICAiYXBwcm92ZWRfYXQi
OiBkYXRldGltZS5ub3coKQogICAgICAgIH19CiAgICApCiAgICAKICAgICMgU2VuZCBtZW50b3Ig
YXBwcm92YWwgZW1haWwgd2l0aCBjcmVkZW50aWFscwogICAgbWVudG9yX2VtYWlsID0gbWVudG9y
LmdldCgiZW1haWwiKQogICAgY29tcGFueV9uYW1lID0gbWVudG9yLmdldCgiY29tcGFueV9uYW1l
IiwgIiIpCiAgICB0ZW1wX3Bhc3N3b3JkID0gbWVudG9yLmdldCgicGFzc3dvcmRfcGxhaW4iKSAg
IyBQYXNzd29yZCBmcm9tIHJlZ2lzdHJhdGlvbgogICAgZW1haWxfc2VydmljZS5zZW5kX21lbnRv
cl9hcHByb3ZhbF9lbWFpbChtZW50b3JfZW1haWwsIG1lbnRvcl9pZCwgY29tcGFueV9uYW1lLCB0
ZW1wX3Bhc3N3b3JkKQogICAgCiAgICAjIFByZXBhcmUgYXBwcm92YWwgaW5mbwogICAgYXBwcm92
YWxfaW5mbyA9IHsKICAgICAgICAibWVzc2FnZSI6ICJNZW50b3IgYXBwcm92ZWQgc3VjY2Vzc2Z1
bGx5IiwKICAgICAgICAibWVudG9yX2lkIjogbWVudG9yX2lkLAogICAgICAgICJlbWFpbCI6IG1l
bnRvci5nZXQoImVtYWlsIiksCiAgICAgICAgIm5hbWUiOiBtZW50b3IuZ2V0KCJuYW1lIiksCiAg
ICAgICAgImNvbXBhbnlfbmFtZSI6IGNvbXBhbnlfbmFtZSwKICAgICAgICAibG9naW5fY3JlZGVu
dGlhbHMiOiB7CiAgICAgICAgICAgICJlbWFpbCI6IG1lbnRvcl9lbWFpbCwKICAgICAgICAgICAg
InBhc3N3b3JkIjogdGVtcF9wYXNzd29yZCBpZiB0ZW1wX3Bhc3N3b3JkIGVsc2UgIltQYXNzd29y
ZCBzZXQgYnkgbWVudG9yXSIsCiAgICAgICAgICAgICJsb2dpbl91cmwiOiAiaHR0cHM6Ly9taS1p
bmRpY2F0b3ItbGl2ZS5wcmV2aWV3LmVtZXJnZW50YWdlbnQuY29tL21lbnRvci1sb2dpbiIKICAg
ICAgICB9CiAgICB9CiAgICAKICAgICMgUmVtb3ZlIHBsYWluIHBhc3N3b3JkIGZyb20gZGF0YWJh
c2UgYWZ0ZXIgYXBwcm92YWwgZm9yIHNlY3VyaXR5CiAgICBhd2FpdCBkYi5tZW50b3JzLnVwZGF0
ZV9vbmUoCiAgICAgICAgeyJfaWQiOiBPYmplY3RJZChtZW50b3JfZGJfaWQpfSwKICAgICAgICB7
IiR1bnNldCI6IHsicGFzc3dvcmRfcGxhaW4iOiAiIn19CiAgICApCiAgICAKICAgIHJldHVybiBh
cHByb3ZhbF9pbmZvCgpAYXBpX3JvdXRlci5wb3N0KCIvYWRtaW4vbWVudG9ycy97bWVudG9yX2Ri
X2lkfS9kZWNsaW5lIikKYXN5bmMgZGVmIGRlY2xpbmVfbWVudG9yKG1lbnRvcl9kYl9pZDogc3Ry
LCBjdXJyZW50X2FkbWluID0gRGVwZW5kcyhnZXRfY3VycmVudF9hZG1pbikpOgogICAgIiIiRGVj
bGluZSBhIHBlbmRpbmcgbWVudG9yIiIiCiAgICBmcm9tIGJzb24gaW1wb3J0IE9iamVjdElkCiAg
ICAKICAgICMgRmluZCBwZW5kaW5nIG1lbnRvcgogICAgbWVudG9yID0gYXdhaXQgZGIubWVudG9y
cy5maW5kX29uZSh7Il9pZCI6IE9iamVjdElkKG1lbnRvcl9kYl9pZCl9KQogICAgaWYgbm90IG1l
bnRvcjoKICAgICAgICByYWlzZSBIVFRQRXhjZXB0aW9uKHN0YXR1c19jb2RlPTQwNCwgZGV0YWls
PSJNZW50b3Igbm90IGZvdW5kIikKICAgIAogICAgaWYgbWVudG9yLmdldCgic3RhdHVzIikgIT0g
InBlbmRpbmciOgogICAgICAgIHJhaXNlIEhUVFBFeGNlcHRpb24oc3RhdHVzX2NvZGU9NDAwLCBk
ZXRhaWw9Ik1lbnRvciBpcyBub3QgcGVuZGluZyBhcHByb3ZhbCIpCiAgICAKICAgICMgVXBkYXRl
IG1lbnRvciBzdGF0dXMgdG8gZGVjbGluZWQKICAgIGF3YWl0IGRiLm1lbnRvcnMudXBkYXRlX29u
ZSgKICAgICAgICB7Il9pZCI6IE9iamVjdElkKG1lbnRvcl9kYl9pZCl9LAogICAgICAgIHsiJHNl
dCI6IHsKICAgICAgICAgICAgInN0YXR1cyI6ICJkZWNsaW5lZCIsCiAgICAgICAgICAgICJkZWNs
aW5lZF9hdCI6IGRhdGV0aW1lLm5vdygpCiAgICAgICAgfX0KICAgICkKICAgIAogICAgcmV0dXJu
IHsKICAgICAgICAibWVzc2FnZSI6ICJNZW50b3IgcmVnaXN0cmF0aW9uIGRlY2xpbmVkIiwKICAg
ICAgICAiZW1haWwiOiBtZW50b3IuZ2V0KCJlbWFpbCIpCiAgICB9CgpAYXBpX3JvdXRlci5kZWxl
dGUoIi9hZG1pbi9tZW50b3JzL3ttZW50b3JfZGJfaWR9IikKYXN5bmMgZGVmIGRlbGV0ZV9tZW50
b3IobWVudG9yX2RiX2lkOiBzdHIsIGN1cnJlbnRfYWRtaW4gPSBEZXBlbmRzKGdldF9jdXJyZW50
X2FkbWluKSk6CiAgICAiIiIKICAgIERlbGV0ZSBhIG1lbnRvciBwZXJtYW5lbnRseSAoYWRtaW4g
b25seSkuCiAgICBUaGlzIHdpbGw6CiAgICAxLiBEZWxldGUgdGhlIG1lbnRvciByZWNvcmQgZnJv
bSBkYXRhYmFzZQogICAgMi4gRGVsZXRlIGFsbCBhc3NvY2lhdGVkIGxpY2Vuc2Uga2V5cwogICAg
My4gRGVsZXRlIGFsbCBhc3NvY2lhdGVkIG1lbnRvciBhY2Nlc3Mga2V5cwogICAgNC4gTG9nIHRo
ZSBkZWxldGlvbiB3aXRoIHVzZXIgY291bnQKICAgIAogICAgTm90ZTogVXNlcnMgYXNzb2NpYXRl
ZCB3aXRoIHRoaXMgbWVudG9yX2lkIHdpbGwgcmVtYWluIGJ1dCB3aWxsIGhhdmUgYW4gb3JwaGFu
ZWQgbWVudG9yX2lkLgogICAgIiIiCiAgICBmcm9tIGJzb24gaW1wb3J0IE9iamVjdElkCiAgICAK
ICAgIHRyeToKICAgICAgICAjIEdldCBtZW50b3IgaW5mbyBiZWZvcmUgZGVsZXRpb24KICAgICAg
ICBtZW50b3IgPSBhd2FpdCBkYi5tZW50b3JzLmZpbmRfb25lKHsiX2lkIjogT2JqZWN0SWQobWVu
dG9yX2RiX2lkKX0pCiAgICAgICAgaWYgbm90IG1lbnRvcjoKICAgICAgICAgICAgcmFpc2UgSFRU
UEV4Y2VwdGlvbihzdGF0dXNfY29kZT00MDQsIGRldGFpbD0iTWVudG9yIG5vdCBmb3VuZCIpCiAg
ICAgICAgCiAgICAgICAgbWVudG9yX2lkID0gbWVudG9yLmdldCgibWVudG9yX2lkIikKICAgICAg
ICBtZW50b3JfZW1haWwgPSBtZW50b3IuZ2V0KCJlbWFpbCIpCiAgICAgICAgCiAgICAgICAgIyBD
b3VudCBhc3NvY2lhdGVkIHVzZXJzIGJlZm9yZSBkZWxldGlvbiAoZm9yIGxvZ2dpbmcpCiAgICAg
ICAgdXNlcl9jb3VudCA9IDAKICAgICAgICBpZiBtZW50b3JfaWQ6CiAgICAgICAgICAgIHVzZXJf
Y291bnQgPSBhd2FpdCBkYi51c2Vycy5jb3VudF9kb2N1bWVudHMoeyJtZW50b3JfaWQiOiBtZW50
b3JfaWR9KQogICAgICAgIAogICAgICAgICMgRGVsZXRlIG1lbnRvciByZWNvcmQKICAgICAgICBy
ZXN1bHQgPSBhd2FpdCBkYi5tZW50b3JzLmRlbGV0ZV9vbmUoeyJfaWQiOiBPYmplY3RJZChtZW50
b3JfZGJfaWQpfSkKICAgICAgICAKICAgICAgICBpZiByZXN1bHQuZGVsZXRlZF9jb3VudCA+IDA6
CiAgICAgICAgICAgICMgRGVsZXRlIGFsbCBsaWNlbnNlIGtleXMgYXNzb2NpYXRlZCB3aXRoIHRo
aXMgbWVudG9yCiAgICAgICAgICAgIGlmIG1lbnRvcl9pZDoKICAgICAgICAgICAgICAgIGRlbGV0
ZWRfbGljZW5zZXMgPSBhd2FpdCBkYi5saWNlbnNlcy5kZWxldGVfbWFueSh7Im1lbnRvcl9pZCI6
IG1lbnRvcl9pZH0pCiAgICAgICAgICAgICAgICBsb2dnZXIuaW5mbyhmIkRlbGV0ZWQge2RlbGV0
ZWRfbGljZW5zZXMuZGVsZXRlZF9jb3VudH0gbGljZW5zZSBrZXlzIGZvciBtZW50b3Ige21lbnRv
cl9pZH0iKQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAjIERlbGV0ZSBhbGwgbWVu
dG9yIGFjY2VzcyBrZXlzCiAgICAgICAgICAgICAgICBkZWxldGVkX2FjY2Vzc19rZXlzID0gYXdh
aXQgZGIubWVudG9yX2FjY2Vzc19rZXlzLmRlbGV0ZV9tYW55KHsibWVudG9yX2lkIjogbWVudG9y
X2lkfSkKICAgICAgICAgICAgICAgIGxvZ2dlci5pbmZvKGYiRGVsZXRlZCB7ZGVsZXRlZF9hY2Nl
c3Nfa2V5cy5kZWxldGVkX2NvdW50fSBhY2Nlc3Mga2V5cyBmb3IgbWVudG9yIHttZW50b3JfaWR9
IikKICAgICAgICAgICAgCiAgICAgICAgICAgICMgTG9nIHRoZSBkZWxldGlvbiBhY3Rpdml0eQog
ICAgICAgICAgICBhd2FpdCBkYi51c2VyX2FjdGl2aXR5Lmluc2VydF9vbmUoewogICAgICAgICAg
ICAgICAgInVzZXJfaWQiOiBzdHIoY3VycmVudF9hZG1pblsiX2lkIl0pLAogICAgICAgICAgICAg
ICAgImFjdGlvbiI6ICJtZW50b3JfZGVsZXRlZF9ieV9hZG1pbiIsCiAgICAgICAgICAgICAgICAi
ZGV0YWlscyI6IHsKICAgICAgICAgICAgICAgICAgICAibWVudG9yX2RiX2lkIjogbWVudG9yX2Ri
X2lkLAogICAgICAgICAgICAgICAgICAgICJtZW50b3JfaWQiOiBtZW50b3JfaWQsCiAgICAgICAg
ICAgICAgICAgICAgImVtYWlsIjogbWVudG9yX2VtYWlsLAogICAgICAgICAgICAgICAgICAgICJ1
c2VyX2NvdW50IjogdXNlcl9jb3VudCwKICAgICAgICAgICAgICAgICAgICAiYWRtaW5faWQiOiBz
dHIoY3VycmVudF9hZG1pblsiX2lkIl0pCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAg
ICAgInRpbWVzdGFtcCI6IGRhdGV0aW1lLnV0Y25vdygpCiAgICAgICAgICAgIH0pCiAgICAgICAg
ICAgIAogICAgICAgICAgICBsb2dnZXIuaW5mbyhmIuKchSBEZWxldGVkIG1lbnRvciB7bWVudG9y
X2lkfSAoZW1haWw6IHttZW50b3JfZW1haWx9KSB3aG8gaGFkIHt1c2VyX2NvdW50fSBhc3NvY2lh
dGVkIHVzZXJzIikKICAgICAgICAgICAgCiAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAg
ICAgICAibWVzc2FnZSI6ICJNZW50b3IgZGVsZXRlZCBzdWNjZXNzZnVsbHkiLAogICAgICAgICAg
ICAgICAgImRlbGV0ZWRfZW1haWwiOiBtZW50b3JfZW1haWwsCiAgICAgICAgICAgICAgICAibWVu
dG9yX2lkIjogbWVudG9yX2lkLAogICAgICAgICAgICAgICAgImFzc29jaWF0ZWRfdXNlcnMiOiB1
c2VyX2NvdW50CiAgICAgICAgICAgIH0KICAgICAgICBlbHNlOgogICAgICAgICAgICByYWlzZSBI
VFRQRXhjZXB0aW9uKHN0YXR1c19jb2RlPTQwNCwgZGV0YWlsPSJNZW50b3Igbm90IGZvdW5kIikK
ICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICBsb2dnZXIuZXJyb3IoZiJFcnJvciBk
ZWxldGluZyBtZW50b3I6IHtzdHIoZSl9IikKICAgICAgICByYWlzZSBIVFRQRXhjZXB0aW9uKHN0
YXR1c19jb2RlPTUwMCwgZGV0YWlsPWYiRmFpbGVkIHRvIGRlbGV0ZSBtZW50b3I6IHtzdHIoZSl9
IikKCkBhcGlfcm91dGVyLnBvc3QoIi9hZG1pbi9tZW50b3JzL3ttZW50b3JfZGJfaWR9L2RlYWN0
aXZhdGUiKQphc3luYyBkZWYgZGVhY3RpdmF0ZV9tZW50b3IobWVudG9yX2RiX2lkOiBzdHIsIGN1
cnJlbnRfYWRtaW4gPSBEZXBlbmRzKGdldF9jdXJyZW50X2FkbWluKSk6CiAgICAiIiJEZWFjdGl2
YXRlIGEgbWVudG9yIChhZG1pbiBvbmx5KSIiIgogICAgZnJvbSBic29uIGltcG9ydCBPYmplY3RJ
ZAogICAgCiAgICB0cnk6CiAgICAgICAgcmVzdWx0ID0gYXdhaXQgZGIubWVudG9ycy51cGRhdGVf
b25lKAogICAgICAgICAgICB7Il9pZCI6IE9iamVjdElkKG1lbnRvcl9kYl9pZCl9LAogICAgICAg
ICAgICB7IiRzZXQiOiB7InN0YXR1cyI6ICJpbmFjdGl2ZSIsICJ1cGRhdGVkX2F0IjogZGF0ZXRp
bWUudXRjbm93KCl9fQogICAgICAgICkKICAgICAgICAKICAgICAgICBpZiByZXN1bHQubW9kaWZp
ZWRfY291bnQgPiAwOgogICAgICAgICAgICByZXR1cm4geyJtZXNzYWdlIjogIk1lbnRvciBkZWFj
dGl2YXRlZCBzdWNjZXNzZnVsbHkifQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJhaXNlIEhU
VFBFeGNlcHRpb24oc3RhdHVzX2NvZGU9NDA0LCBkZXRhaWw9Ik1lbnRvciBub3QgZm91bmQiKQog
ICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIGxvZ2dlci5lcnJvcihmIkVycm9yIGRl
YWN0aXZhdGluZyBtZW50b3I6IHtzdHIoZSl9IikKICAgICAgICByYWlzZSBIVFRQRXhjZXB0aW9u
KHN0YXR1c19jb2RlPTUwMCwgZGV0YWlsPWYiRmFpbGVkIHRvIGRlYWN0aXZhdGUgbWVudG9yOiB7
c3RyKGUpfSIpCgpAYXBpX3JvdXRlci5wb3N0KCIvYWRtaW4vbWVudG9ycy97bWVudG9yX2RiX2lk
fS9hY3RpdmF0ZSIpCmFzeW5jIGRlZiBhY3RpdmF0ZV9tZW50b3IobWVudG9yX2RiX2lkOiBzdHIs
IGN1cnJlbnRfYWRtaW4gPSBEZXBlbmRzKGdldF9jdXJyZW50X2FkbWluKSk6CiAgICAiIiJBY3Rp
dmF0ZSBhIG1lbnRvciAoYWRtaW4gb25seSkiIiIKICAgIGZyb20gYnNvbiBpbXBvcnQgT2JqZWN0
SWQKICAgIAogICAgdHJ5OgogICAgICAgIHJlc3VsdCA9IGF3YWl0IGRiLm1lbnRvcnMudXBkYXRl
X29uZSgKICAgICAgICAgICAgeyJfaWQiOiBPYmplY3RJZChtZW50b3JfZGJfaWQpfSwKICAgICAg
ICAgICAgeyIkc2V0IjogeyJzdGF0dXMiOiAiYWN0aXZlIiwgInVwZGF0ZWRfYXQiOiBkYXRldGlt
ZS51dGNub3coKX19CiAgICAgICAgKQogICAgICAgIAogICAgICAgIGlmIHJlc3VsdC5tb2RpZmll
ZF9jb3VudCA+IDA6CiAgICAgICAgICAgIHJldHVybiB7Im1lc3NhZ2UiOiAiTWVudG9yIGFjdGl2
YXRlZCBzdWNjZXNzZnVsbHkifQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJhaXNlIEhUVFBF
eGNlcHRpb24oc3RhdHVzX2NvZGU9NDA0LCBkZXRhaWw9Ik1lbnRvciBub3QgZm91bmQiKQogICAg
ZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIGxvZ2dlci5lcnJvcihmIkVycm9yIGFjdGl2
YXRpbmcgbWVudG9yOiB7c3RyKGUpfSIpCiAgICAgICAgcmFpc2UgSFRUUEV4Y2VwdGlvbihzdGF0
dXNfY29kZT01MDAsIGRldGFpbD1mIkZhaWxlZCB0byBhY3RpdmF0ZSBtZW50b3I6IHtzdHIoZSl9
IikKCkBhcGlfcm91dGVyLnBvc3QoIi9hZG1pbi9tZW50b3JzL2NyZWF0ZSIpCmFzeW5jIGRlZiBj
cmVhdGVfbWVudG9yKGN1cnJlbnRfYWRtaW4gPSBEZXBlbmRzKGdldF9jdXJyZW50X2FkbWluKSk6
CiAgICAiIiJDcmVhdGUgYSBuZXcgbWVudG9yIElEIGZvciBhZG1pbiB0cmFja2luZyAoYWRtaW4g
b25seSkiIiIKICAgIHRyeToKICAgICAgICAjIEdldCB0aGUgY291bnQgb2YgZXhpc3RpbmcgbWVu
dG9yIHJlY29yZHMgdG8gZ2VuZXJhdGUgc2VxdWVudGlhbCBJRAogICAgICAgIGNvdW50ID0gYXdh
aXQgZGIubWVudG9yX2lkcy5jb3VudF9kb2N1bWVudHMoe30pCiAgICAgICAgCiAgICAgICAgIyBH
ZW5lcmF0ZSB1bmlxdWUgbWVudG9yIElECiAgICAgICAgbWF4X2F0dGVtcHRzID0gMTAwCiAgICAg
ICAgZm9yIGF0dGVtcHQgaW4gcmFuZ2UobWF4X2F0dGVtcHRzKToKICAgICAgICAgICAgbWVudG9y
X2lkID0gZiJNRU5UT1J7c3RyKGNvdW50ICsgMSArIGF0dGVtcHQpLnpmaWxsKDQpfSIgICMgZS5n
LiwgTUVOVE9SMDAwMSwgTUVOVE9SMDAwMgogICAgICAgICAgICAKICAgICAgICAgICAgIyBDaGVj
ayBpZiB0aGlzIElEIGFscmVhZHkgZXhpc3RzIGluIGJvdGggY29sbGVjdGlvbnMKICAgICAgICAg
ICAgZXhpc3RpbmdfbWVudG9yX2lkID0gYXdhaXQgZGIubWVudG9yX2lkcy5maW5kX29uZSh7Im1l
bnRvcl9pZCI6IG1lbnRvcl9pZH0pCiAgICAgICAgICAgIGV4aXN0aW5nX21lbnRvciA9IGF3YWl0
IGRiLm1lbnRvcnMuZmluZF9vbmUoeyJtZW50b3JfaWQiOiBtZW50b3JfaWR9KQogICAgICAgICAg
ICAKICAgICAgICAgICAgaWYgbm90IGV4aXN0aW5nX21lbnRvcl9pZCBhbmQgbm90IGV4aXN0aW5n
X21lbnRvcjoKICAgICAgICAgICAgICAgICMgRm91bmQgYSB1bmlxdWUgSUQsIGNyZWF0ZSBpdAog
ICAgICAgICAgICAgICAgbWVudG9yX2RvYyA9IHsKICAgICAgICAgICAgICAgICAgICAibWVudG9y
X2lkIjogbWVudG9yX2lkLAogICAgICAgICAgICAgICAgICAgICJjcmVhdGVkX2F0IjogZGF0ZXRp
bWUudXRjbm93KCksCiAgICAgICAgICAgICAgICAgICAgImNyZWF0ZWRfYnkiOiBzdHIoY3VycmVu
dF9hZG1pblsiX2lkIl0pLAogICAgICAgICAgICAgICAgICAgICJhY3RpdmUiOiBUcnVlLAogICAg
ICAgICAgICAgICAgICAgICJjb3BpZWQiOiBGYWxzZSwKICAgICAgICAgICAgICAgICAgICAiY29w
aWVkX2F0IjogTm9uZSwKICAgICAgICAgICAgICAgICAgICAidG90YWxfcmVmZXJyYWxzIjogMCwK
ICAgICAgICAgICAgICAgICAgICAic3RhdHVzIjogInBlbmRpbmciICAjIFBlbmRpbmcgdW50aWwg
YWN0dWFsIG1lbnRvciBzaWducyB1cAogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAg
YXdhaXQgZGIubWVudG9yX2lkcy5pbnNlcnRfb25lKG1lbnRvcl9kb2MpCiAgICAgICAgICAgICAg
ICByZXR1cm4geyJtZXNzYWdlIjogIk1lbnRvciBJRCBjcmVhdGVkIHN1Y2Nlc3NmdWxseSIsICJt
ZW50b3JfaWQiOiBtZW50b3JfaWR9CiAgICAgICAgCiAgICAgICAgIyBJZiB3ZSBjb3VsZG4ndCBn
ZW5lcmF0ZSBhIHVuaXF1ZSBJRCBhZnRlciAxMDAgYXR0ZW1wdHMKICAgICAgICByYWlzZSBIVFRQ
RXhjZXB0aW9uKHN0YXR1c19jb2RlPTUwMCwgZGV0YWlsPSJGYWlsZWQgdG8gZ2VuZXJhdGUgdW5p
cXVlIG1lbnRvciBJRCIpCiAgICAKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICBw
cmludChmIkVycm9yIGNyZWF0aW5nIG1lbnRvciBJRDoge2V9IikKICAgICAgICByYWlzZSBIVFRQ
RXhjZXB0aW9uKHN0YXR1c19jb2RlPTUwMCwgZGV0YWlsPWYiRmFpbGVkIHRvIGdlbmVyYXRlIG1l
bnRvciBJRDoge3N0cihlKX0iKQoKQGFwaV9yb3V0ZXIucG9zdCgiL2FkbWluL21lbnRvcnMve21l
bnRvcl9pZH0vbWFyay1jb3BpZWQiKQphc3luYyBkZWYgbWFya19tZW50b3JfY29waWVkKG1lbnRv
cl9pZDogc3RyLCBjdXJyZW50X2FkbWluID0gRGVwZW5kcyhnZXRfY3VycmVudF9hZG1pbikpOgog
ICAgIiIiTWFyayBhIG1lbnRvciBJRCBhcyBjb3BpZWQgKGFkbWluIG9ubHkpIiIiCiAgICByZXN1
bHQgPSBhd2FpdCBkYi5tZW50b3JzLnVwZGF0ZV9vbmUoCiAgICAgICAgeyJtZW50b3JfaWQiOiBt
ZW50b3JfaWR9LAogICAgICAgIHsKICAgICAgICAgICAgIiRzZXQiOiB7CiAgICAgICAgICAgICAg
ICAiY29waWVkIjogVHJ1ZSwKICAgICAgICAgICAgICAgICJjb3BpZWRfYXQiOiBkYXRldGltZS51
dGNub3coKSwKICAgICAgICAgICAgICAgICJsYXN0X2NvcGllZF9ieSI6IHN0cihjdXJyZW50X2Fk
bWluWyJfaWQiXSkKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICkKICAgIAogICAgaWYgcmVz
dWx0Lm1vZGlmaWVkX2NvdW50ID09IDA6CiAgICAgICAgcmFpc2UgSFRUUEV4Y2VwdGlvbihzdGF0
dXNfY29kZT00MDQsIGRldGFpbD0iTWVudG9yIElEIG5vdCBmb3VuZCIpCiAgICAKICAgIHJldHVy
biB7Im1lc3NhZ2UiOiAiTWVudG9yIElEIG1hcmtlZCBhcyBjb3BpZWQiLCAibWVudG9yX2lkIjog
bWVudG9yX2lkfQoKQGFwaV9yb3V0ZXIucHV0KCIvYWRtaW4vbWVudG9ycy97bWVudG9yX2lkfS9z
eXN0ZW0tbmFtZSIpCmFzeW5jIGRlZiB1cGRhdGVfbWVudG9yX3N5c3RlbV9uYW1lKAogICAgbWVu
dG9yX2lkOiBzdHIsIAogICAgc3lzdGVtX25hbWU6IHN0ciA9IEJvZHkoLi4uLCBlbWJlZD1UcnVl
KSwKICAgIGN1cnJlbnRfYWRtaW4gPSBEZXBlbmRzKGdldF9jdXJyZW50X2FkbWluKQopOgogICAg
IiIiVXBkYXRlIHN5c3RlbSBuYW1lIGZvciBhIG1lbnRvciAoYWRtaW4gb25seSkiIiIKICAgICMg
VmFsaWRhdGUgc3lzdGVtIG5hbWUKICAgIGlmIG5vdCBzeXN0ZW1fbmFtZSBvciBsZW4oc3lzdGVt
X25hbWUuc3RyaXAoKSkgPT0gMDoKICAgICAgICByYWlzZSBIVFRQRXhjZXB0aW9uKHN0YXR1c19j
b2RlPTQwMCwgZGV0YWlsPSJTeXN0ZW0gbmFtZSBjYW5ub3QgYmUgZW1wdHkiKQogICAgCiAgICBp
ZiBsZW4oc3lzdGVtX25hbWUpID4gNTA6CiAgICAgICAgcmFpc2UgSFRUUEV4Y2VwdGlvbihzdGF0
dXNfY29kZT00MDAsIGRldGFpbD0iU3lzdGVtIG5hbWUgbXVzdCBiZSA1MCBjaGFyYWN0ZXJzIG9y
IGxlc3MiKQogICAgCiAgICAjIFVwZGF0ZSBtZW50b3Igc3lzdGVtIG5hbWUKICAgIHJlc3VsdCA9
IGF3YWl0IGRiLm1lbnRvcnMudXBkYXRlX29uZSgKICAgICAgICB7Im1lbnRvcl9pZCI6IG1lbnRv
cl9pZH0sCiAgICAgICAgewogICAgICAgICAgICAiJHNldCI6IHsKICAgICAgICAgICAgICAgICJz
eXN0ZW1fbmFtZSI6IHN5c3RlbV9uYW1lLnN0cmlwKCksCiAgICAgICAgICAgICAgICAic3lzdGVt
X25hbWVfdXBkYXRlZF9hdCI6IGRhdGV0aW1lLnV0Y25vdygpCiAgICAgICAgICAgIH0KICAgICAg
ICB9CiAgICApCiAgICAKICAgIGlmIHJlc3VsdC5tb2RpZmllZF9jb3VudCA+IDA6CiAgICAgICAg
cmV0dXJuIHsibWVzc2FnZSI6ICJTeXN0ZW0gbmFtZSB1cGRhdGVkIHN1Y2Nlc3NmdWxseSIsICJz
eXN0ZW1fbmFtZSI6IHN5c3RlbV9uYW1lLnN0cmlwKCl9CiAgICBlbHNlOgogICAgICAgIHJhaXNl
IEhUVFBFeGNlcHRpb24oc3RhdHVzX2NvZGU9NDA0LCBkZXRhaWw9Ik1lbnRvciBub3QgZm91bmQi
KQoKQGFwaV9yb3V0ZXIucHV0KCIvYWRtaW4vbWVudG9ycy97bWVudG9yX2lkfS9iYWNrZ3JvdW5k
LWNvbG9yIikKYXN5bmMgZGVmIHVwZGF0ZV9tZW50b3JfYmFja2dyb3VuZF9jb2xvcigKICAgIG1l
bnRvcl9pZDogc3RyLCAKICAgIGJhY2tncm91bmRfY29sb3I6IHN0ciA9IEJvZHkoLi4uLCBlbWJl
ZD1UcnVlKSwKICAgIGN1cnJlbnRfYWRtaW4gPSBEZXBlbmRzKGdldF9jdXJyZW50X2FkbWluKQop
OgogICAgIiIiVXBkYXRlIGJhY2tncm91bmQgY29sb3IgZm9yIGEgbWVudG9yIChhZG1pbiBvbmx5
KSIiIgogICAgIyBWYWxpZGF0ZSBoZXggY29sb3IgZm9ybWF0CiAgICBpbXBvcnQgcmUKICAgIGlm
IG5vdCByZS5tYXRjaChyJ14jWzAtOUEtRmEtZl17Nn0kJywgYmFja2dyb3VuZF9jb2xvcik6CiAg
ICAgICAgcmFpc2UgSFRUUEV4Y2VwdGlvbihzdGF0dXNfY29kZT00MDAsIGRldGFpbD0iSW52YWxp
ZCBjb2xvciBmb3JtYXQuIFVzZSBoZXggZm9ybWF0IGxpa2UgIzBhMGEwYSIpCiAgICAKICAgICMg
VXBkYXRlIG1lbnRvciBiYWNrZ3JvdW5kIGNvbG9yCiAgICByZXN1bHQgPSBhd2FpdCBkYi5tZW50
b3JzLnVwZGF0ZV9vbmUoCiAgICAgICAgeyJtZW50b3JfaWQiOiBtZW50b3JfaWR9LAogICAgICAg
IHsKICAgICAgICAgICAgIiRzZXQiOiB7CiAgICAgICAgICAgICAgICAiYmFja2dyb3VuZF9jb2xv
ciI6IGJhY2tncm91bmRfY29sb3IsCiAgICAgICAgICAgICAgICAiYmFja2dyb3VuZF9jb2xvcl91
cGRhdGVkX2F0IjogZGF0ZXRpbWUudXRjbm93KCkKICAgICAgICAgICAgfQogICAgICAgIH0KICAg
ICkKICAgIAogICAgaWYgcmVzdWx0Lm1vZGlmaWVkX2NvdW50ID4gMDoKICAgICAgICByZXR1cm4g
eyJtZXNzYWdlIjogIkJhY2tncm91bmQgY29sb3IgdXBkYXRlZCBzdWNjZXNzZnVsbHkiLCAiYmFj
a2dyb3VuZF9jb2xvciI6IGJhY2tncm91bmRfY29sb3J9CiAgICBlbHNlOgogICAgICAgIHJhaXNl
IEhUVFBFeGNlcHRpb24oc3RhdHVzX2NvZGU9NDA0LCBkZXRhaWw9Ik1lbnRvciBub3QgZm91bmQi
KQoKQGFwaV9yb3V0ZXIucHV0KCIvYWRtaW4vbWVudG9ycy97bWVudG9yX2lkfS9iYWNrZ3JvdW5k
LWltYWdlIikKYXN5bmMgZGVmIHVwZGF0ZV9tZW50b3JfYmFja2dyb3VuZF9pbWFnZSgKICAgIG1l
bnRvcl9pZDogc3RyLCAKICAgIGJhY2tncm91bmRfaW1hZ2U6IHN0ciA9IEJvZHkoLi4uLCBlbWJl
ZD1UcnVlKSwKICAgIGN1cnJlbnRfYWRtaW4gPSBEZXBlbmRzKGdldF9jdXJyZW50X2FkbWluKQop
OgogICAgIiIiVXBkYXRlIGJhY2tncm91bmQgaW1hZ2UgVVJMIGZvciBhIG1lbnRvciAoYWRtaW4g
b25seSkiIiIKICAgICMgVmFsaWRhdGUgVVJMIGZvcm1hdCAob3B0aW9uYWwgLSBjYW4gYmUgZW1w
dHkgdG8gcmVtb3ZlIGltYWdlKQogICAgaWYgYmFja2dyb3VuZF9pbWFnZSBhbmQgYmFja2dyb3Vu
ZF9pbWFnZS5zdHJpcCgpOgogICAgICAgIGltcG9ydCByZQogICAgICAgIHVybF9wYXR0ZXJuID0g
cmUuY29tcGlsZSgKICAgICAgICAgICAgcideaHR0cHM/Oi8vJyAgIyBodHRwOi8vIG9yIGh0dHBz
Oi8vCiAgICAgICAgICAgIHInKD86KD86W0EtWjAtOV0oPzpbQS1aMC05LV17MCw2MX1bQS1aMC05
XSk/XC4pK1tBLVpdezIsNn1cLj98JyAgIyBkb21haW4uLi4KICAgICAgICAgICAgcidsb2NhbGhv
c3R8JyAgIyBsb2NhbGhvc3QuLi4KICAgICAgICAgICAgcidcZHsxLDN9XC5cZHsxLDN9XC5cZHsx
LDN9XC5cZHsxLDN9KScgICMgLi4ub3IgaXAKICAgICAgICAgICAgcicoPzo6XGQrKT8nICAjIG9w
dGlvbmFsIHBvcnQKICAgICAgICAgICAgcicoPzovP3xbLz9dXFMrKSQnLCByZS5JR05PUkVDQVNF
KQogICAgICAgIAogICAgICAgIGlmIG5vdCB1cmxfcGF0dGVybi5tYXRjaChiYWNrZ3JvdW5kX2lt
YWdlLnN0cmlwKCkpOgogICAgICAgICAgICByYWlzZSBIVFRQRXhjZXB0aW9uKHN0YXR1c19jb2Rl
PTQwMCwgZGV0YWlsPSJJbnZhbGlkIFVSTCBmb3JtYXQuIFVzZSBhIHZhbGlkIEhUVFAvSFRUUFMg
VVJMIikKICAgIAogICAgIyBVcGRhdGUgbWVudG9yIGJhY2tncm91bmQgaW1hZ2UgKGVtcHR5IHN0
cmluZyByZW1vdmVzIGl0KQogICAgcmVzdWx0ID0gYXdhaXQgZGIubWVudG9ycy51cGRhdGVfb25l
KAogICAgICAgIHsibWVudG9yX2lkIjogbWVudG9yX2lkfSwKICAgICAgICB7CiAgICAgICAgICAg
ICIkc2V0IjogewogICAgICAgICAgICAgICAgImJhY2tncm91bmRfaW1hZ2UiOiBiYWNrZ3JvdW5k
X2ltYWdlLnN0cmlwKCkgaWYgYmFja2dyb3VuZF9pbWFnZSBlbHNlIE5vbmUsCiAgICAgICAgICAg
ICAgICAiYmFja2dyb3VuZF9pbWFnZV91cGRhdGVkX2F0IjogZGF0ZXRpbWUudXRjbm93KCkKICAg
ICAgICAgICAgfQogICAgICAgIH0KICAgICkKICAgIAogICAgaWYgcmVzdWx0Lm1vZGlmaWVkX2Nv
dW50ID4gMDoKICAgICAgICByZXR1cm4geyJtZXNzYWdlIjogIkJhY2tncm91bmQgaW1hZ2UgdXBk
YXRlZCBzdWNjZXNzZnVsbHkiLCAiYmFja2dyb3VuZF9pbWFnZSI6IGJhY2tncm91bmRfaW1hZ2Uu
c3RyaXAoKSBpZiBiYWNrZ3JvdW5kX2ltYWdlIGVsc2UgTm9uZX0KICAgIGVsc2U6CiAgICAgICAg
cmFpc2UgSFRUUEV4Y2VwdGlvbihzdGF0dXNfY29kZT00MDQsIGRldGFpbD0iTWVudG9yIG5vdCBm
b3VuZCIpCgpAYXBpX3JvdXRlci5wdXQoIi9hZG1pbi9tZW50b3JzL3ttZW50b3JfaWR9L2JhY2tn
cm91bmQiKQphc3luYyBkZWYgdXBkYXRlX21lbnRvcl9iYWNrZ3JvdW5kKAogICAgbWVudG9yX2lk
OiBzdHIsIAogICAgYmFja2dyb3VuZF9pbWFnZTogT3B0aW9uYWxbc3RyXSA9IEJvZHkoTm9uZSks
CiAgICBiYWNrZ3JvdW5kX2NvbG9yOiBPcHRpb25hbFtzdHJdID0gQm9keShOb25lKSwKICAgIGN1
cnJlbnRfYWRtaW4gPSBEZXBlbmRzKGdldF9jdXJyZW50X2FkbWluKQopOgogICAgIiIiVXBkYXRl
IGJhY2tncm91bmQgaW1hZ2UgYW5kL29yIGNvbG9yIGZvciBhIG1lbnRvciAoYWRtaW4gb25seSki
IiIKICAgIHVwZGF0ZV9maWVsZHMgPSB7fQogICAgCiAgICAjIEhhbmRsZSBiYWNrZ3JvdW5kIGlt
YWdlIChjYW4gYmUgYmFzZTY0IG9yIFVSTCkKICAgIGlmIGJhY2tncm91bmRfaW1hZ2UgaXMgbm90
IE5vbmU6CiAgICAgICAgIyBBbGxvdyBiYXNlNjQgaW1hZ2VzIG9yIFVSTHMgb3IgTm9uZSB0byBj
bGVhcgogICAgICAgIGlmIGJhY2tncm91bmRfaW1hZ2UgYW5kIGJhY2tncm91bmRfaW1hZ2Uuc3Ry
aXAoKToKICAgICAgICAgICAgIyBDaGVjayBpZiBpdCdzIGEgYmFzZTY0IGltYWdlCiAgICAgICAg
ICAgIGlmIGJhY2tncm91bmRfaW1hZ2Uuc3RhcnRzd2l0aCgnZGF0YTppbWFnZScpOgogICAgICAg
ICAgICAgICAgdXBkYXRlX2ZpZWxkc1siYmFja2dyb3VuZF9pbWFnZSJdID0gYmFja2dyb3VuZF9p
bWFnZQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgIyBWYWxpZGF0ZSBhcyBVUkwK
ICAgICAgICAgICAgICAgIGltcG9ydCByZQogICAgICAgICAgICAgICAgdXJsX3BhdHRlcm4gPSBy
ZS5jb21waWxlKAogICAgICAgICAgICAgICAgICAgIHInXmh0dHBzPzovLycgICMgaHR0cDovLyBv
ciBodHRwczovLwogICAgICAgICAgICAgICAgICAgIHInKD86KD86W0EtWjAtOV0oPzpbQS1aMC05
LV17MCw2MX1bQS1aMC05XSk/XC4pK1tBLVpdezIsNn1cLj98JyAgIyBkb21haW4uLi4KICAgICAg
ICAgICAgICAgICAgICByJ2xvY2FsaG9zdHwnICAjIGxvY2FsaG9zdC4uLgogICAgICAgICAgICAg
ICAgICAgIHInXGR7MSwzfVwuXGR7MSwzfVwuXGR7MSwzfVwuXGR7MSwzfSknICAjIC4uLm9yIGlw
CiAgICAgICAgICAgICAgICAgICAgcicoPzo6XGQrKT8nICAjIG9wdGlvbmFsIHBvcnQKICAgICAg
ICAgICAgICAgICAgICByJyg/Oi8/fFsvP11cUyspJCcsIHJlLklHTk9SRUNBU0UpCiAgICAgICAg
ICAgICAgICAKICAgICAgICAgICAgICAgIGlmIG5vdCB1cmxfcGF0dGVybi5tYXRjaChiYWNrZ3Jv
dW5kX2ltYWdlLnN0cmlwKCkpOgogICAgICAgICAgICAgICAgICAgIHJhaXNlIEhUVFBFeGNlcHRp
b24oc3RhdHVzX2NvZGU9NDAwLCBkZXRhaWw9IkludmFsaWQgVVJMIGZvcm1hdCBvciBiYXNlNjQg
ZGF0YSIpCiAgICAgICAgICAgICAgICB1cGRhdGVfZmllbGRzWyJiYWNrZ3JvdW5kX2ltYWdlIl0g
PSBiYWNrZ3JvdW5kX2ltYWdlLnN0cmlwKCkKICAgICAgICBlbHNlOgogICAgICAgICAgICB1cGRh
dGVfZmllbGRzWyJiYWNrZ3JvdW5kX2ltYWdlIl0gPSBOb25lCiAgICAgICAgdXBkYXRlX2ZpZWxk
c1siYmFja2dyb3VuZF9pbWFnZV91cGRhdGVkX2F0Il0gPSBkYXRldGltZS51dGNub3coKQogICAg
CiAgICAjIEhhbmRsZSBiYWNrZ3JvdW5kIGNvbG9yIChSR0IgZm9ybWF0KQogICAgaWYgYmFja2dy
b3VuZF9jb2xvciBpcyBub3QgTm9uZToKICAgICAgICAjIEFsbG93IHJnYigpIGZvcm1hdCBvciBO
b25lIHRvIGNsZWFyCiAgICAgICAgaWYgYmFja2dyb3VuZF9jb2xvciBhbmQgYmFja2dyb3VuZF9j
b2xvci5zdHJpcCgpOgogICAgICAgICAgICBpbXBvcnQgcmUKICAgICAgICAgICAgIyBWYWxpZGF0
ZSByZ2IgZm9ybWF0OiByZ2IociwgZywgYikKICAgICAgICAgICAgcmdiX3BhdHRlcm4gPSByZS5j
b21waWxlKHInXnJnYlwoXHMqKFxkezEsM30pXHMqLFxzKihcZHsxLDN9KVxzKixccyooXGR7MSwz
fSlccypcKSQnKQogICAgICAgICAgICBtYXRjaCA9IHJnYl9wYXR0ZXJuLm1hdGNoKGJhY2tncm91
bmRfY29sb3Iuc3RyaXAoKSkKICAgICAgICAgICAgaWYgbm90IG1hdGNoOgogICAgICAgICAgICAg
ICAgcmFpc2UgSFRUUEV4Y2VwdGlvbihzdGF0dXNfY29kZT00MDAsIGRldGFpbD0iSW52YWxpZCBj
b2xvciBmb3JtYXQuIFVzZSByZ2IociwgZywgYikgZm9ybWF0IikKICAgICAgICAgICAgCiAgICAg
ICAgICAgICMgVmFsaWRhdGUgUkdCIHZhbHVlcyBhcmUgaW4gcmFuZ2UgMC0yNTUKICAgICAgICAg
ICAgciwgZywgYiA9IGludChtYXRjaC5ncm91cCgxKSksIGludChtYXRjaC5ncm91cCgyKSksIGlu
dChtYXRjaC5ncm91cCgzKSkKICAgICAgICAgICAgaWYgbm90ICgwIDw9IHIgPD0gMjU1IGFuZCAw
IDw9IGcgPD0gMjU1IGFuZCAwIDw9IGIgPD0gMjU1KToKICAgICAgICAgICAgICAgIHJhaXNlIEhU
VFBFeGNlcHRpb24oc3RhdHVzX2NvZGU9NDAwLCBkZXRhaWw9IlJHQiB2YWx1ZXMgbXVzdCBiZSBi
ZXR3ZWVuIDAgYW5kIDI1NSIpCiAgICAgICAgICAgIAogICAgICAgICAgICB1cGRhdGVfZmllbGRz
WyJiYWNrZ3JvdW5kX2NvbG9yIl0gPSBiYWNrZ3JvdW5kX2NvbG9yLnN0cmlwKCkKICAgICAgICBl
bHNlOgogICAgICAgICAgICB1cGRhdGVfZmllbGRzWyJiYWNrZ3JvdW5kX2NvbG9yIl0gPSBOb25l
CiAgICAgICAgdXBkYXRlX2ZpZWxkc1siYmFja2dyb3VuZF9jb2xvcl91cGRhdGVkX2F0Il0gPSBk
YXRldGltZS51dGNub3coKQogICAgCiAgICBpZiBub3QgdXBkYXRlX2ZpZWxkczoKICAgICAgICBy
YWlzZSBIVFRQRXhjZXB0aW9uKHN0YXR1c19jb2RlPTQwMCwgZGV0YWlsPSJObyBiYWNrZ3JvdW5k
IHNldHRpbmdzIHByb3ZpZGVkIikKICAgIAogICAgIyBVcGRhdGUgbWVudG9yIGJhY2tncm91bmQg
c2V0dGluZ3MKICAgIHJlc3VsdCA9IGF3YWl0IGRiLm1lbnRvcnMudXBkYXRlX29uZSgKICAgICAg
ICB7Im1lbnRvcl9pZCI6IG1lbnRvcl9pZH0sCiAgICAgICAgeyIkc2V0IjogdXBkYXRlX2ZpZWxk
c30KICAgICkKICAgIAogICAgaWYgcmVzdWx0Lm1hdGNoZWRfY291bnQgPiAwOgogICAgICAgIHJl
dHVybiB7CiAgICAgICAgICAgICJtZXNzYWdlIjogIkJhY2tncm91bmQgc2V0dGluZ3MgdXBkYXRl
ZCBzdWNjZXNzZnVsbHkiLAogICAgICAgICAgICAiYmFja2dyb3VuZF9pbWFnZSI6IHVwZGF0ZV9m
aWVsZHMuZ2V0KCJiYWNrZ3JvdW5kX2ltYWdlIiksCiAgICAgICAgICAgICJiYWNrZ3JvdW5kX2Nv
bG9yIjogdXBkYXRlX2ZpZWxkcy5nZXQoImJhY2tncm91bmRfY29sb3IiKQogICAgICAgIH0KICAg
IGVsc2U6CiAgICAgICAgcmFpc2UgSFRUUEV4Y2VwdGlvbihzdGF0dXNfY29kZT00MDQsIGRldGFp
bD0iTWVudG9yIG5vdCBmb3VuZCIpCgoKQGFwaV9yb3V0ZXIuZ2V0KCIvYWRtaW4vdXNlcnMvcGVu
ZGluZyIpCmFzeW5jIGRlZiBnZXRfcGVuZGluZ191c2VycyhjdXJyZW50X2FkbWluID0gRGVwZW5k
cyhnZXRfY3VycmVudF9hZG1pbikpOgogICAgIiIiR2V0IGFsbCBwZW5kaW5nIHVzZXJzIGF3YWl0
aW5nIGFwcHJvdmFsIChhZG1pbiBvbmx5KSIiIgogICAgcGVuZGluZ191c2VycyA9IGF3YWl0IGRi
LnVzZXJzLmZpbmQoeyJzdGF0dXMiOiAicGVuZGluZyJ9KS5zb3J0KCJjcmVhdGVkX2F0IiwgLTEp
LnRvX2xpc3QoMTAwMCkKICAgIHJldHVybiBbc2VyaWFsaXplX2RvYyh1c2VyKSBmb3IgdXNlciBp
biBwZW5kaW5nX3VzZXJzXQoKQGFwaV9yb3V0ZXIucG9zdCgiL2FkbWluL3VzZXJzL3t1c2VyX2lk
fS9hcHByb3ZlIikKYXN5bmMgZGVmIGFwcHJvdmVfdXNlcih1c2VyX2lkOiBzdHIsIGN1cnJlbnRf
YWRtaW4gPSBEZXBlbmRzKGdldF9jdXJyZW50X2FkbWluKSk6CiAgICAiIiJBcHByb3ZlIGEgcGVu
ZGluZyB1c2VyIChhZG1pbiBvbmx5KSIiIgogICAgdHJ5OgogICAgICAgIHJlc3VsdCA9IGF3YWl0
IGRiLnVzZXJzLnVwZGF0ZV9vbmUoCiAgICAgICAgICAgIHsiX2lkIjogT2JqZWN0SWQodXNlcl9p
ZCksICJzdGF0dXMiOiAicGVuZGluZyJ9LAogICAgICAgICAgICB7IiRzZXQiOiB7InN0YXR1cyI6
ICJhY3RpdmUiLCAiYXBwcm92ZWRfYXQiOiBkYXRldGltZS51dGNub3coKSwgImFwcHJvdmVkX2J5
Ijogc3RyKGN1cnJlbnRfYWRtaW5bIl9pZCJdKX19CiAgICAgICAgKQogICAgICAgIGlmIHJlc3Vs
dC5tb2RpZmllZF9jb3VudCA9PSAwOgogICAgICAgICAgICByYWlzZSBIVFRQRXhjZXB0aW9uKHN0
YXR1c19jb2RlPTQwNCwgZGV0YWlsPSJVc2VyIG5vdCBmb3VuZCBvciBhbHJlYWR5IGFwcHJvdmVk
IikKICAgICAgICAKICAgICAgICAjIExvZyBhY3Rpdml0eQogICAgICAgIGF3YWl0IGRiLnVzZXJf
YWN0aXZpdHkuaW5zZXJ0X29uZSh7CiAgICAgICAgICAgICJ1c2VyX2lkIjogc3RyKGN1cnJlbnRf
YWRtaW5bIl9pZCJdKSwKICAgICAgICAgICAgImFjdGlvbiI6ICJ1c2VyX2FwcHJvdmVkIiwKICAg
ICAgICAgICAgImRldGFpbHMiOiB7ImFwcHJvdmVkX3VzZXJfaWQiOiB1c2VyX2lkfSwKICAgICAg
ICAgICAgInRpbWVzdGFtcCI6IGRhdGV0aW1lLnV0Y25vdygpCiAgICAgICAgfSkKICAgICAgICAK
ICAgICAgICByZXR1cm4geyJtZXNzYWdlIjogIlVzZXIgYXBwcm92ZWQgc3VjY2Vzc2Z1bGx5In0K
ICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICByYWlzZSBIVFRQRXhjZXB0aW9uKHN0
YXR1c19jb2RlPTQwMCwgZGV0YWlsPXN0cihlKSkKCkBhcGlfcm91dGVyLnBvc3QoIi9hZG1pbi91
c2Vycy97dXNlcl9pZH0vZGVjbGluZSIpCmFzeW5jIGRlZiBkZWNsaW5lX3VzZXIodXNlcl9pZDog
c3RyLCBjdXJyZW50X2FkbWluID0gRGVwZW5kcyhnZXRfY3VycmVudF9hZG1pbikpOgogICAgIiIi
RGVjbGluZSBhIHBlbmRpbmcgdXNlciBhbmQgZGVsZXRlIHRoZWlyIGFjY291bnQgKGFkbWluIG9u
bHkpIiIiCiAgICB0cnk6CiAgICAgICAgdXNlciA9IGF3YWl0IGRiLnVzZXJzLmZpbmRfb25lKHsi
X2lkIjogT2JqZWN0SWQodXNlcl9pZCl9KQogICAgICAgIGlmIG5vdCB1c2VyOgogICAgICAgICAg
ICByYWlzZSBIVFRQRXhjZXB0aW9uKHN0YXR1c19jb2RlPTQwNCwgZGV0YWlsPSJVc2VyIG5vdCBm
b3VuZCIpCiAgICAgICAgCiAgICAgICAgIyBSZWxlYXNlIHRoZSBsaWNlbnNlIGtleQogICAgICAg
IGlmIHVzZXIuZ2V0KCJsaWNlbnNlX2tleSIpOgogICAgICAgICAgICBhd2FpdCBkYi5saWNlbnNl
cy51cGRhdGVfb25lKAogICAgICAgICAgICAgICAgeyJrZXkiOiB1c2VyWyJsaWNlbnNlX2tleSJd
fSwKICAgICAgICAgICAgICAgIHsiJHNldCI6IHsidXNlZCI6IEZhbHNlLCAidXNlZF9ieSI6IE5v
bmUsICJ1c2VkX2F0IjogTm9uZX19CiAgICAgICAgICAgICkKICAgICAgICAKICAgICAgICAjIERl
bGV0ZSB1c2VyCiAgICAgICAgYXdhaXQgZGIudXNlcnMuZGVsZXRlX29uZSh7Il9pZCI6IE9iamVj
dElkKHVzZXJfaWQpfSkKICAgICAgICAKICAgICAgICAjIExvZyBhY3Rpdml0eQogICAgICAgIGF3
YWl0IGRiLnVzZXJfYWN0aXZpdHkuaW5zZXJ0X29uZSh7CiAgICAgICAgICAgICJ1c2VyX2lkIjog
c3RyKGN1cnJlbnRfYWRtaW5bIl9pZCJdKSwKICAgICAgICAgICAgImFjdGlvbiI6ICJ1c2VyX2Rl
Y2xpbmVkIiwKICAgICAgICAgICAgImRldGFpbHMiOiB7ImRlY2xpbmVkX3VzZXJfaWQiOiB1c2Vy
X2lkLCAiZW1haWwiOiB1c2VyLmdldCgiZW1haWwiKX0sCiAgICAgICAgICAgICJ0aW1lc3RhbXAi
OiBkYXRldGltZS51dGNub3coKQogICAgICAgIH0pCiAgICAgICAgCiAgICAgICAgcmV0dXJuIHsi
bWVzc2FnZSI6ICJVc2VyIGRlY2xpbmVkIGFuZCByZW1vdmVkIHN1Y2Nlc3NmdWxseSJ9CiAgICBl
eGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgcmFpc2UgSFRUUEV4Y2VwdGlvbihzdGF0dXNf
Y29kZT00MDAsIGRldGFpbD1zdHIoZSkpCgojID09PT09PT09PT09PT09PT09PT09IEVBIFJPVVRF
UyAoTk9XIFBST1RFQ1RFRCkgPT09PT09PT09PT09PT09PT09PT0KQGFwaV9yb3V0ZXIucG9zdCgi
L2VhIiwgcmVzcG9uc2VfbW9kZWw9ZGljdCkKYXN5bmMgZGVmIGNyZWF0ZV9lYShlYV9pbnB1dDog
RUFDcmVhdGUsIGN1cnJlbnRfdXNlciA9IERlcGVuZHMoZ2V0X2N1cnJlbnRfdXNlcikpOgogICAg
IiIiQ3JlYXRlIGEgbmV3IEVBIChyZXF1aXJlcyBhdXRoZW50aWNhdGlvbikiIiIKICAgIHVzZXJf
aWRfc3RyID0gc3RyKGN1cnJlbnRfdXNlclsiX2lkIl0pCiAgICBlYV9kaWN0ID0gewogICAgICAg
ICJ1c2VyX2lkIjogdXNlcl9pZF9zdHIsICAjIFN0b3JlIGFzIHN0cmluZyBmb3IgY29uc2lzdGVu
Y3kKICAgICAgICAibmFtZSI6IGVhX2lucHV0Lm5hbWUsCiAgICAgICAgInN0YXR1cyI6ICJzdG9w
cGVkIiwKICAgICAgICAiY29uZmlnIjogZWFfaW5wdXQuY29uZmlnLmRpY3QoKSwKICAgICAgICAi
Y3VycmVudF9zaWduYWwiOiAiTkVVVFJBTCIsCiAgICAgICAgImxhc3RfcHJpY2UiOiAwLjAsCiAg
ICAgICAgInByZXZpb3VzX3NpZ25hbCI6ICJORVVUUkFMIiwgICMgVHJhY2sgcHJldmlvdXMgc2ln
bmFsIGZvciBub3RpZmljYXRpb25zCiAgICAgICAgIm5vdGlmaWNhdGlvbnNfZW5hYmxlZCI6IFRy
dWUsCiAgICAgICAgImNyZWF0ZWRfYXQiOiBkYXRldGltZS51dGNub3coKSwKICAgICAgICAidXBk
YXRlZF9hdCI6IGRhdGV0aW1lLnV0Y25vdygpCiAgICB9CiAgICAKICAgIHJlc3VsdCA9IGF3YWl0
IGRiLmVhcy5pbnNlcnRfb25lKGVhX2RpY3QpCiAgICBlYV9kaWN0WydfaWQnXSA9IHN0cihyZXN1
bHQuaW5zZXJ0ZWRfaWQpCiAgICAKICAgICMgTG9nIGFjdGl2aXR5CiAgICBhd2FpdCBkYi51c2Vy
X2FjdGl2aXR5Lmluc2VydF9vbmUoewogICAgICAgICJ1c2VyX2lkIjogdXNlcl9pZF9zdHIsCiAg
ICAgICAgImFjdGlvbiI6ICJlYV9jcmVhdGVkIiwKICAgICAgICAiZGV0YWlscyI6IHsiZWFfbmFt
ZSI6IGVhX2lucHV0Lm5hbWUsICJzeW1ib2wiOiBlYV9pbnB1dC5jb25maWcuc3ltYm9sfSwKICAg
ICAgICAidGltZXN0YW1wIjogZGF0ZXRpbWUudXRjbm93KCkKICAgIH0pCiAgICAKICAgIGxvZ2dl
ci5pbmZvKGYi4pyFIENyZWF0ZWQgRUEgJ3tlYV9pbnB1dC5uYW1lfScgZm9yIHVzZXIge3VzZXJf
aWRfc3RyfSIpCiAgICAKICAgIHJldHVybiBzZXJpYWxpemVfZG9jKGVhX2RpY3QpCgpAYXBpX3Jv
dXRlci5nZXQoIi9lYSIsIHJlc3BvbnNlX21vZGVsPUxpc3RbZGljdF0pCmFzeW5jIGRlZiBnZXRf
YWxsX2VhcyhjdXJyZW50X3VzZXIgPSBEZXBlbmRzKGdldF9jdXJyZW50X3VzZXIpKToKICAgICIi
IkdldCBhbGwgRUFzIGZvciB0aGUgYXV0aGVudGljYXRlZCB1c2VyIiIiCiAgICB1c2VyX2lkX3N0
ciA9IHN0cihjdXJyZW50X3VzZXJbIl9pZCJdKQogICAgZWFzID0gYXdhaXQgZGIuZWFzLmZpbmQo
eyJ1c2VyX2lkIjogdXNlcl9pZF9zdHJ9KS50b19saXN0KDEwMDApCiAgICAKICAgICMgVXBkYXRl
IHNpZ25hbHMgZm9yIHJ1bm5pbmcgRUFzIGFuZCBjaGVjayBmb3Igc2lnbmFsIGNoYW5nZXMKICAg
IGZvciBlYSBpbiBlYXM6CiAgICAgICAgaWYgZWEuZ2V0KCJzdGF0dXMiKSA9PSAicnVubmluZyI6
CiAgICAgICAgICAgIHNpZ25hbF9kYXRhID0gYXdhaXQgY2FsY3VsYXRlX3NpZ25hbChlYSkKICAg
ICAgICAgICAgY3VycmVudF9zaWduYWwgPSBzaWduYWxfZGF0YVsic2lnbmFsIl0KICAgICAgICAg
ICAgcHJldmlvdXNfc2lnbmFsID0gZWEuZ2V0KCJwcmV2aW91c19zaWduYWwiLCAiTkVVVFJBTCIp
CiAgICAgICAgICAgIAogICAgICAgICAgICAjIENoZWNrIGlmIHNpZ25hbCBjaGFuZ2VkCiAgICAg
ICAgICAgIGlmIGN1cnJlbnRfc2lnbmFsICE9IHByZXZpb3VzX3NpZ25hbCBhbmQgY3VycmVudF9z
aWduYWwgIT0gIk5FVVRSQUwiOgogICAgICAgICAgICAgICAgIyBTZW5kIHB1c2ggbm90aWZpY2F0
aW9uCiAgICAgICAgICAgICAgICBhd2FpdCBzZW5kX3NpZ25hbF9ub3RpZmljYXRpb24oZWEsIGN1
cnJlbnRfc2lnbmFsLCBzaWduYWxfZGF0YVsicHJpY2UiXSkKICAgICAgICAgICAgICAgIAogICAg
ICAgICAgICAgICAgIyBVcGRhdGUgcHJldmlvdXMgc2lnbmFsCiAgICAgICAgICAgICAgICBhd2Fp
dCBkYi5lYXMudXBkYXRlX29uZSgKICAgICAgICAgICAgICAgICAgICB7Il9pZCI6IGVhWyJfaWQi
XX0sCiAgICAgICAgICAgICAgICAgICAgeyIkc2V0IjogeyJwcmV2aW91c19zaWduYWwiOiBjdXJy
ZW50X3NpZ25hbH19CiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgIAogICAgICAgICAgICBl
YVsiY3VycmVudF9zaWduYWwiXSA9IGN1cnJlbnRfc2lnbmFsCiAgICAgICAgICAgIGVhWyJsYXN0
X3ByaWNlIl0gPSBzaWduYWxfZGF0YVsicHJpY2UiXQogICAgICAgICAgICBlYVsiaW5kaWNhdG9y
X3ZhbHVlcyJdID0gc2lnbmFsX2RhdGEuZ2V0KCJpbmRpY2F0b3JfdmFsdWVzIiwge30pCiAgICAK
ICAgIHJldHVybiBbc2VyaWFsaXplX2RvYyhlYSkgZm9yIGVhIGluIGVhc10KCkBhcGlfcm91dGVy
LmdldCgiL2VhL3tlYV9pZH0iLCByZXNwb25zZV9tb2RlbD1kaWN0KQphc3luYyBkZWYgZ2V0X2Vh
KGVhX2lkOiBzdHIsIGN1cnJlbnRfdXNlciA9IERlcGVuZHMoZ2V0X2N1cnJlbnRfdXNlcikpOgog
ICAgIiIiR2V0IGEgc3BlY2lmaWMgRUEgKHJlcXVpcmVzIGF1dGhlbnRpY2F0aW9uIGFuZCBvd25l
cnNoaXApIiIiCiAgICB0cnk6CiAgICAgICAgZWEgPSBhd2FpdCBkYi5lYXMuZmluZF9vbmUoeyJf
aWQiOiBPYmplY3RJZChlYV9pZCksICJ1c2VyX2lkIjogY3VycmVudF91c2VyWyJfaWQiXX0pCiAg
ICAgICAgaWYgbm90IGVhOgogICAgICAgICAgICByYWlzZSBIVFRQRXhjZXB0aW9uKHN0YXR1c19j
b2RlPTQwNCwgZGV0YWlsPSJFQSBub3QgZm91bmQiKQogICAgICAgIAogICAgICAgICMgVXBkYXRl
IHNpZ25hbCBpZiBydW5uaW5nCiAgICAgICAgaWYgZWEuZ2V0KCJzdGF0dXMiKSA9PSAicnVubmlu
ZyI6CiAgICAgICAgICAgIHNpZ25hbF9kYXRhID0gYXdhaXQgY2FsY3VsYXRlX3NpZ25hbChlYSkK
ICAgICAgICAgICAgZWFbImN1cnJlbnRfc2lnbmFsIl0gPSBzaWduYWxfZGF0YVsic2lnbmFsIl0K
ICAgICAgICAgICAgZWFbImxhc3RfcHJpY2UiXSA9IHNpZ25hbF9kYXRhWyJwcmljZSJdCiAgICAg
ICAgICAgIGVhWyJpbmRpY2F0b3JfdmFsdWVzIl0gPSBzaWduYWxfZGF0YS5nZXQoImluZGljYXRv
cl92YWx1ZXMiLCB7fSkKICAgICAgICAKICAgICAgICByZXR1cm4gc2VyaWFsaXplX2RvYyhlYSkK
ICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICByYWlzZSBIVFRQRXhjZXB0aW9uKHN0
YXR1c19jb2RlPTQwMCwgZGV0YWlsPXN0cihlKSkKCkBhcGlfcm91dGVyLnB1dCgiL2VhL3tlYV9p
ZH0iLCByZXNwb25zZV9tb2RlbD1kaWN0KQphc3luYyBkZWYgdXBkYXRlX2VhKGVhX2lkOiBzdHIs
IGVhX3VwZGF0ZTogRUFVcGRhdGUsIGN1cnJlbnRfdXNlciA9IERlcGVuZHMoZ2V0X2N1cnJlbnRf
dXNlcikpOgogICAgIiIiVXBkYXRlIGFuIEVBIChyZXF1aXJlcyBhdXRoZW50aWNhdGlvbiBhbmQg
b3duZXJzaGlwKSIiIgogICAgdHJ5OgogICAgICAgIHVwZGF0ZV9kaWN0ID0geyJ1cGRhdGVkX2F0
IjogZGF0ZXRpbWUudXRjbm93KCl9CiAgICAgICAgaWYgZWFfdXBkYXRlLm5hbWUgaXMgbm90IE5v
bmU6CiAgICAgICAgICAgIHVwZGF0ZV9kaWN0WyJuYW1lIl0gPSBlYV91cGRhdGUubmFtZQogICAg
ICAgIGlmIGVhX3VwZGF0ZS5jb25maWcgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIHVwZGF0ZV9k
aWN0WyJjb25maWciXSA9IGVhX3VwZGF0ZS5jb25maWcuZGljdCgpCiAgICAgICAgaWYgZWFfdXBk
YXRlLnN0YXR1cyBpcyBub3QgTm9uZToKICAgICAgICAgICAgdXBkYXRlX2RpY3RbInN0YXR1cyJd
ID0gZWFfdXBkYXRlLnN0YXR1cwogICAgICAgIAogICAgICAgIHJlc3VsdCA9IGF3YWl0IGRiLmVh
cy51cGRhdGVfb25lKAogICAgICAgICAgICB7Il9pZCI6IE9iamVjdElkKGVhX2lkKSwgInVzZXJf
aWQiOiBjdXJyZW50X3VzZXJbIl9pZCJdfSwKICAgICAgICAgICAgeyIkc2V0IjogdXBkYXRlX2Rp
Y3R9CiAgICAgICAgKQogICAgICAgIGlmIHJlc3VsdC5tb2RpZmllZF9jb3VudCA9PSAwOgogICAg
ICAgICAgICByYWlzZSBIVFRQRXhjZXB0aW9uKHN0YXR1c19jb2RlPTQwNCwgZGV0YWlsPSJFQSBu
b3QgZm91bmQiKQogICAgICAgIAogICAgICAgIGVhID0gYXdhaXQgZGIuZWFzLmZpbmRfb25lKHsi
X2lkIjogT2JqZWN0SWQoZWFfaWQpLCAidXNlcl9pZCI6IGN1cnJlbnRfdXNlclsiX2lkIl19KQog
ICAgICAgIHJldHVybiBzZXJpYWxpemVfZG9jKGVhKQogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBl
OgogICAgICAgIHJhaXNlIEhUVFBFeGNlcHRpb24oc3RhdHVzX2NvZGU9NDAwLCBkZXRhaWw9c3Ry
KGUpKQoKQGFwaV9yb3V0ZXIuZGVsZXRlKCIvZWEve2VhX2lkfSIpCmFzeW5jIGRlZiBkZWxldGVf
ZWEoZWFfaWQ6IHN0ciwgY3VycmVudF91c2VyID0gRGVwZW5kcyhnZXRfY3VycmVudF91c2VyKSk6
CiAgICAiIiJEZWxldGUgYW4gRUEgKHJlcXVpcmVzIGF1dGhlbnRpY2F0aW9uIGFuZCBvd25lcnNo
aXApIiIiCiAgICB0cnk6CiAgICAgICAgdXNlcl9pZF9zdHIgPSBzdHIoY3VycmVudF91c2VyWyJf
aWQiXSkKICAgICAgICBsb2dnZXIuaW5mbyhmIkF0dGVtcHRpbmcgdG8gZGVsZXRlIEVBIHtlYV9p
ZH0gZm9yIHVzZXIge3VzZXJfaWRfc3RyfSIpCiAgICAgICAgCiAgICAgICAgcmVzdWx0ID0gYXdh
aXQgZGIuZWFzLmRlbGV0ZV9vbmUoeyJfaWQiOiBPYmplY3RJZChlYV9pZCksICJ1c2VyX2lkIjog
dXNlcl9pZF9zdHJ9KQogICAgICAgIAogICAgICAgIGlmIHJlc3VsdC5kZWxldGVkX2NvdW50ID09
IDA6CiAgICAgICAgICAgIGxvZ2dlci53YXJuaW5nKGYiRUEge2VhX2lkfSBub3QgZm91bmQgb3Ig
ZG9lc24ndCBiZWxvbmcgdG8gdXNlciB7dXNlcl9pZF9zdHJ9IikKICAgICAgICAgICAgcmFpc2Ug
SFRUUEV4Y2VwdGlvbihzdGF0dXNfY29kZT00MDQsIGRldGFpbD0iRUEgbm90IGZvdW5kIG9yIGRv
ZXNuJ3QgYmVsb25nIHRvIHlvdSIpCiAgICAgICAgCiAgICAgICAgbG9nZ2VyLmluZm8oZiLinIUg
RUEge2VhX2lkfSBkZWxldGVkIHN1Y2Nlc3NmdWxseSBmb3IgdXNlciB7dXNlcl9pZF9zdHJ9IikK
ICAgICAgICByZXR1cm4geyJtZXNzYWdlIjogIkVBIGRlbGV0ZWQgc3VjY2Vzc2Z1bGx5In0KICAg
IGV4Y2VwdCBIVFRQRXhjZXB0aW9uOgogICAgICAgIHJhaXNlCiAgICBleGNlcHQgRXhjZXB0aW9u
IGFzIGU6CiAgICAgICAgbG9nZ2VyLmVycm9yKGYiRXJyb3IgZGVsZXRpbmcgRUE6IHtzdHIoZSl9
IikKICAgICAgICByYWlzZSBIVFRQRXhjZXB0aW9uKHN0YXR1c19jb2RlPTQwMCwgZGV0YWlsPXN0
cihlKSkKCkBhcGlfcm91dGVyLnBvc3QoIi9lYS97ZWFfaWR9L3N0YXJ0IikKYXN5bmMgZGVmIHN0
YXJ0X2VhKGVhX2lkOiBzdHIsIGN1cnJlbnRfdXNlciA9IERlcGVuZHMoZ2V0X2N1cnJlbnRfdXNl
cikpOgogICAgIiIiU3RhcnQgYW4gRUEgKHJlcXVpcmVzIGF1dGhlbnRpY2F0aW9uIGFuZCBvd25l
cnNoaXApIiIiCiAgICB0cnk6CiAgICAgICAgdXNlcl9pZF9zdHIgPSBzdHIoY3VycmVudF91c2Vy
WyJfaWQiXSkKICAgICAgICByZXN1bHQgPSBhd2FpdCBkYi5lYXMudXBkYXRlX29uZSgKICAgICAg
ICAgICAgeyJfaWQiOiBPYmplY3RJZChlYV9pZCksICJ1c2VyX2lkIjogdXNlcl9pZF9zdHJ9LAog
ICAgICAgICAgICB7IiRzZXQiOiB7InN0YXR1cyI6ICJydW5uaW5nIiwgInVwZGF0ZWRfYXQiOiBk
YXRldGltZS51dGNub3coKX19CiAgICAgICAgKQogICAgICAgIGlmIHJlc3VsdC5tb2RpZmllZF9j
b3VudCA9PSAwOgogICAgICAgICAgICByYWlzZSBIVFRQRXhjZXB0aW9uKHN0YXR1c19jb2RlPTQw
NCwgZGV0YWlsPSJFQSBub3QgZm91bmQgb3IgZG9lc24ndCBiZWxvbmcgdG8geW91IikKICAgICAg
ICBlYSA9IGF3YWl0IGRiLmVhcy5maW5kX29uZSh7Il9pZCI6IE9iamVjdElkKGVhX2lkKSwgInVz
ZXJfaWQiOiB1c2VyX2lkX3N0cn0pCiAgICAgICAgcmV0dXJuIHNlcmlhbGl6ZV9kb2MoZWEpCiAg
ICBleGNlcHQgSFRUUEV4Y2VwdGlvbjoKICAgICAgICByYWlzZQogICAgZXhjZXB0IEV4Y2VwdGlv
biBhcyBlOgogICAgICAgIGxvZ2dlci5lcnJvcihmIkVycm9yIHN0YXJ0aW5nIEVBOiB7c3RyKGUp
fSIpCiAgICAgICAgcmFpc2UgSFRUUEV4Y2VwdGlvbihzdGF0dXNfY29kZT00MDAsIGRldGFpbD1z
dHIoZSkpCgpAYXBpX3JvdXRlci5wb3N0KCIvZWEve2VhX2lkfS9zdG9wIikKYXN5bmMgZGVmIHN0
b3BfZWEoZWFfaWQ6IHN0ciwgY3VycmVudF91c2VyID0gRGVwZW5kcyhnZXRfY3VycmVudF91c2Vy
KSk6CiAgICAiIiJTdG9wIGFuIEVBIChyZXF1aXJlcyBhdXRoZW50aWNhdGlvbiBhbmQgb3duZXJz
aGlwKSIiIgogICAgdHJ5OgogICAgICAgIHVzZXJfaWRfc3RyID0gc3RyKGN1cnJlbnRfdXNlclsi
X2lkIl0pCiAgICAgICAgcmVzdWx0ID0gYXdhaXQgZGIuZWFzLnVwZGF0ZV9vbmUoCiAgICAgICAg
ICAgIHsiX2lkIjogT2JqZWN0SWQoZWFfaWQpLCAidXNlcl9pZCI6IHVzZXJfaWRfc3RyfSwKICAg
ICAgICAgICAgeyIkc2V0IjogeyJzdGF0dXMiOiAic3RvcHBlZCIsICJ1cGRhdGVkX2F0IjogZGF0
ZXRpbWUudXRjbm93KCl9fQogICAgICAgICkKICAgICAgICBpZiByZXN1bHQubW9kaWZpZWRfY291
bnQgPT0gMDoKICAgICAgICAgICAgcmFpc2UgSFRUUEV4Y2VwdGlvbihzdGF0dXNfY29kZT00MDQs
IGRldGFpbD0iRUEgbm90IGZvdW5kIG9yIGRvZXNuJ3QgYmVsb25nIHRvIHlvdSIpCiAgICAgICAg
ZWEgPSBhd2FpdCBkYi5lYXMuZmluZF9vbmUoeyJfaWQiOiBPYmplY3RJZChlYV9pZCksICJ1c2Vy
X2lkIjogdXNlcl9pZF9zdHJ9KQogICAgICAgIHJldHVybiBzZXJpYWxpemVfZG9jKGVhKQogICAg
ZXhjZXB0IEhUVFBFeGNlcHRpb246CiAgICAgICAgcmFpc2UKICAgIGV4Y2VwdCBFeGNlcHRpb24g
YXMgZToKICAgICAgICBsb2dnZXIuZXJyb3IoZiJFcnJvciBzdG9wcGluZyBFQToge3N0cihlKX0i
KQogICAgICAgIHJhaXNlIEhUVFBFeGNlcHRpb24oc3RhdHVzX2NvZGU9NDAwLCBkZXRhaWw9c3Ry
KGUpKQoKQGFwaV9yb3V0ZXIuZ2V0KCIvaW5kaWNhdG9ycy9hdmFpbGFibGUiKQphc3luYyBkZWYg
Z2V0X2F2YWlsYWJsZV9pbmRpY2F0b3JzKCk6CiAgICAiIiJHZXQgbGlzdCBvZiBhdmFpbGFibGUg
dGVjaG5pY2FsIGluZGljYXRvcnMgd2l0aCB0aGVpciBkZWZhdWx0IHBhcmFtZXRlcnMiIiIKICAg
IHRyeToKICAgICAgICBpbmRpY2F0b3JzID0gewogICAgICAgICAgICAiUlNJIjogewogICAgICAg
ICAgICAgICAgIm5hbWUiOiAiUmVsYXRpdmUgU3RyZW5ndGggSW5kZXgiLAogICAgICAgICAgICAg
ICAgImRlc2NyaXB0aW9uIjogIk1vbWVudHVtIG9zY2lsbGF0b3IgbWVhc3VyaW5nIHNwZWVkIGFu
ZCBtYWduaXR1ZGUgb2YgcHJpY2UgY2hhbmdlcyIsCiAgICAgICAgICAgICAgICAiZGVmYXVsdF9w
YXJhbXMiOiB7CiAgICAgICAgICAgICAgICAgICAgInBlcmlvZCI6IDE0LAogICAgICAgICAgICAg
ICAgICAgICJvdmVyc29sZCI6IDMwLAogICAgICAgICAgICAgICAgICAgICJvdmVyYm91Z2h0Ijog
NzAKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAic2lnbmFsX3J1bGVzIjogIlJT
SSA8IDMwID0gQlVZIChPdmVyc29sZCksIFJTSSA+IDcwID0gU0VMTCAoT3ZlcmJvdWdodCkiCiAg
ICAgICAgICAgIH0sCiAgICAgICAgICAgICJNQUNEIjogewogICAgICAgICAgICAgICAgIm5hbWUi
OiAiTW92aW5nIEF2ZXJhZ2UgQ29udmVyZ2VuY2UgRGl2ZXJnZW5jZSIsCiAgICAgICAgICAgICAg
ICAiZGVzY3JpcHRpb24iOiAiVHJlbmQtZm9sbG93aW5nIG1vbWVudHVtIGluZGljYXRvciBzaG93
aW5nIHJlbGF0aW9uc2hpcCBiZXR3ZWVuIHR3byBtb3ZpbmcgYXZlcmFnZXMiLAogICAgICAgICAg
ICAgICAgImRlZmF1bHRfcGFyYW1zIjogewogICAgICAgICAgICAgICAgICAgICJmYXN0IjogMTIs
CiAgICAgICAgICAgICAgICAgICAgInNsb3ciOiAyNiwKICAgICAgICAgICAgICAgICAgICAic2ln
bmFsIjogOQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICJzaWduYWxfcnVsZXMi
OiAiTUFDRCBjcm9zc2VzIGFib3ZlIHNpZ25hbCBsaW5lID0gQlVZLCBNQUNEIGNyb3NzZXMgYmVs
b3cgPSBTRUxMIgogICAgICAgICAgICB9LAogICAgICAgICAgICAiU01BIjogewogICAgICAgICAg
ICAgICAgIm5hbWUiOiAiU2ltcGxlIE1vdmluZyBBdmVyYWdlIiwKICAgICAgICAgICAgICAgICJk
ZXNjcmlwdGlvbiI6ICJBdmVyYWdlIHByaWNlIG92ZXIgYSBzcGVjaWZpZWQgbnVtYmVyIG9mIHBl
cmlvZHMiLAogICAgICAgICAgICAgICAgImRlZmF1bHRfcGFyYW1zIjogewogICAgICAgICAgICAg
ICAgICAgICJwZXJpb2QiOiAyMAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICJz
aWduYWxfcnVsZXMiOiAiUHJpY2UgYWJvdmUgU01BID0gQlVZLCBQcmljZSBiZWxvdyBTTUEgPSBT
RUxMIgogICAgICAgICAgICB9LAogICAgICAgICAgICAiRU1BIjogewogICAgICAgICAgICAgICAg
Im5hbWUiOiAiRXhwb25lbnRpYWwgTW92aW5nIEF2ZXJhZ2UiLAogICAgICAgICAgICAgICAgImRl
c2NyaXB0aW9uIjogIldlaWdodGVkIG1vdmluZyBhdmVyYWdlIGdpdmluZyBtb3JlIGltcG9ydGFu
Y2UgdG8gcmVjZW50IHByaWNlcyIsCiAgICAgICAgICAgICAgICAiZGVmYXVsdF9wYXJhbXMiOiB7
CiAgICAgICAgICAgICAgICAgICAgInBlcmlvZCI6IDIwCiAgICAgICAgICAgICAgICB9LAogICAg
ICAgICAgICAgICAgInNpZ25hbF9ydWxlcyI6ICJQcmljZSBhYm92ZSBFTUEgPSBCVVksIFByaWNl
IGJlbG93IEVNQSA9IFNFTEwiCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJu
IHsiaW5kaWNhdG9ycyI6IGluZGljYXRvcnN9CiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAg
ICAgICAgbG9nZ2VyLmVycm9yKGYiRXJyb3IgZ2V0dGluZyBhdmFpbGFibGUgaW5kaWNhdG9yczog
e3N0cihlKX0iKQogICAgICAgIHJhaXNlIEhUVFBFeGNlcHRpb24oc3RhdHVzX2NvZGU9NTAwLCBk
ZXRhaWw9c3RyKGUpKQoKQGFwaV9yb3V0ZXIuZ2V0KCIvZWEve2VhX2lkfS9jYWxjdWxhdGUiKQph
c3luYyBkZWYgY2FsY3VsYXRlX2VhX3NpZ25hbChlYV9pZDogc3RyLCBjdXJyZW50X3VzZXIgPSBE
ZXBlbmRzKGdldF9jdXJyZW50X3VzZXIpKToKICAgICIiIkNhbGN1bGF0ZSBpbmRpY2F0b3IgYW5k
IHNpZ25hbCBmb3IgYW4gRUEgdXNpbmcgcmVhbC10aW1lIGRhdGEiIiIKICAgIHRyeToKICAgICAg
ICB1c2VyX2lkX3N0ciA9IHN0cihjdXJyZW50X3VzZXJbIl9pZCJdKQogICAgICAgIGVhID0gYXdh
aXQgZGIuZWFzLmZpbmRfb25lKHsiX2lkIjogT2JqZWN0SWQoZWFfaWQpLCAidXNlcl9pZCI6IHVz
ZXJfaWRfc3RyfSkKICAgICAgICAKICAgICAgICBpZiBub3QgZWE6CiAgICAgICAgICAgIHJhaXNl
IEhUVFBFeGNlcHRpb24oc3RhdHVzX2NvZGU9NDA0LCBkZXRhaWw9IkVBIG5vdCBmb3VuZCBvciBk
b2Vzbid0IGJlbG9uZyB0byB5b3UiKQogICAgICAgIAogICAgICAgICMgR2V0IEVBIGNvbmZpZ3Vy
YXRpb24KICAgICAgICBjb25maWcgPSBlYS5nZXQoImNvbmZpZyIsIHt9KQogICAgICAgIHN5bWJv
bCA9IGNvbmZpZy5nZXQoInN5bWJvbCIsICJFVVIvVVNEIikKICAgICAgICB0aW1lZnJhbWUgPSBj
b25maWcuZ2V0KCJ0aW1lZnJhbWUiLCAiMTVtaW4iKQogICAgICAgIGluZGljYXRvcl9jb25maWcg
PSBjb25maWcuZ2V0KCJpbmRpY2F0b3IiLCB7fSkKICAgICAgICBpbmRpY2F0b3JfdHlwZSA9IGlu
ZGljYXRvcl9jb25maWcuZ2V0KCJ0eXBlIiwgIlJTSSIpCiAgICAgICAgaW5kaWNhdG9yX3BhcmFt
cyA9IGluZGljYXRvcl9jb25maWcuZ2V0KCJwYXJhbXMiLCB7fSkKICAgICAgICAKICAgICAgICBs
b2dnZXIuaW5mbyhmIvCfk4ogQ2FsY3VsYXRpbmcge2luZGljYXRvcl90eXBlfSBmb3Ige3N5bWJv
bH0gKHt0aW1lZnJhbWV9KSIpCiAgICAgICAgCiAgICAgICAgIyBHZXQgdGVjaG5pY2FsIGFuYWx5
c2lzIHNlcnZpY2UKICAgICAgICB0YV9zZXJ2aWNlID0gZ2V0X3RlY2huaWNhbF9hbmFseXNpc19z
ZXJ2aWNlKCkKICAgICAgICAKICAgICAgICAjIENhbGN1bGF0ZSBpbmRpY2F0b3IgYW5kIHNpZ25h
bAogICAgICAgIHJlc3VsdCA9IHRhX3NlcnZpY2UuY2FsY3VsYXRlX2luZGljYXRvcl9hbmRfc2ln
bmFsKAogICAgICAgICAgICBzeW1ib2w9c3ltYm9sLAogICAgICAgICAgICBpbmRpY2F0b3JfdHlw
ZT1pbmRpY2F0b3JfdHlwZSwKICAgICAgICAgICAgdGltZWZyYW1lPXRpbWVmcmFtZSwKICAgICAg
ICAgICAgaW5kaWNhdG9yX3BhcmFtcz1pbmRpY2F0b3JfcGFyYW1zCiAgICAgICAgKQogICAgICAg
IAogICAgICAgICMgVXBkYXRlIEVBIHdpdGggbGF0ZXN0IHNpZ25hbCBhbmQgcHJpY2UKICAgICAg
ICBjdXJyZW50X3NpZ25hbCA9IHJlc3VsdC5nZXQoInNpZ25hbCIsICJORVVUUkFMIikKICAgICAg
ICBjdXJyZW50X3ByaWNlID0gcmVzdWx0LmdldCgiY3VycmVudF9wcmljZSIsIDApCiAgICAgICAg
CiAgICAgICAgYXdhaXQgZGIuZWFzLnVwZGF0ZV9vbmUoCiAgICAgICAgICAgIHsiX2lkIjogT2Jq
ZWN0SWQoZWFfaWQpfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgIiRzZXQiOiB7CiAg
ICAgICAgICAgICAgICAgICAgImN1cnJlbnRfc2lnbmFsIjogY3VycmVudF9zaWduYWwsCiAgICAg
ICAgICAgICAgICAgICAgImxhc3RfcHJpY2UiOiBjdXJyZW50X3ByaWNlLAogICAgICAgICAgICAg
ICAgICAgICJsYXN0X2NhbGN1bGF0ZWRfYXQiOiBkYXRldGltZS51dGNub3coKQogICAgICAgICAg
ICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgKQogICAgICAgIAogICAgICAgIGxvZ2dlci5p
bmZvKGYi4pyFIHtzeW1ib2x9IHtpbmRpY2F0b3JfdHlwZX06IHtjdXJyZW50X3NpZ25hbH0gYXQg
e2N1cnJlbnRfcHJpY2V9IikKICAgICAgICAKICAgICAgICByZXR1cm4gewogICAgICAgICAgICAi
ZWFfaWQiOiBzdHIoZWFbIl9pZCJdKSwKICAgICAgICAgICAgInNpZ25hbCI6IGN1cnJlbnRfc2ln
bmFsLAogICAgICAgICAgICAicHJpY2UiOiBjdXJyZW50X3ByaWNlLAogICAgICAgICAgICAiaW5k
aWNhdG9yX2RhdGEiOiByZXN1bHQsCiAgICAgICAgICAgICJ0aW1lc3RhbXAiOiByZXN1bHQuZ2V0
KCJ0aW1lc3RhbXAiKQogICAgICAgIH0KICAgICAgICAKICAgIGV4Y2VwdCBIVFRQRXhjZXB0aW9u
OgogICAgICAgIHJhaXNlCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgbG9nZ2Vy
LmVycm9yKGYi4p2MIEVycm9yIGNhbGN1bGF0aW5nIEVBIHNpZ25hbDoge3N0cihlKX0iKQogICAg
ICAgIHJhaXNlIEhUVFBFeGNlcHRpb24oc3RhdHVzX2NvZGU9NTAwLCBkZXRhaWw9c3RyKGUpKQoK
IyBQdXNoIE5vdGlmaWNhdGlvbiBSb3V0ZXMKQGFwaV9yb3V0ZXIucG9zdCgiL3B1c2gtdG9rZW4i
KQphc3luYyBkZWYgc2F2ZV9wdXNoX3Rva2VuKHRva2VuX2RhdGE6IFB1c2hUb2tlbik6CiAgICB0
cnk6CiAgICAgICAgIyBTdG9yZSBvciB1cGRhdGUgcHVzaCB0b2tlbgogICAgICAgIGF3YWl0IGRi
LnB1c2hfdG9rZW5zLnVwZGF0ZV9vbmUoCiAgICAgICAgICAgIHsidG9rZW4iOiB0b2tlbl9kYXRh
LnRva2VufSwKICAgICAgICAgICAgeyIkc2V0IjogeyJ0b2tlbiI6IHRva2VuX2RhdGEudG9rZW4s
ICJ1cGRhdGVkX2F0IjogZGF0ZXRpbWUudXRjbm93KCl9fSwKICAgICAgICAgICAgdXBzZXJ0PVRy
dWUKICAgICAgICApCiAgICAgICAgcmV0dXJuIHsibWVzc2FnZSI6ICJQdXNoIHRva2VuIHNhdmVk
IHN1Y2Nlc3NmdWxseSJ9CiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgcmFpc2Ug
SFRUUEV4Y2VwdGlvbihzdGF0dXNfY29kZT00MDAsIGRldGFpbD1zdHIoZSkpCgphc3luYyBkZWYg
c2VuZF9zaWduYWxfbm90aWZpY2F0aW9uKGVhOiBkaWN0LCBzaWduYWw6IHN0ciwgcHJpY2U6IGZs
b2F0KToKICAgICIiIlNlbmQgcHVzaCBub3RpZmljYXRpb24gd2hlbiBzaWduYWwgY2hhbmdlcyIi
IgogICAgdHJ5OgogICAgICAgICMgR2V0IGFsbCBwdXNoIHRva2VucwogICAgICAgIHRva2VucyA9
IGF3YWl0IGRiLnB1c2hfdG9rZW5zLmZpbmQoKS50b19saXN0KDEwMDApCiAgICAgICAgCiAgICAg
ICAgaWYgbm90IHRva2VuczoKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgCiAgICAgICAgc3lt
Ym9sID0gZWEuZ2V0KCJjb25maWciLCB7fSkuZ2V0KCJzeW1ib2wiLCAiVW5rbm93biIpCiAgICAg
ICAgaW5kaWNhdG9yID0gZWEuZ2V0KCJjb25maWciLCB7fSkuZ2V0KCJpbmRpY2F0b3IiLCB7fSku
Z2V0KCJ0eXBlIiwgIlVua25vd24iKQogICAgICAgIAogICAgICAgICMgUHJlcGFyZSBub3RpZmlj
YXRpb24gbWVzc2FnZQogICAgICAgIHRpdGxlID0gZiLwn5qoIHtzaWduYWx9IFNpZ25hbDoge3N5
bWJvbH0iCiAgICAgICAgYm9keSA9IGYie2luZGljYXRvcn0gZGV0ZWN0ZWQge3NpZ25hbH0gc2ln
bmFsIGF0IHtwcmljZTouNWZ9IgogICAgICAgIAogICAgICAgICMgU2VuZCB0byBFeHBvIFB1c2gg
Tm90aWZpY2F0aW9uIHNlcnZpY2UKICAgICAgICBtZXNzYWdlcyA9IFtdCiAgICAgICAgZm9yIHRv
a2VuX2RvYyBpbiB0b2tlbnM6CiAgICAgICAgICAgIG1lc3NhZ2VzLmFwcGVuZCh7CiAgICAgICAg
ICAgICAgICAidG8iOiB0b2tlbl9kb2NbInRva2VuIl0sCiAgICAgICAgICAgICAgICAic291bmQi
OiAiZGVmYXVsdCIsCiAgICAgICAgICAgICAgICAidGl0bGUiOiB0aXRsZSwKICAgICAgICAgICAg
ICAgICJib2R5IjogYm9keSwKICAgICAgICAgICAgICAgICJkYXRhIjogewogICAgICAgICAgICAg
ICAgICAgICJlYV9pZCI6IHN0cihlYVsiX2lkIl0pLAogICAgICAgICAgICAgICAgICAgICJzeW1i
b2wiOiBzeW1ib2wsCiAgICAgICAgICAgICAgICAgICAgInNpZ25hbCI6IHNpZ25hbCwKICAgICAg
ICAgICAgICAgICAgICAicHJpY2UiOiBwcmljZQogICAgICAgICAgICAgICAgfSwKICAgICAgICAg
ICAgICAgICJwcmlvcml0eSI6ICJoaWdoIiwKICAgICAgICAgICAgICAgICJjaGFubmVsSWQiOiAi
ZGVmYXVsdCIKICAgICAgICAgICAgfSkKICAgICAgICAKICAgICAgICAjIFNlbmQgbm90aWZpY2F0
aW9ucyBpbiBiYXRjaGVzCiAgICAgICAgYXN5bmMgd2l0aCBodHRweC5Bc3luY0NsaWVudCgpIGFz
IGNsaWVudDoKICAgICAgICAgICAgcmVzcG9uc2UgPSBhd2FpdCBjbGllbnQucG9zdCgKICAgICAg
ICAgICAgICAgICdodHRwczovL2V4cC5ob3N0Ly0tL2FwaS92Mi9wdXNoL3NlbmQnLAogICAgICAg
ICAgICAgICAganNvbj1tZXNzYWdlcywKICAgICAgICAgICAgICAgIHRpbWVvdXQ9MTAuMAogICAg
ICAgICAgICApCiAgICAgICAgICAgIGxvZ2dpbmcuaW5mbyhmIk5vdGlmaWNhdGlvbiBzZW50OiB7
cmVzcG9uc2Uuc3RhdHVzX2NvZGV9IikKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAg
ICBsb2dnaW5nLmVycm9yKGYiRXJyb3Igc2VuZGluZyBub3RpZmljYXRpb246IHtlfSIpCgojIE1h
cmtldCBEYXRhIFJvdXRlcwpAYXBpX3JvdXRlci5nZXQoIi9zeW1ib2xzIikKYXN5bmMgZGVmIGdl
dF9zeW1ib2xzKCk6CiAgICAiIiJHZXQgYWxsIGF2YWlsYWJsZSB0cmFkaW5nIHN5bWJvbHMgZ3Jv
dXBlZCBieSBjYXRlZ29yeSIiIgogICAgcmV0dXJuIG1hcmtldF9zaW11bGF0b3IuZ2V0X2FsbF9z
eW1ib2xzKCkKCkBhcGlfcm91dGVyLmdldCgiL3F1b3RlcyIpCmFzeW5jIGRlZiBnZXRfcXVvdGVz
KGNhdGVnb3J5OiBPcHRpb25hbFtzdHJdID0gTm9uZSk6CiAgICAiIiJHZXQgcmVhbC10aW1lIG1h
cmtldCBxdW90ZXMgZnJvbSBGaW5uaHViICYgQ29pbkdlY2tvIiIiCiAgICBhbGxfc3ltYm9scyA9
IG1hcmtldF9zaW11bGF0b3IuZ2V0X2FsbF9zeW1ib2xzKCkKICAgIAogICAgaWYgY2F0ZWdvcnk6
CiAgICAgICAgYWxsX3N5bWJvbHMgPSB7Y2F0ZWdvcnk6IGFsbF9zeW1ib2xzLmdldChjYXRlZ29y
eSwgW10pfQogICAgCiAgICBxdW90ZXMgPSBbXQogICAgZm9yIGNhdCwgc3ltYm9scyBpbiBhbGxf
c3ltYm9scy5pdGVtcygpOgogICAgICAgIGZvciBzeW1ib2wgaW4gc3ltYm9sczoKICAgICAgICAg
ICAgIyBUcnkgdG8gZ2V0IHJlYWwgbWFya2V0IGRhdGEgZmlyc3QKICAgICAgICAgICAgcmVhbF9k
YXRhID0gYXdhaXQgcmVhbF9tYXJrZXRfZGF0YS5nZXRfcHJpY2Uoc3ltYm9sLCBjYXQpCiAgICAg
ICAgICAgIAogICAgICAgICAgICBpZiByZWFsX2RhdGE6CiAgICAgICAgICAgICAgICAjIFVzZSBy
ZWFsIG1hcmtldCBkYXRhCiAgICAgICAgICAgICAgICBxdW90ZXMuYXBwZW5kKHsKICAgICAgICAg
ICAgICAgICAgICAnc3ltYm9sJzogc3ltYm9sLAogICAgICAgICAgICAgICAgICAgICdjYXRlZ29y
eSc6IGNhdCwKICAgICAgICAgICAgICAgICAgICAncHJpY2UnOiByZWFsX2RhdGFbJ3ByaWNlJ10s
CiAgICAgICAgICAgICAgICAgICAgJ2JpZCc6IHJlYWxfZGF0YVsnYmlkJ10sCiAgICAgICAgICAg
ICAgICAgICAgJ2Fzayc6IHJlYWxfZGF0YVsnYXNrJ10sCiAgICAgICAgICAgICAgICAgICAgJ2No
YW5nZSc6IHJlYWxfZGF0YVsnY2hhbmdlJ10sCiAgICAgICAgICAgICAgICAgICAgJ2NoYW5nZV9w
ZXJjZW50JzogcmVhbF9kYXRhWydjaGFuZ2VfcGVyY2VudCddLAogICAgICAgICAgICAgICAgICAg
ICdzb3VyY2UnOiAncmVhbCcsICAjIEluZGljYXRlIHJlYWwgZGF0YQogICAgICAgICAgICAgICAg
ICAgICd0aW1lc3RhbXAnOiByZWFsX2RhdGFbJ3RpbWVzdGFtcCddCiAgICAgICAgICAgICAgICB9
KQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgIyBGYWxsYmFjayB0byBzaW11bGF0
ZWQgZGF0YSBpZiByZWFsIGRhdGEgZmFpbHMKICAgICAgICAgICAgICAgIHByaWNlX2RhdGEgPSBt
YXJrZXRfc2ltdWxhdG9yLmdldF9jdXJyZW50X3ByaWNlKHN5bWJvbCkKICAgICAgICAgICAgICAg
IGlmIHByaWNlX2RhdGE6CiAgICAgICAgICAgICAgICAgICAgaGlzdG9yeSA9IG1hcmtldF9zaW11
bGF0b3IuZ2V0X3ByaWNlX2hpc3Rvcnkoc3ltYm9sLCAyKQogICAgICAgICAgICAgICAgICAgIGNo
YW5nZSA9IDAKICAgICAgICAgICAgICAgICAgICBpZiBsZW4oaGlzdG9yeSkgPj0gMjoKICAgICAg
ICAgICAgICAgICAgICAgICAgY2hhbmdlID0gKChwcmljZV9kYXRhWydiaWQnXSAtIGhpc3Rvcnlb
LTJdWydjbG9zZSddKSAvIGhpc3RvcnlbLTJdWydjbG9zZSddKSAqIDEwMAogICAgICAgICAgICAg
ICAgICAgIAogICAgICAgICAgICAgICAgICAgIHF1b3Rlcy5hcHBlbmQoewogICAgICAgICAgICAg
ICAgICAgICAgICAnc3ltYm9sJzogc3ltYm9sLAogICAgICAgICAgICAgICAgICAgICAgICAnY2F0
ZWdvcnknOiBjYXQsCiAgICAgICAgICAgICAgICAgICAgICAgICdwcmljZSc6IHByaWNlX2RhdGFb
J2JpZCddLAogICAgICAgICAgICAgICAgICAgICAgICAnYmlkJzogcHJpY2VfZGF0YVsnYmlkJ10s
CiAgICAgICAgICAgICAgICAgICAgICAgICdhc2snOiBwcmljZV9kYXRhWydhc2snXSwKICAgICAg
ICAgICAgICAgICAgICAgICAgJ2NoYW5nZSc6IGNoYW5nZSwKICAgICAgICAgICAgICAgICAgICAg
ICAgJ2NoYW5nZV9wZXJjZW50JzogY2hhbmdlLAogICAgICAgICAgICAgICAgICAgICAgICAnc291
cmNlJzogJ3NpbXVsYXRlZCcsICAjIEluZGljYXRlIHNpbXVsYXRlZCBkYXRhCiAgICAgICAgICAg
ICAgICAgICAgfSkKICAgIAogICAgcmV0dXJuIHF1b3RlcwoKQGFwaV9yb3V0ZXIuZ2V0KCIvbWFy
a2V0LWRhdGEve3N5bWJvbH0iKQphc3luYyBkZWYgZ2V0X21hcmtldF9kYXRhKHN5bWJvbDogc3Ry
LCBwZXJpb2Q6IGludCA9IDEwMCk6CiAgICAiIiJHZXQgaGlzdG9yaWNhbCBtYXJrZXQgZGF0YSBm
b3IgYSBzeW1ib2wiIiIKICAgIGhpc3RvcnkgPSBtYXJrZXRfc2ltdWxhdG9yLmdldF9wcmljZV9o
aXN0b3J5KHN5bWJvbCwgcGVyaW9kKQogICAgY3VycmVudCA9IG1hcmtldF9zaW11bGF0b3IuZ2V0
X2N1cnJlbnRfcHJpY2Uoc3ltYm9sKQogICAgCiAgICBpZiBub3QgY3VycmVudDoKICAgICAgICBy
YWlzZSBIVFRQRXhjZXB0aW9uKHN0YXR1c19jb2RlPTQwNCwgZGV0YWlsPSJTeW1ib2wgbm90IGZv
dW5kIikKICAgIAogICAgcmV0dXJuIHsKICAgICAgICAic3ltYm9sIjogc3ltYm9sLAogICAgICAg
ICJjdXJyZW50IjogY3VycmVudCwKICAgICAgICAiaGlzdG9yeSI6IGhpc3RvcnkKICAgIH0KCiMg
U2lnbmFsIENhbGN1bGF0aW9uIEhlbHBlcgphc3luYyBkZWYgY2FsY3VsYXRlX3NpZ25hbChlYTog
ZGljdCkgLT4gZGljdDoKICAgICIiIkNhbGN1bGF0ZSB0cmFkaW5nIHNpZ25hbCBmb3IgYW4gRUEi
IiIKICAgIGNvbmZpZyA9IGVhLmdldCgiY29uZmlnIiwge30pCiAgICBzeW1ib2wgPSBjb25maWcu
Z2V0KCJzeW1ib2wiKQogICAgaW5kaWNhdG9yX2NvbmZpZyA9IGNvbmZpZy5nZXQoImluZGljYXRv
ciIsIHt9KQogICAgCiAgICBpZiBub3Qgc3ltYm9sOgogICAgICAgIHJldHVybiB7InNpZ25hbCI6
ICJORVVUUkFMIiwgInByaWNlIjogMC4wfQogICAgCiAgICAjIEdldCBtYXJrZXQgZGF0YQogICAg
aGlzdG9yeSA9IG1hcmtldF9zaW11bGF0b3IuZ2V0X3ByaWNlX2hpc3Rvcnkoc3ltYm9sLCAyMDAp
CiAgICBjdXJyZW50ID0gbWFya2V0X3NpbXVsYXRvci5nZXRfY3VycmVudF9wcmljZShzeW1ib2wp
CiAgICAKICAgIGlmIG5vdCBoaXN0b3J5IG9yIG5vdCBjdXJyZW50OgogICAgICAgIHJldHVybiB7
InNpZ25hbCI6ICJORVVUUkFMIiwgInByaWNlIjogMC4wfQogICAgCiAgICBjbG9zZXMgPSBbY2Fu
ZGxlWyJjbG9zZSJdIGZvciBjYW5kbGUgaW4gaGlzdG9yeV0KICAgIGhpZ2hzID0gW2NhbmRsZVsi
aGlnaCJdIGZvciBjYW5kbGUgaW4gaGlzdG9yeV0KICAgIGxvd3MgPSBbY2FuZGxlWyJsb3ciXSBm
b3IgY2FuZGxlIGluIGhpc3RvcnldCiAgICBjdXJyZW50X3ByaWNlID0gY3VycmVudFsiY2xvc2Ui
XQogICAgCiAgICBpbmRpY2F0b3JfdHlwZSA9IGluZGljYXRvcl9jb25maWcuZ2V0KCJ0eXBlIiwg
IlJTSSIpCiAgICBwYXJhbWV0ZXJzID0gaW5kaWNhdG9yX2NvbmZpZy5nZXQoInBhcmFtZXRlcnMi
LCB7fSkKICAgIAogICAgIyBDYWxjdWxhdGUgaW5kaWNhdG9yIHZhbHVlcwogICAgaW5kaWNhdG9y
X3ZhbHVlcyA9IHt9CiAgICAKICAgIGlmIGluZGljYXRvcl90eXBlID09ICJNQV9DUk9TU09WRVIi
OgogICAgICAgIGZhc3RfcGVyaW9kID0gcGFyYW1ldGVycy5nZXQoImZhc3RfcGVyaW9kIiwgMTAp
CiAgICAgICAgc2xvd19wZXJpb2QgPSBwYXJhbWV0ZXJzLmdldCgic2xvd19wZXJpb2QiLCAyMCkK
ICAgICAgICBpbmRpY2F0b3JfdmFsdWVzID0gewogICAgICAgICAgICAiZmFzdF9tYSI6IFRlY2hu
aWNhbEluZGljYXRvcnMuY2FsY3VsYXRlX3NtYShjbG9zZXMsIGZhc3RfcGVyaW9kKSwKICAgICAg
ICAgICAgInNsb3dfbWEiOiBUZWNobmljYWxJbmRpY2F0b3JzLmNhbGN1bGF0ZV9zbWEoY2xvc2Vz
LCBzbG93X3BlcmlvZCkKICAgICAgICB9CiAgICBlbGlmIGluZGljYXRvcl90eXBlID09ICJSU0ki
OgogICAgICAgIHBlcmlvZCA9IHBhcmFtZXRlcnMuZ2V0KCJwZXJpb2QiLCAxNCkKICAgICAgICBy
c2lfdmFsdWUgPSBUZWNobmljYWxJbmRpY2F0b3JzLmNhbGN1bGF0ZV9yc2koY2xvc2VzLCBwZXJp
b2QpCiAgICAgICAgaW5kaWNhdG9yX3ZhbHVlcyA9IHsidmFsdWUiOiByc2lfdmFsdWV9CiAgICBl
bGlmIGluZGljYXRvcl90eXBlID09ICJNQUNEIjoKICAgICAgICBmYXN0ID0gcGFyYW1ldGVycy5n
ZXQoImZhc3QiLCAxMikKICAgICAgICBzbG93ID0gcGFyYW1ldGVycy5nZXQoInNsb3ciLCAyNikK
ICAgICAgICBzaWduYWwgPSBwYXJhbWV0ZXJzLmdldCgic2lnbmFsIiwgOSkKICAgICAgICBpbmRp
Y2F0b3JfdmFsdWVzID0gVGVjaG5pY2FsSW5kaWNhdG9ycy5jYWxjdWxhdGVfbWFjZChjbG9zZXMs
IGZhc3QsIHNsb3csIHNpZ25hbCkKICAgIGVsaWYgaW5kaWNhdG9yX3R5cGUgPT0gIkJPTExJTkdF
Ul9CQU5EUyI6CiAgICAgICAgcGVyaW9kID0gcGFyYW1ldGVycy5nZXQoInBlcmlvZCIsIDIwKQog
ICAgICAgIHN0ZF9kZXYgPSBwYXJhbWV0ZXJzLmdldCgic3RkX2RldiIsIDIuMCkKICAgICAgICBp
bmRpY2F0b3JfdmFsdWVzID0gVGVjaG5pY2FsSW5kaWNhdG9ycy5jYWxjdWxhdGVfYm9sbGluZ2Vy
X2JhbmRzKGNsb3NlcywgcGVyaW9kLCBzdGRfZGV2KQogICAgZWxpZiBpbmRpY2F0b3JfdHlwZSA9
PSAiU1RPQ0hBU1RJQyI6CiAgICAgICAgcGVyaW9kID0gcGFyYW1ldGVycy5nZXQoInBlcmlvZCIs
IDE0KQogICAgICAgIGtfc21vb3RoID0gcGFyYW1ldGVycy5nZXQoImtfc21vb3RoIiwgMykKICAg
ICAgICBpbmRpY2F0b3JfdmFsdWVzID0gVGVjaG5pY2FsSW5kaWNhdG9ycy5jYWxjdWxhdGVfc3Rv
Y2hhc3RpYyhoaWdocywgbG93cywgY2xvc2VzLCBwZXJpb2QsIGtfc21vb3RoKQogICAgCiAgICAj
IEdlbmVyYXRlIHNpZ25hbAogICAgc2lnbmFsID0gU2lnbmFsR2VuZXJhdG9yLmdlbmVyYXRlX3Np
Z25hbCgKICAgICAgICBpbmRpY2F0b3JfdHlwZSwKICAgICAgICBpbmRpY2F0b3JfdmFsdWVzLAog
ICAgICAgIHBhcmFtZXRlcnMsCiAgICAgICAgY3VycmVudF9wcmljZSwKICAgICAgICBjbG9zZXMK
ICAgICkKICAgIAogICAgcmV0dXJuIHsKICAgICAgICAic2lnbmFsIjogc2lnbmFsLAogICAgICAg
ICJwcmljZSI6IGN1cnJlbnRfcHJpY2UsCiAgICAgICAgImluZGljYXRvcl92YWx1ZXMiOiBpbmRp
Y2F0b3JfdmFsdWVzCiAgICB9CgpAYXBpX3JvdXRlci5nZXQoIi9lYS97ZWFfaWR9L3NpZ25hbCIp
CmFzeW5jIGRlZiBnZXRfZWFfc2lnbmFsKGVhX2lkOiBzdHIsIGN1cnJlbnRfdXNlciA9IERlcGVu
ZHMoZ2V0X2N1cnJlbnRfdXNlcikpOgogICAgIiIiR2V0IGN1cnJlbnQgc2lnbmFsIGZvciBhbiBF
QSAocmVxdWlyZXMgYXV0aGVudGljYXRpb24gYW5kIG93bmVyc2hpcCkiIiIKICAgIHRyeToKICAg
ICAgICBlYSA9IGF3YWl0IGRiLmVhcy5maW5kX29uZSh7Il9pZCI6IE9iamVjdElkKGVhX2lkKSwg
InVzZXJfaWQiOiBjdXJyZW50X3VzZXJbIl9pZCJdfSkKICAgICAgICBpZiBub3QgZWE6CiAgICAg
ICAgICAgIHJhaXNlIEhUVFBFeGNlcHRpb24oc3RhdHVzX2NvZGU9NDA0LCBkZXRhaWw9IkVBIG5v
dCBmb3VuZCIpCiAgICAgICAgCiAgICAgICAgc2lnbmFsX2RhdGEgPSBhd2FpdCBjYWxjdWxhdGVf
c2lnbmFsKGVhKQogICAgICAgIHJldHVybiBzaWduYWxfZGF0YQogICAgZXhjZXB0IEV4Y2VwdGlv
biBhcyBlOgogICAgICAgIHJhaXNlIEhUVFBFeGNlcHRpb24oc3RhdHVzX2NvZGU9NDAwLCBkZXRh
aWw9c3RyKGUpKQoKQGFwaV9yb3V0ZXIuZ2V0KCIvc2lnbmFscy97c3ltYm9sfSIpCmFzeW5jIGRl
ZiBnZXRfc2lnbmFsKHN5bWJvbDogc3RyLCB0aW1lZnJhbWU6IHN0ciA9ICcxSCcsIGluZGljYXRv
cjogc3RyID0gJ1JTSScpOgogICAgIiIiR2V0IHRyYWRpbmcgc2lnbmFsIGZvciBhIHN5bWJvbCB1
c2luZyByZWFsIG1hcmtldCBkYXRhIiIiCiAgICAjIERldGVybWluZSBjYXRlZ29yeQogICAgY2F0
ZWdvcnkgPSAnZm9yZXgnCiAgICBpZiAnQlRDJyBpbiBzeW1ib2wgb3IgJ0VUSCcgaW4gc3ltYm9s
IG9yICdYUlAnIGluIHN5bWJvbCBvciAnTFRDJyBpbiBzeW1ib2wgb3IgJ0FEQScgaW4gc3ltYm9s
IG9yICdET1QnIGluIHN5bWJvbDoKICAgICAgICBjYXRlZ29yeSA9ICdjcnlwdG8nCiAgICBlbGlm
ICdYQVUnIGluIHN5bWJvbCBvciAnWEFHJyBpbiBzeW1ib2wgb3IgJ1dUSScgaW4gc3ltYm9sOgog
ICAgICAgIGNhdGVnb3J5ID0gJ21ldGFsJwogICAgCiAgICAjIEdldCByZWFsIG1hcmtldCBkYXRh
IGZpcnN0CiAgICByZWFsX2RhdGEgPSBhd2FpdCByZWFsX21hcmtldF9kYXRhLmdldF9wcmljZShz
eW1ib2wsIGNhdGVnb3J5KQogICAgCiAgICBpZiByZWFsX2RhdGE6CiAgICAgICAgIyBHZXQgaGlz
dG9yaWNhbCBkYXRhIGZvciBpbmRpY2F0b3IgY2FsY3VsYXRpb24KICAgICAgICBoaXN0b3J5ID0g
YXdhaXQgcmVhbF9tYXJrZXRfZGF0YS5nZXRfaGlzdG9yaWNhbF9kYXRhKHN5bWJvbCwgY2F0ZWdv
cnksIHRpbWVmcmFtZSkKICAgICAgICBjdXJyZW50X3ByaWNlID0gcmVhbF9kYXRhWydwcmljZSdd
CiAgICBlbHNlOgogICAgICAgICMgRmFsbGJhY2sgdG8gc2ltdWxhdGVkIGRhdGEKICAgICAgICBo
aXN0b3J5ID0gbWFya2V0X3NpbXVsYXRvci5nZXRfcHJpY2VfaGlzdG9yeShzeW1ib2wsIDIwMCkK
ICAgICAgICBjdXJyZW50ID0gbWFya2V0X3NpbXVsYXRvci5nZXRfY3VycmVudF9wcmljZShzeW1i
b2wpCiAgICAgICAgY3VycmVudF9wcmljZSA9IGN1cnJlbnRbJ2JpZCddIGlmIGN1cnJlbnQgZWxz
ZSAwCiAgICAKICAgICMgQ2FsY3VsYXRlIGluZGljYXRvcnMKICAgIGNsb3NlcyA9IFtoWydjbG9z
ZSddIGZvciBoIGluIGhpc3RvcnldCiAgICAKICAgIHNpZ25hbCA9ICdORVVUUkFMJwogICAgaW5k
aWNhdG9yX3ZhbHVlID0gMAogICAgCiAgICBpZiBpbmRpY2F0b3IgPT0gJ1JTSScgYW5kIGxlbihj
bG9zZXMpID49IDE0OgogICAgICAgIHJzaV92YWx1ZXMgPSBUZWNobmljYWxJbmRpY2F0b3JzLmNh
bGN1bGF0ZV9yc2koY2xvc2VzLCBwZXJpb2Q9MTQpCiAgICAgICAgaWYgcnNpX3ZhbHVlczoKICAg
ICAgICAgICAgaW5kaWNhdG9yX3ZhbHVlID0gcnNpX3ZhbHVlc1stMV0KICAgICAgICAgICAgc2ln
bmFsID0gU2lnbmFsR2VuZXJhdG9yLnJzaV9zaWduYWwoaW5kaWNhdG9yX3ZhbHVlKQogICAgZWxp
ZiBpbmRpY2F0b3IgPT0gJ01BQ0QnIGFuZCBsZW4oY2xvc2VzKSA+PSAyNjoKICAgICAgICBtYWNk
X2xpbmUsIHNpZ25hbF9saW5lLCBoaXN0b2dyYW0gPSBUZWNobmljYWxJbmRpY2F0b3JzLmNhbGN1
bGF0ZV9tYWNkKGNsb3NlcykKICAgICAgICBpZiBtYWNkX2xpbmUgYW5kIHNpZ25hbF9saW5lOgog
ICAgICAgICAgICBpbmRpY2F0b3JfdmFsdWUgPSBoaXN0b2dyYW1bLTFdIGlmIGhpc3RvZ3JhbSBl
bHNlIDAKICAgICAgICAgICAgc2lnbmFsID0gU2lnbmFsR2VuZXJhdG9yLm1hY2Rfc2lnbmFsKG1h
Y2RfbGluZVstMV0sIHNpZ25hbF9saW5lWy0xXSkKICAgIGVsaWYgaW5kaWNhdG9yID09ICdNQV9D
Uk9TUycgYW5kIGxlbihjbG9zZXMpID49IDUwOgogICAgICAgIGZhc3RfbWEgPSBUZWNobmljYWxJ
bmRpY2F0b3JzLmNhbGN1bGF0ZV9zbWEoY2xvc2VzLCBwZXJpb2Q9MjApCiAgICAgICAgc2xvd19t
YSA9IFRlY2huaWNhbEluZGljYXRvcnMuY2FsY3VsYXRlX3NtYShjbG9zZXMsIHBlcmlvZD01MCkK
ICAgICAgICBpZiBmYXN0X21hIGFuZCBzbG93X21hOgogICAgICAgICAgICBzaWduYWwgPSBTaWdu
YWxHZW5lcmF0b3IubWFfY3Jvc3NvdmVyX3NpZ25hbChmYXN0X21hWy0yOl0sIHNsb3dfbWFbLTI6
XSkKICAgIGVsaWYgaW5kaWNhdG9yID09ICdCT0xMSU5HRVInIGFuZCBsZW4oY2xvc2VzKSA+PSAy
MDoKICAgICAgICB1cHBlciwgbWlkZGxlLCBsb3dlciA9IFRlY2huaWNhbEluZGljYXRvcnMuY2Fs
Y3VsYXRlX2JvbGxpbmdlcl9iYW5kcyhjbG9zZXMsIHBlcmlvZD0yMCkKICAgICAgICBpZiB1cHBl
ciBhbmQgbG93ZXI6CiAgICAgICAgICAgIGluZGljYXRvcl92YWx1ZSA9IGN1cnJlbnRfcHJpY2UK
ICAgICAgICAgICAgc2lnbmFsID0gU2lnbmFsR2VuZXJhdG9yLmJvbGxpbmdlcl9zaWduYWwoY3Vy
cmVudF9wcmljZSwgdXBwZXJbLTFdLCBtaWRkbGVbLTFdLCBsb3dlclstMV0pCiAgICAKICAgIHJl
dHVybiB7CiAgICAgICAgJ3N5bWJvbCc6IHN5bWJvbCwKICAgICAgICAnc2lnbmFsJzogc2lnbmFs
LAogICAgICAgICdpbmRpY2F0b3InOiBpbmRpY2F0b3IsCiAgICAgICAgJ2luZGljYXRvcl92YWx1
ZSc6IHJvdW5kKGluZGljYXRvcl92YWx1ZSwgMiksCiAgICAgICAgJ2N1cnJlbnRfcHJpY2UnOiBy
b3VuZChjdXJyZW50X3ByaWNlLCA1KSwKICAgICAgICAndGltZWZyYW1lJzogdGltZWZyYW1lLAog
ICAgICAgICdzb3VyY2UnOiAncmVhbCcgaWYgcmVhbF9kYXRhIGVsc2UgJ3NpbXVsYXRlZCcsCiAg
ICAgICAgJ3RpbWVzdGFtcCc6IGRhdGV0aW1lLnV0Y25vdygpLmlzb2Zvcm1hdCgpCiAgICB9Cgoj
ID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT0KIyBQQVlNRU5UIEVORFBPSU5UUwojID09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT0KCiMgUHlkYW50aWMgbW9kZWxzIGZvciBwYXltZW50CmNsYXNzIENyZWF0ZUNoZWNrb3V0
UmVxdWVzdChCYXNlTW9kZWwpOgogICAgb3JpZ2luX3VybDogc3RyID0gRmllbGQoLi4uLCBkZXNj
cmlwdGlvbj0iRnJvbnRlbmQgb3JpZ2luIFVSTCBmb3Igc3VjY2Vzcy9jYW5jZWwgcmVkaXJlY3Rz
IikKCmNsYXNzIFBheW1lbnRTdGF0dXNSZXNwb25zZShCYXNlTW9kZWwpOgogICAgcGF5bWVudF9z
dGF0dXM6IHN0cgogICAgdXNlcl9pZDogT3B0aW9uYWxbc3RyXSA9IE5vbmUKICAgIGFtb3VudDog
T3B0aW9uYWxbZmxvYXRdID0gTm9uZQogICAgcGF5bWVudF9pbnRlbnRfaWQ6IHN0cgoKIyBJbml0
aWFsaXplIFN0cmlwZSBjbGllbnQKc3RyaXBlX2FwaV9rZXkgPSBvcy5nZXRlbnYoIlNUUklQRV9B
UElfS0VZIikKCkBhcGlfcm91dGVyLnBvc3QoIi9wYXltZW50L2NyZWF0ZS1jaGVja291dCIpCmFz
eW5jIGRlZiBjcmVhdGVfcGF5bWVudF9jaGVja291dCgKICAgIHJlcXVlc3Q6IENyZWF0ZUNoZWNr
b3V0UmVxdWVzdCwKICAgIHVzZXI6IGRpY3QgPSBEZXBlbmRzKGdldF9jdXJyZW50X3VzZXJfZm9y
X3BheW1lbnQpCik6CiAgICAiIiIKICAgIENyZWF0ZSBhIFN0cmlwZSBjaGVja291dCBzZXNzaW9u
IGZvciByZWRpcmVjdCBwYXltZW50LgogICAgVXNlciBwcmljZTogJDM1IFVTRAogICAgIiIiCiAg
ICB0cnk6CiAgICAgICAgdXNlcl9pZCA9IHVzZXJbJ19pZCddCiAgICAgICAgdXNlcl9lbWFpbCA9
IHVzZXIuZ2V0KCdlbWFpbCcsICcnKQogICAgICAgIAogICAgICAgICMgQ2hlY2sgaWYgdXNlciBh
bHJlYWR5IHBhaWQKICAgICAgICBpZiB1c2VyLmdldCgncGF5bWVudF9zdGF0dXMnKSA9PSAncGFp
ZCc6CiAgICAgICAgICAgIHJhaXNlIEhUVFBFeGNlcHRpb24oc3RhdHVzX2NvZGU9NDAwLCBkZXRh
aWw9IlBheW1lbnQgYWxyZWFkeSBjb21wbGV0ZWQgZm9yIHRoaXMgdXNlciIpCiAgICAgICAgCiAg
ICAgICAgZXhpc3RpbmdfcGF5bWVudCA9IGF3YWl0IGRiLnBheW1lbnRfdHJhbnNhY3Rpb25zLmZp
bmRfb25lKHsKICAgICAgICAgICAgInVzZXJfaWQiOiB1c2VyX2lkLAogICAgICAgICAgICAicGF5
bWVudF9zdGF0dXMiOiAicGFpZCIKICAgICAgICB9KQogICAgICAgIAogICAgICAgIGlmIGV4aXN0
aW5nX3BheW1lbnQ6CiAgICAgICAgICAgIHJhaXNlIEhUVFBFeGNlcHRpb24oc3RhdHVzX2NvZGU9
NDAwLCBkZXRhaWw9IlBheW1lbnQgYWxyZWFkeSBjb21wbGV0ZWQgZm9yIHRoaXMgdXNlciIpCiAg
ICAgICAgCiAgICAgICAgIyBJbml0aWFsaXplIFN0cmlwZSBjaGVja291dAogICAgICAgIGhvc3Rf
dXJsID0gcmVxdWVzdC5vcmlnaW5fdXJsCiAgICAgICAgd2ViaG9va191cmwgPSBmIntob3N0X3Vy
bH0vYXBpL3dlYmhvb2svc3RyaXBlIgogICAgICAgIHN0cmlwZV9jaGVja291dCA9IFN0cmlwZUNo
ZWNrb3V0KGFwaV9rZXk9c3RyaXBlX2FwaV9rZXksIHdlYmhvb2tfdXJsPXdlYmhvb2tfdXJsKQog
ICAgICAgIAogICAgICAgICMgQnVpbGQgc3VjY2VzcyBhbmQgY2FuY2VsIFVSTHMKICAgICAgICBz
dWNjZXNzX3VybCA9IGYie2hvc3RfdXJsfS93YWl0aW5nLWFwcHJvdmFsP3Nlc3Npb25faWQ9e3tD
SEVDS09VVF9TRVNTSU9OX0lEfX0iCiAgICAgICAgY2FuY2VsX3VybCA9IGYie2hvc3RfdXJsfS9w
YXltZW50LWNhbmNlbCIKICAgICAgICAKICAgICAgICAjIEZpeGVkIHByaWNlOiAkMzUgVVNECiAg
ICAgICAgYW1vdW50ID0gMzUuMDAKICAgICAgICBjdXJyZW5jeSA9ICJ1c2QiCiAgICAgICAgCiAg
ICAgICAgIyBDcmVhdGUgY2hlY2tvdXQgc2Vzc2lvbgogICAgICAgIGNoZWNrb3V0X3JlcXVlc3Qg
PSBDaGVja291dFNlc3Npb25SZXF1ZXN0KAogICAgICAgICAgICBhbW91bnQ9YW1vdW50LAogICAg
ICAgICAgICBjdXJyZW5jeT1jdXJyZW5jeSwKICAgICAgICAgICAgc3VjY2Vzc191cmw9c3VjY2Vz
c191cmwsCiAgICAgICAgICAgIGNhbmNlbF91cmw9Y2FuY2VsX3VybCwKICAgICAgICAgICAgbWV0
YWRhdGE9ewogICAgICAgICAgICAgICAgInVzZXJfaWQiOiBzdHIodXNlcl9pZCksCiAgICAgICAg
ICAgICAgICAidXNlcl9lbWFpbCI6IHVzZXJfZW1haWwsCiAgICAgICAgICAgICAgICAicHJvZHVj
dCI6ICJsaWZldGltZV9hY2Nlc3MiCiAgICAgICAgICAgIH0KICAgICAgICApCiAgICAgICAgCiAg
ICAgICAgc2Vzc2lvbjogQ2hlY2tvdXRTZXNzaW9uUmVzcG9uc2UgPSBhd2FpdCBzdHJpcGVfY2hl
Y2tvdXQuY3JlYXRlX2NoZWNrb3V0X3Nlc3Npb24oY2hlY2tvdXRfcmVxdWVzdCkKICAgICAgICAK
ICAgICAgICAjIFN0b3JlIHRyYW5zYWN0aW9uIGluIGRhdGFiYXNlCiAgICAgICAgdHJhbnNhY3Rp
b25fZGF0YSA9IHsKICAgICAgICAgICAgInNlc3Npb25faWQiOiBzZXNzaW9uLnNlc3Npb25faWQs
CiAgICAgICAgICAgICJ1c2VyX2lkIjogc3RyKHVzZXJfaWQpLAogICAgICAgICAgICAidXNlcl9l
bWFpbCI6IHVzZXJfZW1haWwsCiAgICAgICAgICAgICJhbW91bnQiOiBhbW91bnQsCiAgICAgICAg
ICAgICJjdXJyZW5jeSI6IGN1cnJlbmN5LAogICAgICAgICAgICAicGF5bWVudF9zdGF0dXMiOiAi
cGVuZGluZyIsCiAgICAgICAgICAgICJzdHJpcGVfc3RhdHVzIjogImluaXRpYXRlZCIsCiAgICAg
ICAgICAgICJtZXRhZGF0YSI6IHsKICAgICAgICAgICAgICAgICJ1c2VyX2lkIjogc3RyKHVzZXJf
aWQpLAogICAgICAgICAgICAgICAgInVzZXJfZW1haWwiOiB1c2VyX2VtYWlsLAogICAgICAgICAg
ICAgICAgInByb2R1Y3QiOiAibGlmZXRpbWVfYWNjZXNzIgogICAgICAgICAgICB9LAogICAgICAg
ICAgICAiY3JlYXRlZF9hdCI6IGRhdGV0aW1lLnV0Y25vdygpLAogICAgICAgICAgICAidXBkYXRl
ZF9hdCI6IGRhdGV0aW1lLnV0Y25vdygpCiAgICAgICAgfQogICAgICAgIAogICAgICAgIGF3YWl0
IGRiLnBheW1lbnRfdHJhbnNhY3Rpb25zLmluc2VydF9vbmUodHJhbnNhY3Rpb25fZGF0YSkKICAg
ICAgICAKICAgICAgICBsb2dnZXIuaW5mbyhmIlBheW1lbnQgY2hlY2tvdXQgY3JlYXRlZCBmb3Ig
dXNlciB7dXNlcl9pZH06IHNlc3Npb24ge3Nlc3Npb24uc2Vzc2lvbl9pZH0iKQogICAgICAgIAog
ICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICJ1cmwiOiBzZXNzaW9uLnVybCwKICAgICAgICAg
ICAgInNlc3Npb25faWQiOiBzZXNzaW9uLnNlc3Npb25faWQKICAgICAgICB9CiAgICAgICAgCiAg
ICBleGNlcHQgSFRUUEV4Y2VwdGlvbjoKICAgICAgICByYWlzZQogICAgZXhjZXB0IEV4Y2VwdGlv
biBhcyBlOgogICAgICAgIGxvZ2dlci5lcnJvcihmIkVycm9yIGNyZWF0aW5nIGNoZWNrb3V0IHNl
c3Npb246IHtzdHIoZSl9IikKICAgICAgICByYWlzZSBIVFRQRXhjZXB0aW9uKHN0YXR1c19jb2Rl
PTUwMCwgZGV0YWlsPWYiRmFpbGVkIHRvIGNyZWF0ZSBjaGVja291dCBzZXNzaW9uOiB7c3RyKGUp
fSIpCgpAYXBpX3JvdXRlci5nZXQoIi9wYXltZW50L3N0YXR1cy97c2Vzc2lvbl9pZH0iKQphc3lu
YyBkZWYgZ2V0X3BheW1lbnRfc3RhdHVzKAogICAgc2Vzc2lvbl9pZDogc3RyLAogICAgdXNlcjog
ZGljdCA9IERlcGVuZHMoZ2V0X2N1cnJlbnRfdXNlcl9mb3JfcGF5bWVudCkKKToKICAgICIiIgog
ICAgR2V0IHBheW1lbnQgc3RhdHVzIGZvciBhIENoZWNrb3V0IFNlc3Npb24gYW5kIHVwZGF0ZSBk
YXRhYmFzZS4KICAgIFN1cHBvcnRzIGJvdGggc2Vzc2lvbl9pZCAoZnJvbSBjaGVja291dCkgYW5k
IHBheW1lbnRfaW50ZW50X2lkLgogICAgIiIiCiAgICB0cnk6CiAgICAgICAgaW1wb3J0IHN0cmlw
ZQogICAgICAgIHN0cmlwZS5hcGlfa2V5ID0gc3RyaXBlX2FwaV9rZXkKICAgICAgICAKICAgICAg
ICB1c2VyX2lkID0gdXNlclsnX2lkJ10KICAgICAgICAKICAgICAgICAjIFRyeSB0byBmaW5kIHRy
YW5zYWN0aW9uIGJ5IHNlc3Npb25faWQgZmlyc3QgKG5ldyBjaGVja291dCBmbG93KQogICAgICAg
IHRyYW5zYWN0aW9uID0gYXdhaXQgZGIucGF5bWVudF90cmFuc2FjdGlvbnMuZmluZF9vbmUoewog
ICAgICAgICAgICAic2Vzc2lvbl9pZCI6IHNlc3Npb25faWQsCiAgICAgICAgICAgICJ1c2VyX2lk
Ijogc3RyKHVzZXJfaWQpCiAgICAgICAgfSkKICAgICAgICAKICAgICAgICAjIElmIG5vdCBmb3Vu
ZCwgdHJ5IHBheW1lbnRfaW50ZW50X2lkIChiYWNrd2FyZHMgY29tcGF0aWJpbGl0eSkKICAgICAg
ICBpZiBub3QgdHJhbnNhY3Rpb246CiAgICAgICAgICAgIHRyYW5zYWN0aW9uID0gYXdhaXQgZGIu
cGF5bWVudF90cmFuc2FjdGlvbnMuZmluZF9vbmUoewogICAgICAgICAgICAgICAgInBheW1lbnRf
aW50ZW50X2lkIjogc2Vzc2lvbl9pZCwKICAgICAgICAgICAgICAgICJ1c2VyX2lkIjogc3RyKHVz
ZXJfaWQpCiAgICAgICAgICAgIH0pCiAgICAgICAgCiAgICAgICAgaWYgbm90IHRyYW5zYWN0aW9u
OgogICAgICAgICAgICByYWlzZSBIVFRQRXhjZXB0aW9uKHN0YXR1c19jb2RlPTQwNCwgZGV0YWls
PSJQYXltZW50IHNlc3Npb24gbm90IGZvdW5kIikKICAgICAgICAKICAgICAgICAjIElmIGFscmVh
ZHkgbWFya2VkIGFzIHBhaWQsIHJldHVybiBzdWNjZXNzCiAgICAgICAgaWYgdHJhbnNhY3Rpb24u
Z2V0KCdwYXltZW50X3N0YXR1cycpID09ICdwYWlkJzoKICAgICAgICAgICAgcmV0dXJuIFBheW1l
bnRTdGF0dXNSZXNwb25zZSgKICAgICAgICAgICAgICAgIHBheW1lbnRfc3RhdHVzPSJwYWlkIiwK
ICAgICAgICAgICAgICAgIHVzZXJfaWQ9c3RyKHVzZXJfaWQpLAogICAgICAgICAgICAgICAgYW1v
dW50PXRyYW5zYWN0aW9uLmdldCgnYW1vdW50JyksCiAgICAgICAgICAgICAgICBwYXltZW50X2lu
dGVudF9pZD1zZXNzaW9uX2lkCiAgICAgICAgICAgICkKICAgICAgICAKICAgICAgICAjIERldGVy
bWluZSBpZiB0aGlzIGlzIGEgc2Vzc2lvbl9pZCBvciBwYXltZW50X2ludGVudF9pZAogICAgICAg
IGlzX3Nlc3Npb24gPSBzZXNzaW9uX2lkLnN0YXJ0c3dpdGgoJ2NzXycpCiAgICAgICAgcGF5bWVu
dF9zdGF0dXMgPSAicGVuZGluZyIKICAgICAgICBzdHJpcGVfc3RhdHVzID0gInBlbmRpbmciCiAg
ICAgICAgCiAgICAgICAgaWYgaXNfc2Vzc2lvbjoKICAgICAgICAgICAgIyBHZXQgc3RhdHVzIGZy
b20gU3RyaXBlIENoZWNrb3V0IFNlc3Npb24KICAgICAgICAgICAgY2hlY2tvdXRfc2Vzc2lvbiA9
IHN0cmlwZS5jaGVja291dC5TZXNzaW9uLnJldHJpZXZlKHNlc3Npb25faWQpCiAgICAgICAgICAg
IHN0cmlwZV9zdGF0dXMgPSBjaGVja291dF9zZXNzaW9uLnBheW1lbnRfc3RhdHVzICAjICdwYWlk
JywgJ3VucGFpZCcsICdub19wYXltZW50X3JlcXVpcmVkJwogICAgICAgICAgICAKICAgICAgICAg
ICAgIyBNYXAgU3RyaXBlIHN0YXR1cyB0byBvdXIgcGF5bWVudCBzdGF0dXMKICAgICAgICAgICAg
aWYgc3RyaXBlX3N0YXR1cyA9PSAicGFpZCI6CiAgICAgICAgICAgICAgICBwYXltZW50X3N0YXR1
cyA9ICJwYWlkIgogICAgICAgICAgICBlbGlmIGNoZWNrb3V0X3Nlc3Npb24uc3RhdHVzID09ICJl
eHBpcmVkIjoKICAgICAgICAgICAgICAgIHBheW1lbnRfc3RhdHVzID0gImZhaWxlZCIKICAgICAg
ICBlbHNlOgogICAgICAgICAgICAjIEdldCBzdGF0dXMgZnJvbSBTdHJpcGUgUGF5bWVudCBJbnRl
bnQgKGJhY2t3YXJkcyBjb21wYXRpYmlsaXR5KQogICAgICAgICAgICBwYXltZW50X2ludGVudCA9
IHN0cmlwZS5QYXltZW50SW50ZW50LnJldHJpZXZlKHNlc3Npb25faWQpCiAgICAgICAgICAgIHN0
cmlwZV9zdGF0dXMgPSBwYXltZW50X2ludGVudC5zdGF0dXMKICAgICAgICAgICAgCiAgICAgICAg
ICAgIGlmIHBheW1lbnRfaW50ZW50LnN0YXR1cyA9PSAic3VjY2VlZGVkIjoKICAgICAgICAgICAg
ICAgIHBheW1lbnRfc3RhdHVzID0gInBhaWQiCiAgICAgICAgICAgIGVsaWYgcGF5bWVudF9pbnRl
bnQuc3RhdHVzIGluIFsiY2FuY2VsZWQiLCAicGF5bWVudF9mYWlsZWQiXToKICAgICAgICAgICAg
ICAgIHBheW1lbnRfc3RhdHVzID0gImZhaWxlZCIKICAgICAgICAKICAgICAgICAjIFVwZGF0ZSB0
cmFuc2FjdGlvbiBpbiBkYXRhYmFzZQogICAgICAgIHVwZGF0ZV9kYXRhID0gewogICAgICAgICAg
ICAic3RyaXBlX3N0YXR1cyI6IHN0cmlwZV9zdGF0dXMsCiAgICAgICAgICAgICJwYXltZW50X3N0
YXR1cyI6IHBheW1lbnRfc3RhdHVzLAogICAgICAgICAgICAidXBkYXRlZF9hdCI6IGRhdGV0aW1l
LnV0Y25vdygpCiAgICAgICAgfQogICAgICAgIAogICAgICAgIGF3YWl0IGRiLnBheW1lbnRfdHJh
bnNhY3Rpb25zLnVwZGF0ZV9vbmUoCiAgICAgICAgICAgIHsiX2lkIjogdHJhbnNhY3Rpb25bIl9p
ZCJdfSwKICAgICAgICAgICAgeyIkc2V0IjogdXBkYXRlX2RhdGF9CiAgICAgICAgKQogICAgICAg
IAogICAgICAgICMgSWYgcGF5bWVudCBpcyBjb21wbGV0ZSwgdXBkYXRlIHVzZXIgcmVjb3JkIGFu
ZCBhdXRvbWF0aWNhbGx5IGdyYW50IGFjY2VzcwogICAgICAgIGlmIHBheW1lbnRfc3RhdHVzID09
ICJwYWlkIjoKICAgICAgICAgICAgYXdhaXQgZGIudXNlcnMudXBkYXRlX29uZSgKICAgICAgICAg
ICAgICAgIHsiX2lkIjogT2JqZWN0SWQodXNlcl9pZCl9LAogICAgICAgICAgICAgICAgewogICAg
ICAgICAgICAgICAgICAgICIkc2V0IjogewogICAgICAgICAgICAgICAgICAgICAgICAicGF5bWVu
dF9zdGF0dXMiOiAicGFpZCIsCiAgICAgICAgICAgICAgICAgICAgICAgICJwYXltZW50X2RhdGUi
OiBkYXRldGltZS51dGNub3coKSwKICAgICAgICAgICAgICAgICAgICAgICAgInN0YXR1cyI6ICJh
Y3RpdmUiICAjIEF1dG9tYXRpY2FsbHkgYWN0aXZhdGUgdXNlciBhZnRlciBwYXltZW50CiAgICAg
ICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICApCiAgICAgICAg
ICAgIGxvZ2dlci5pbmZvKGYi4pyFIFBheW1lbnQgY29tcGxldGVkIGZvciB1c2VyIHt1c2VyX2lk
fSAtIEF1dG9tYXRpY2FsbHkgYWN0aXZhdGVkIHdpdGggZnVsbCBhY2Nlc3MiKQogICAgICAgIAog
ICAgICAgIHJldHVybiBQYXltZW50U3RhdHVzUmVzcG9uc2UoCiAgICAgICAgICAgIHBheW1lbnRf
c3RhdHVzPXBheW1lbnRfc3RhdHVzLAogICAgICAgICAgICB1c2VyX2lkPXN0cih1c2VyX2lkKSwK
ICAgICAgICAgICAgYW1vdW50PXRyYW5zYWN0aW9uLmdldCgnYW1vdW50JyksCiAgICAgICAgICAg
IHBheW1lbnRfaW50ZW50X2lkPXNlc3Npb25faWQKICAgICAgICApCiAgICAgICAgCiAgICBleGNl
cHQgSFRUUEV4Y2VwdGlvbjoKICAgICAgICByYWlzZQogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBl
OgogICAgICAgIGxvZ2dlci5lcnJvcihmIkVycm9yIGNoZWNraW5nIHBheW1lbnQgc3RhdHVzOiB7
c3RyKGUpfSIpCiAgICAgICAgcmFpc2UgSFRUUEV4Y2VwdGlvbihzdGF0dXNfY29kZT01MDAsIGRl
dGFpbD1mIkZhaWxlZCB0byBjaGVjayBwYXltZW50IHN0YXR1czoge3N0cihlKX0iKQoKQGFwaV9y
b3V0ZXIucG9zdCgiL3dlYmhvb2svc3RyaXBlIikKYXN5bmMgZGVmIHN0cmlwZV93ZWJob29rKHJl
cXVlc3Q6IFJlcXVlc3QpOgogICAgIiIiCiAgICBIYW5kbGUgU3RyaXBlIHdlYmhvb2sgZXZlbnRz
IGZvciBQYXltZW50IEludGVudCB1cGRhdGVzLgogICAgIiIiCiAgICB0cnk6CiAgICAgICAgaW1w
b3J0IHN0cmlwZQogICAgICAgIHN0cmlwZS5hcGlfa2V5ID0gc3RyaXBlX2FwaV9rZXkKICAgICAg
ICAKICAgICAgICBib2R5ID0gYXdhaXQgcmVxdWVzdC5ib2R5KCkKICAgICAgICBzaWduYXR1cmUg
PSByZXF1ZXN0LmhlYWRlcnMuZ2V0KCJTdHJpcGUtU2lnbmF0dXJlIikKICAgICAgICAKICAgICAg
ICAjIEdldCB3ZWJob29rIGVuZHBvaW50IHNlY3JldCBmcm9tIGVudmlyb25tZW50CiAgICAgICAg
d2ViaG9va19zZWNyZXQgPSBvcy5nZXRlbnYoIlNUUklQRV9XRUJIT09LX1NFQ1JFVCIpCiAgICAg
ICAgaWYgbm90IHdlYmhvb2tfc2VjcmV0OgogICAgICAgICAgICBsb2dnZXIuZXJyb3IoIlNUUklQ
RV9XRUJIT09LX1NFQ1JFVCBub3QgY29uZmlndXJlZCIpCiAgICAgICAgICAgIHJhaXNlIEhUVFBF
eGNlcHRpb24oc3RhdHVzX2NvZGU9NTAwLCBkZXRhaWw9IldlYmhvb2sgc2VjcmV0IG5vdCBjb25m
aWd1cmVkIikKICAgICAgICAKICAgICAgICAjIFZlcmlmeSB3ZWJob29rIHNpZ25hdHVyZQogICAg
ICAgIHRyeToKICAgICAgICAgICAgZXZlbnQgPSBzdHJpcGUuV2ViaG9vay5jb25zdHJ1Y3RfZXZl
bnQoCiAgICAgICAgICAgICAgICBib2R5LCBzaWduYXR1cmUsIHdlYmhvb2tfc2VjcmV0CiAgICAg
ICAgICAgICkKICAgICAgICBleGNlcHQgVmFsdWVFcnJvciBhcyBlOgogICAgICAgICAgICBsb2dn
ZXIuZXJyb3IoZiJJbnZhbGlkIHBheWxvYWQ6IHtlfSIpCiAgICAgICAgICAgIHJhaXNlIEhUVFBF
eGNlcHRpb24oc3RhdHVzX2NvZGU9NDAwLCBkZXRhaWw9IkludmFsaWQgcGF5bG9hZCIpCiAgICAg
ICAgZXhjZXB0IHN0cmlwZS5lcnJvci5TaWduYXR1cmVWZXJpZmljYXRpb25FcnJvciBhcyBlOgog
ICAgICAgICAgICBsb2dnZXIuZXJyb3IoZiJJbnZhbGlkIHNpZ25hdHVyZToge2V9IikKICAgICAg
ICAgICAgcmFpc2UgSFRUUEV4Y2VwdGlvbihzdGF0dXNfY29kZT00MDAsIGRldGFpbD0iSW52YWxp
ZCBzaWduYXR1cmUiKQogICAgICAgIAogICAgICAgIGxvZ2dlci5pbmZvKGYiV2ViaG9vayByZWNl
aXZlZDoge2V2ZW50Wyd0eXBlJ119IikKICAgICAgICAKICAgICAgICAjIEhhbmRsZSBjaGVja291
dC5zZXNzaW9uLmNvbXBsZXRlZCBldmVudCAod2hlbiB1c2luZyBDaGVja291dCBTZXNzaW9ucykK
ICAgICAgICBpZiBldmVudFsndHlwZSddID09ICdjaGVja291dC5zZXNzaW9uLmNvbXBsZXRlZCc6
CiAgICAgICAgICAgIHNlc3Npb24gPSBldmVudFsnZGF0YSddWydvYmplY3QnXQogICAgICAgICAg
ICBzZXNzaW9uX2lkID0gc2Vzc2lvblsnaWQnXQogICAgICAgICAgICBwYXltZW50X3N0YXR1c19z
dHJpcGUgPSBzZXNzaW9uLmdldCgncGF5bWVudF9zdGF0dXMnKSAgIyAncGFpZCcgb3IgJ3VucGFp
ZCcKICAgICAgICAgICAgCiAgICAgICAgICAgIGxvZ2dlci5pbmZvKGYiQ2hlY2tvdXQgc2Vzc2lv
biBjb21wbGV0ZWQ6IHtzZXNzaW9uX2lkfSwgcGF5bWVudF9zdGF0dXM6IHtwYXltZW50X3N0YXR1
c19zdHJpcGV9IikKICAgICAgICAgICAgCiAgICAgICAgICAgICMgRmluZCB0cmFuc2FjdGlvbiBi
eSBzZXNzaW9uX2lkCiAgICAgICAgICAgIHRyYW5zYWN0aW9uID0gYXdhaXQgZGIucGF5bWVudF90
cmFuc2FjdGlvbnMuZmluZF9vbmUoewogICAgICAgICAgICAgICAgInNlc3Npb25faWQiOiBzZXNz
aW9uX2lkCiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIAogICAgICAgICAgICBpZiB0cmFuc2Fj
dGlvbiBhbmQgcGF5bWVudF9zdGF0dXNfc3RyaXBlID09ICdwYWlkJzoKICAgICAgICAgICAgICAg
ICMgVXBkYXRlIHRyYW5zYWN0aW9uCiAgICAgICAgICAgICAgICBhd2FpdCBkYi5wYXltZW50X3Ry
YW5zYWN0aW9ucy51cGRhdGVfb25lKAogICAgICAgICAgICAgICAgICAgIHsic2Vzc2lvbl9pZCI6
IHNlc3Npb25faWR9LAogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAg
ICAgIiRzZXQiOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAicGF5bWVudF9zdGF0dXMi
OiAicGFpZCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAic3RyaXBlX3N0YXR1cyI6ICJj
b21wbGV0ZSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAicGF5bWVudF9pbnRlbnRfaWQi
OiBzZXNzaW9uLmdldCgncGF5bWVudF9pbnRlbnQnKSwgICMgU3RvcmUgcGF5bWVudCBpbnRlbnQg
SUQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ1cGRhdGVkX2F0IjogZGF0ZXRpbWUudXRj
bm93KCkKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAg
ICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgIyBVcGRhdGUg
dXNlciAtIGF1dG9tYXRpY2FsbHkgZ3JhbnQgYWNjZXNzIGFmdGVyIHN1Y2Nlc3NmdWwgcGF5bWVu
dAogICAgICAgICAgICAgICAgdXNlcl9pZCA9IHRyYW5zYWN0aW9uLmdldCgndXNlcl9pZCcpCiAg
ICAgICAgICAgICAgICBpZiB1c2VyX2lkOgogICAgICAgICAgICAgICAgICAgIGF3YWl0IGRiLnVz
ZXJzLnVwZGF0ZV9vbmUoCiAgICAgICAgICAgICAgICAgICAgICAgIHsiX2lkIjogT2JqZWN0SWQo
dXNlcl9pZCl9LAogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAiJHNldCI6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAicGF5bWVu
dF9zdGF0dXMiOiAicGFpZCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInBheW1l
bnRfZGF0ZSI6IGRhdGV0aW1lLnV0Y25vdygpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICJzdGF0dXMiOiAiYWN0aXZlIiAgIyBBdXRvbWF0aWNhbGx5IGFjdGl2YXRlIHVzZXIgYWZ0
ZXIgcGF5bWVudAogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAg
ICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgIGxvZ2dl
ci5pbmZvKGYi4pyFIENoZWNrb3V0IGNvbXBsZXRlZCAtIFVzZXIge3VzZXJfaWR9IGF1dG9tYXRp
Y2FsbHkgYWN0aXZhdGVkIHdpdGggZnVsbCBhY2Nlc3MiKQogICAgICAgICAgICAgICAgICAgIGxv
Z2dlci5pbmZvKGYi4pyFIFBheW1lbnQgc3VjY2Vzc2Z1bCAtIFVzZXIge3VzZXJfaWR9IGF1dG9t
YXRpY2FsbHkgYWN0aXZhdGVkIHdpdGggZnVsbCBhY2Nlc3MiKQogICAgICAgIAogICAgICAgICMg
QWxzbyBoYW5kbGUgcGF5bWVudF9pbnRlbnQuc3VjY2VlZGVkIGZvciBiYWNrd2FyZHMgY29tcGF0
aWJpbGl0eQogICAgICAgIGVsaWYgZXZlbnRbJ3R5cGUnXSA9PSAncGF5bWVudF9pbnRlbnQuc3Vj
Y2VlZGVkJzoKICAgICAgICAgICAgcGF5bWVudF9pbnRlbnQgPSBldmVudFsnZGF0YSddWydvYmpl
Y3QnXQogICAgICAgICAgICBwYXltZW50X2ludGVudF9pZCA9IHBheW1lbnRfaW50ZW50WydpZCdd
CiAgICAgICAgICAgIAogICAgICAgICAgICBsb2dnZXIuaW5mbyhmIlBheW1lbnQgaW50ZW50IHN1
Y2NlZWRlZDoge3BheW1lbnRfaW50ZW50X2lkfSIpCiAgICAgICAgICAgIAogICAgICAgICAgICAj
IEZpbmQgdHJhbnNhY3Rpb24gYnkgcGF5bWVudF9pbnRlbnRfaWQKICAgICAgICAgICAgdHJhbnNh
Y3Rpb24gPSBhd2FpdCBkYi5wYXltZW50X3RyYW5zYWN0aW9ucy5maW5kX29uZSh7CiAgICAgICAg
ICAgICAgICAicGF5bWVudF9pbnRlbnRfaWQiOiBwYXltZW50X2ludGVudF9pZAogICAgICAgICAg
ICB9KQogICAgICAgICAgICAKICAgICAgICAgICAgaWYgdHJhbnNhY3Rpb24gYW5kIHRyYW5zYWN0
aW9uLmdldCgncGF5bWVudF9zdGF0dXMnKSAhPSAncGFpZCc6CiAgICAgICAgICAgICAgICAjIFVw
ZGF0ZSB0cmFuc2FjdGlvbgogICAgICAgICAgICAgICAgYXdhaXQgZGIucGF5bWVudF90cmFuc2Fj
dGlvbnMudXBkYXRlX29uZSgKICAgICAgICAgICAgICAgICAgICB7InBheW1lbnRfaW50ZW50X2lk
IjogcGF5bWVudF9pbnRlbnRfaWR9LAogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAg
ICAgICAgICAgICAgIiRzZXQiOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAicGF5bWVu
dF9zdGF0dXMiOiAicGFpZCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAic3RyaXBlX3N0
YXR1cyI6ICJjb21wbGV0ZSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAidXBkYXRlZF9h
dCI6IGRhdGV0aW1lLnV0Y25vdygpCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAg
ICAgICAgICAgICB9CiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAKICAgICAgICAg
ICAgICAgICMgVXBkYXRlIHVzZXIgLSBhdXRvbWF0aWNhbGx5IGdyYW50IGFjY2VzcyBhZnRlciBz
dWNjZXNzZnVsIHBheW1lbnQKICAgICAgICAgICAgICAgIHVzZXJfaWQgPSB0cmFuc2FjdGlvbi5n
ZXQoJ3VzZXJfaWQnKQogICAgICAgICAgICAgICAgaWYgdXNlcl9pZDoKICAgICAgICAgICAgICAg
ICAgICBhd2FpdCBkYi51c2Vycy51cGRhdGVfb25lKAogICAgICAgICAgICAgICAgICAgICAgICB7
Il9pZCI6IE9iamVjdElkKHVzZXJfaWQpfSwKICAgICAgICAgICAgICAgICAgICAgICAgewogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIiRzZXQiOiB7CiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgInBheW1lbnRfc3RhdHVzIjogInBhaWQiLAogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICJwYXltZW50X2RhdGUiOiBkYXRldGltZS51dGNub3coKSwKICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAic3RhdHVzIjogImFjdGl2ZSIgICMgQXV0b21hdGljYWxseSBh
Y3RpdmF0ZSB1c2VyIGFmdGVyIHBheW1lbnQKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0K
ICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICkKICAgICAgICAg
ICAgICAgICAgICBsb2dnZXIuaW5mbyhmIuKchSBQYXltZW50IHN1Y2Nlc3NmdWwgLSBVc2VyIHt1
c2VyX2lkfSBhdXRvbWF0aWNhbGx5IGFjdGl2YXRlZCB3aXRoIGZ1bGwgYWNjZXNzIikKICAgICAg
ICAKICAgICAgICByZXR1cm4geyJzdGF0dXMiOiAic3VjY2VzcyJ9CiAgICAgICAgCiAgICBleGNl
cHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgbG9nZ2VyLmVycm9yKGYiRXJyb3IgcHJvY2Vzc2lu
ZyB3ZWJob29rOiB7c3RyKGUpfSIpCiAgICAgICAgcmFpc2UgSFRUUEV4Y2VwdGlvbihzdGF0dXNf
Y29kZT01MDAsIGRldGFpbD1mIldlYmhvb2sgcHJvY2Vzc2luZyBmYWlsZWQ6IHtzdHIoZSl9IikK
CkBhcGlfcm91dGVyLmdldCgiL3VzZXIvcGF5bWVudC1zdGF0dXMiKQphc3luYyBkZWYgZ2V0X3Vz
ZXJfcGF5bWVudF9zdGF0dXModXNlcjogZGljdCA9IERlcGVuZHMoZ2V0X2N1cnJlbnRfdXNlcikp
OgogICAgIiIiCiAgICBDaGVjayBpZiBjdXJyZW50IHVzZXIgaGFzIGNvbXBsZXRlZCBwYXltZW50
LgogICAgIiIiCiAgICBwYXltZW50X3N0YXR1cyA9IHVzZXIuZ2V0KCdwYXltZW50X3N0YXR1cycs
ICd1bnBhaWQnKQogICAgcGF5bWVudF9kYXRlID0gdXNlci5nZXQoJ3BheW1lbnRfZGF0ZScpCiAg
ICAKICAgIHJldHVybiB7CiAgICAgICAgInBheW1lbnRfc3RhdHVzIjogcGF5bWVudF9zdGF0dXMs
CiAgICAgICAgInBheW1lbnRfZGF0ZSI6IHBheW1lbnRfZGF0ZS5pc29mb3JtYXQoKSBpZiBwYXlt
ZW50X2RhdGUgYW5kIGhhc2F0dHIocGF5bWVudF9kYXRlLCAnaXNvZm9ybWF0JykgZWxzZSBzdHIo
cGF5bWVudF9kYXRlKSBpZiBwYXltZW50X2RhdGUgZWxzZSBOb25lLAogICAgICAgICJyZXF1aXJl
c19wYXltZW50IjogcGF5bWVudF9zdGF0dXMgIT0gJ3BhaWQnCiAgICB9CgojIEhlYWx0aCBjaGVj
awpAYXBpX3JvdXRlci5nZXQoIi8iKQoKCiMgPT09PT09PT09PT09PT09PT09PT0gTUFOVUFMIFNJ
R05BTCBTRU5ESU5HID09PT09PT09PT09PT09PT09PT09CgpAYXBpX3JvdXRlci5wb3N0KCIvYWRt
aW4vc2VuZC1zaWduYWwiKQphc3luYyBkZWYgYWRtaW5fc2VuZF9zaWduYWwoc2lnbmFsOiBNYW51
YWxTaWduYWwsIGN1cnJlbnRfYWRtaW4gPSBEZXBlbmRzKGdldF9jdXJyZW50X2FkbWluKSk6CiAg
ICAiIiIKICAgIEFkbWluIGNhbiBzZW5kIG1hbnVhbCB0cmFkaW5nIHNpZ25hbHMgdG8gYWxsIHVz
ZXJzIG9yIHNwZWNpZmljIHVzZXJzCiAgICAiIiIKICAgIHRyeToKICAgICAgICAjIFByZXBhcmUg
c2lnbmFsIGRvY3VtZW50CiAgICAgICAgIyBDYWxjdWxhdGUgZXhwaXJ5IHRpbWUgKGluIHNlY29u
ZHMpCiAgICAgICAgZXhwaXJ5X3RpbWUgPSBkYXRldGltZS51dGNub3coKSArIHRpbWVkZWx0YShz
ZWNvbmRzPXNpZ25hbC5kdXJhdGlvbl9zZWNvbmRzKQogICAgICAgIAogICAgICAgIHNpZ25hbF9k
b2MgPSB7CiAgICAgICAgICAgICJzeW1ib2wiOiBzaWduYWwuc3ltYm9sLnVwcGVyKCksCiAgICAg
ICAgICAgICJzaWduYWxfdHlwZSI6IHNpZ25hbC5zaWduYWxfdHlwZS51cHBlcigpLAogICAgICAg
ICAgICAiaW5kaWNhdG9yIjogc2lnbmFsLmluZGljYXRvciwKICAgICAgICAgICAgImNhbmRsZV9w
YXR0ZXJuIjogc2lnbmFsLmNhbmRsZV9wYXR0ZXJuLAogICAgICAgICAgICAidGltZWZyYW1lIjog
c2lnbmFsLnRpbWVmcmFtZSwKICAgICAgICAgICAgIm5vdGVzIjogc2lnbmFsLm5vdGVzIG9yICIi
LAogICAgICAgICAgICAic2VuZGVyX3R5cGUiOiAiYWRtaW4iLAogICAgICAgICAgICAic2VuZGVy
X2lkIjogc3RyKGN1cnJlbnRfYWRtaW5bIl9pZCJdKSwKICAgICAgICAgICAgInNlbmRlcl9lbWFp
bCI6IGN1cnJlbnRfYWRtaW4uZ2V0KCJlbWFpbCIpLAogICAgICAgICAgICAiY3JlYXRlZF9hdCI6
IGRhdGV0aW1lLnV0Y25vdygpLAogICAgICAgICAgICAiZXhwaXJlc19hdCI6IGV4cGlyeV90aW1l
LAogICAgICAgICAgICAiZHVyYXRpb25fc2Vjb25kcyI6IHNpZ25hbC5kdXJhdGlvbl9zZWNvbmRz
LAogICAgICAgICAgICAic3RhdHVzIjogImFjdGl2ZSIKICAgICAgICB9CiAgICAgICAgCiAgICAg
ICAgIyBJbnNlcnQgc2lnbmFsCiAgICAgICAgcmVzdWx0ID0gYXdhaXQgZGIuc2lnbmFscy5pbnNl
cnRfb25lKHNpZ25hbF9kb2MpCiAgICAgICAgc2lnbmFsX2lkID0gc3RyKHJlc3VsdC5pbnNlcnRl
ZF9pZCkKICAgICAgICAKICAgICAgICAjIElmIHRhcmdldF91c2VycyBzcGVjaWZpZWQsIHNlbmQg
dG8gc3BlY2lmaWMgdXNlcnMgb25seQogICAgICAgIGlmIHNpZ25hbC50YXJnZXRfdXNlcnM6CiAg
ICAgICAgICAgIGZvciB1c2VyX2lkIGluIHNpZ25hbC50YXJnZXRfdXNlcnM6CiAgICAgICAgICAg
ICAgICBhd2FpdCBkYi51c2VyX3NpZ25hbHMuaW5zZXJ0X29uZSh7CiAgICAgICAgICAgICAgICAg
ICAgInNpZ25hbF9pZCI6IHNpZ25hbF9pZCwKICAgICAgICAgICAgICAgICAgICAidXNlcl9pZCI6
IHVzZXJfaWQsCiAgICAgICAgICAgICAgICAgICAgInJlYWQiOiBGYWxzZSwKICAgICAgICAgICAg
ICAgICAgICAiY3JlYXRlZF9hdCI6IGRhdGV0aW1lLnV0Y25vdygpCiAgICAgICAgICAgICAgICB9
KQogICAgICAgICAgICByZWNpcGllbnRfY291bnQgPSBsZW4oc2lnbmFsLnRhcmdldF91c2VycykK
ICAgICAgICBlbHNlOgogICAgICAgICAgICAjIFNlbmQgdG8gYWxsIGFjdGl2ZSBwYWlkIHVzZXJz
CiAgICAgICAgICAgIGFjdGl2ZV91c2VycyA9IGF3YWl0IGRiLnVzZXJzLmZpbmQoewogICAgICAg
ICAgICAgICAgInN0YXR1cyI6ICJhY3RpdmUiLAogICAgICAgICAgICAgICAgInBheW1lbnRfc3Rh
dHVzIjogInBhaWQiCiAgICAgICAgICAgIH0pLnRvX2xpc3QobGVuZ3RoPTEwMDApCiAgICAgICAg
ICAgIAogICAgICAgICAgICBmb3IgdXNlciBpbiBhY3RpdmVfdXNlcnM6CiAgICAgICAgICAgICAg
ICBhd2FpdCBkYi51c2VyX3NpZ25hbHMuaW5zZXJ0X29uZSh7CiAgICAgICAgICAgICAgICAgICAg
InNpZ25hbF9pZCI6IHNpZ25hbF9pZCwKICAgICAgICAgICAgICAgICAgICAidXNlcl9pZCI6IHN0
cih1c2VyWyJfaWQiXSksCiAgICAgICAgICAgICAgICAgICAgInJlYWQiOiBGYWxzZSwKICAgICAg
ICAgICAgICAgICAgICAiY3JlYXRlZF9hdCI6IGRhdGV0aW1lLnV0Y25vdygpCiAgICAgICAgICAg
ICAgICB9KQogICAgICAgICAgICByZWNpcGllbnRfY291bnQgPSBsZW4oYWN0aXZlX3VzZXJzKQog
ICAgICAgIAogICAgICAgIGxvZ2dlci5pbmZvKGYi4pyFIEFkbWluIHNpZ25hbCBzZW50OiB7c2ln
bmFsLnNpZ25hbF90eXBlfSB7c2lnbmFsLnN5bWJvbH0gdG8ge3JlY2lwaWVudF9jb3VudH0gdXNl
cnMiKQogICAgICAgIAogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICJtZXNzYWdlIjogIlNp
Z25hbCBzZW50IHN1Y2Nlc3NmdWxseSIsCiAgICAgICAgICAgICJzaWduYWxfaWQiOiBzaWduYWxf
aWQsCiAgICAgICAgICAgICJyZWNpcGllbnRfY291bnQiOiByZWNpcGllbnRfY291bnQsCiAgICAg
ICAgICAgICJzaWduYWwiOiB7CiAgICAgICAgICAgICAgICAic3ltYm9sIjogc2lnbmFsX2RvY1si
c3ltYm9sIl0sCiAgICAgICAgICAgICAgICAic2lnbmFsX3R5cGUiOiBzaWduYWxfZG9jWyJzaWdu
YWxfdHlwZSJdLAogICAgICAgICAgICAgICAgImluZGljYXRvciI6IHNpZ25hbF9kb2NbImluZGlj
YXRvciJdLAogICAgICAgICAgICAgICAgImNhbmRsZV9wYXR0ZXJuIjogc2lnbmFsX2RvY1siY2Fu
ZGxlX3BhdHRlcm4iXSwKICAgICAgICAgICAgICAgICJ0aW1lZnJhbWUiOiBzaWduYWxfZG9jWyJ0
aW1lZnJhbWUiXSwKICAgICAgICAgICAgICAgICJub3RlcyI6IHNpZ25hbF9kb2NbIm5vdGVzIl0s
CiAgICAgICAgICAgICAgICAiY3JlYXRlZF9hdCI6IHNpZ25hbF9kb2NbImNyZWF0ZWRfYXQiXS5p
c29mb3JtYXQoKQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIAogICAgZXhjZXB0IEV4
Y2VwdGlvbiBhcyBlOgogICAgICAgIGxvZ2dlci5lcnJvcihmIkVycm9yIHNlbmRpbmcgYWRtaW4g
c2lnbmFsOiB7c3RyKGUpfSIpCiAgICAgICAgcmFpc2UgSFRUUEV4Y2VwdGlvbihzdGF0dXNfY29k
ZT01MDAsIGRldGFpbD1mIkZhaWxlZCB0byBzZW5kIHNpZ25hbDoge3N0cihlKX0iKQoKCkBhcGlf
cm91dGVyLnBvc3QoIi9tZW50b3Ivc2VuZC1zaWduYWwiKQphc3luYyBkZWYgbWVudG9yX3NlbmRf
c2lnbmFsKHNpZ25hbDogTWFudWFsU2lnbmFsLCBjdXJyZW50X21lbnRvciA9IERlcGVuZHMoZ2V0
X2N1cnJlbnRfbWVudG9yKSk6CiAgICAiIiIKICAgIE1lbnRvciBjYW4gc2VuZCBtYW51YWwgdHJh
ZGluZyBzaWduYWxzIHRvIHRoZWlyIHVzZXJzIG9ubHkKICAgICIiIgogICAgdHJ5OgogICAgICAg
IG1lbnRvcl9pZCA9IGN1cnJlbnRfbWVudG9yLmdldCgibWVudG9yX2lkIikKICAgICAgICAKICAg
ICAgICAjIEdldCBtZW50b3IncyB1c2VycwogICAgICAgIG1lbnRvcl91c2VycyA9IGF3YWl0IGRi
LnVzZXJzLmZpbmQoewogICAgICAgICAgICAibWVudG9yX2lkIjogbWVudG9yX2lkLAogICAgICAg
ICAgICAic3RhdHVzIjogImFjdGl2ZSIsCiAgICAgICAgICAgICJwYXltZW50X3N0YXR1cyI6ICJw
YWlkIgogICAgICAgIH0pLnRvX2xpc3QobGVuZ3RoPTEwMDApCiAgICAgICAgCiAgICAgICAgaWYg
bm90IG1lbnRvcl91c2VyczoKICAgICAgICAgICAgcmFpc2UgSFRUUEV4Y2VwdGlvbihzdGF0dXNf
Y29kZT00MDQsIGRldGFpbD0iTm8gYWN0aXZlIHVzZXJzIGZvdW5kIHVuZGVyIHlvdXIgbWVudG9y
IElEIikKICAgICAgICAKICAgICAgICAjIENhbGN1bGF0ZSBleHBpcnkgdGltZSAoaW4gc2Vjb25k
cykKICAgICAgICBleHBpcnlfdGltZSA9IGRhdGV0aW1lLnV0Y25vdygpICsgdGltZWRlbHRhKHNl
Y29uZHM9c2lnbmFsLmR1cmF0aW9uX3NlY29uZHMpCiAgICAgICAgCiAgICAgICAgIyBQcmVwYXJl
IHNpZ25hbCBkb2N1bWVudAogICAgICAgIHNpZ25hbF9kb2MgPSB7CiAgICAgICAgICAgICJzeW1i
b2wiOiBzaWduYWwuc3ltYm9sLnVwcGVyKCksCiAgICAgICAgICAgICJzaWduYWxfdHlwZSI6IHNp
Z25hbC5zaWduYWxfdHlwZS51cHBlcigpLAogICAgICAgICAgICAiaW5kaWNhdG9yIjogc2lnbmFs
LmluZGljYXRvciwKICAgICAgICAgICAgImNhbmRsZV9wYXR0ZXJuIjogc2lnbmFsLmNhbmRsZV9w
YXR0ZXJuLAogICAgICAgICAgICAidGltZWZyYW1lIjogc2lnbmFsLnRpbWVmcmFtZSwKICAgICAg
ICAgICAgIm5vdGVzIjogc2lnbmFsLm5vdGVzIG9yICIiLAogICAgICAgICAgICAic2VuZGVyX3R5
cGUiOiAibWVudG9yIiwKICAgICAgICAgICAgInNlbmRlcl9pZCI6IHN0cihjdXJyZW50X21lbnRv
clsiX2lkIl0pLAogICAgICAgICAgICAic2VuZGVyX2VtYWlsIjogY3VycmVudF9tZW50b3IuZ2V0
KCJlbWFpbCIpLAogICAgICAgICAgICAibWVudG9yX2lkIjogbWVudG9yX2lkLAogICAgICAgICAg
ICAiY3JlYXRlZF9hdCI6IGRhdGV0aW1lLnV0Y25vdygpLAogICAgICAgICAgICAiZXhwaXJlc19h
dCI6IGV4cGlyeV90aW1lLAogICAgICAgICAgICAiZHVyYXRpb25fc2Vjb25kcyI6IHNpZ25hbC5k
dXJhdGlvbl9zZWNvbmRzLAogICAgICAgICAgICAic3RhdHVzIjogImFjdGl2ZSIKICAgICAgICB9
CiAgICAgICAgCiAgICAgICAgIyBJbnNlcnQgc2lnbmFsCiAgICAgICAgcmVzdWx0ID0gYXdhaXQg
ZGIuc2lnbmFscy5pbnNlcnRfb25lKHNpZ25hbF9kb2MpCiAgICAgICAgc2lnbmFsX2lkID0gc3Ry
KHJlc3VsdC5pbnNlcnRlZF9pZCkKICAgICAgICAKICAgICAgICAjIFNlbmQgdG8gbWVudG9yJ3Mg
dXNlcnMKICAgICAgICBmb3IgdXNlciBpbiBtZW50b3JfdXNlcnM6CiAgICAgICAgICAgIGF3YWl0
IGRiLnVzZXJfc2lnbmFscy5pbnNlcnRfb25lKHsKICAgICAgICAgICAgICAgICJzaWduYWxfaWQi
OiBzaWduYWxfaWQsCiAgICAgICAgICAgICAgICAidXNlcl9pZCI6IHN0cih1c2VyWyJfaWQiXSks
CiAgICAgICAgICAgICAgICAicmVhZCI6IEZhbHNlLAogICAgICAgICAgICAgICAgImNyZWF0ZWRf
YXQiOiBkYXRldGltZS51dGNub3coKQogICAgICAgICAgICB9KQogICAgICAgIAogICAgICAgIHJl
Y2lwaWVudF9jb3VudCA9IGxlbihtZW50b3JfdXNlcnMpCiAgICAgICAgCiAgICAgICAgbG9nZ2Vy
LmluZm8oZiLinIUgTWVudG9yIHttZW50b3JfaWR9IHNpZ25hbCBzZW50OiB7c2lnbmFsLnNpZ25h
bF90eXBlfSB7c2lnbmFsLnN5bWJvbH0gdG8ge3JlY2lwaWVudF9jb3VudH0gdXNlcnMiKQogICAg
ICAgIAogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICJtZXNzYWdlIjogIlNpZ25hbCBzZW50
IHN1Y2Nlc3NmdWxseSIsCiAgICAgICAgICAgICJzaWduYWxfaWQiOiBzaWduYWxfaWQsCiAgICAg
ICAgICAgICJyZWNpcGllbnRfY291bnQiOiByZWNpcGllbnRfY291bnQsCiAgICAgICAgICAgICJz
aWduYWwiOiB7CiAgICAgICAgICAgICAgICAic3ltYm9sIjogc2lnbmFsX2RvY1sic3ltYm9sIl0s
CiAgICAgICAgICAgICAgICAic2lnbmFsX3R5cGUiOiBzaWduYWxfZG9jWyJzaWduYWxfdHlwZSJd
LAogICAgICAgICAgICAgICAgImluZGljYXRvciI6IHNpZ25hbF9kb2NbImluZGljYXRvciJdLAog
ICAgICAgICAgICAgICAgImNhbmRsZV9wYXR0ZXJuIjogc2lnbmFsX2RvY1siY2FuZGxlX3BhdHRl
cm4iXSwKICAgICAgICAgICAgICAgICJ0aW1lZnJhbWUiOiBzaWduYWxfZG9jWyJ0aW1lZnJhbWUi
XSwKICAgICAgICAgICAgICAgICJub3RlcyI6IHNpZ25hbF9kb2NbIm5vdGVzIl0sCiAgICAgICAg
ICAgICAgICAiY3JlYXRlZF9hdCI6IHNpZ25hbF9kb2NbImNyZWF0ZWRfYXQiXS5pc29mb3JtYXQo
KQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIAogICAgZXhjZXB0IEhUVFBFeGNlcHRp
b246CiAgICAgICAgcmFpc2UKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICBsb2dn
ZXIuZXJyb3IoZiJFcnJvciBzZW5kaW5nIG1lbnRvciBzaWduYWw6IHtzdHIoZSl9IikKICAgICAg
ICByYWlzZSBIVFRQRXhjZXB0aW9uKHN0YXR1c19jb2RlPTUwMCwgZGV0YWlsPWYiRmFpbGVkIHRv
IHNlbmQgc2lnbmFsOiB7c3RyKGUpfSIpCgoKIyBIZWxwZXIgZnVuY3Rpb24gdG8gc2VuZCBwdXNo
IG5vdGlmaWNhdGlvbnMgZm9yIG1hbnVhbCBuZXdzCmFzeW5jIGRlZiBzZW5kX21hbnVhbF9uZXdz
X25vdGlmaWNhdGlvbihuZXdzX2RvYzogZGljdCwgdXNlcl9pZHM6IGxpc3QpOgogICAgIiIiU2Vu
ZCBwdXNoIG5vdGlmaWNhdGlvbiBmb3IgbWFudWFsIG5ld3MgZXZlbnRzIHRvIHNwZWNpZmljIHVz
ZXJzIiIiCiAgICB0cnk6CiAgICAgICAgaWYgbm90IHVzZXJfaWRzOgogICAgICAgICAgICByZXR1
cm4KICAgICAgICAKICAgICAgICAjIEdldCBwdXNoIHRva2VucyBmb3IgdGhlIHNwZWNpZmllZCB1
c2VycwogICAgICAgIHRva2VucyA9IGF3YWl0IGRiLnB1c2hfdG9rZW5zLmZpbmQoewogICAgICAg
ICAgICAidXNlcl9pZCI6IHsiJGluIjogdXNlcl9pZHN9CiAgICAgICAgfSkudG9fbGlzdCgxMDAw
KQogICAgICAgIAogICAgICAgIGlmIG5vdCB0b2tlbnM6CiAgICAgICAgICAgIGxvZ2dpbmcuaW5m
bygiTm8gcHVzaCB0b2tlbnMgZm91bmQgZm9yIHRoZSBzcGVjaWZpZWQgdXNlcnMiKQogICAgICAg
ICAgICByZXR1cm4KICAgICAgICAKICAgICAgICAjIFByZXBhcmUgbm90aWZpY2F0aW9uIG1lc3Nh
Z2UKICAgICAgICB0aXRsZSA9IGYi8J+TsCB7bmV3c19kb2NbJ3RpdGxlJ119IgogICAgICAgIAog
ICAgICAgICMgQnVpbGQgYm9keSBmcm9tIG9wdGlvbmFsIGZpZWxkcwogICAgICAgIGJvZHlfcGFy
dHMgPSBbXQogICAgICAgIGlmIG5ld3NfZG9jLmdldCgnY3VycmVuY3knKToKICAgICAgICAgICAg
Ym9keV9wYXJ0cy5hcHBlbmQoZiJDdXJyZW5jeToge25ld3NfZG9jWydjdXJyZW5jeSddfSIpCiAg
ICAgICAgaWYgbmV3c19kb2MuZ2V0KCdpbXBhY3QnKToKICAgICAgICAgICAgYm9keV9wYXJ0cy5h
cHBlbmQoZiJJbXBhY3Q6IHtuZXdzX2RvY1snaW1wYWN0J119IikKICAgICAgICBpZiBuZXdzX2Rv
Yy5nZXQoJ2V2ZW50X3RpbWUnKToKICAgICAgICAgICAgYm9keV9wYXJ0cy5hcHBlbmQoZiJUaW1l
OiB7bmV3c19kb2NbJ2V2ZW50X3RpbWUnXX0iKQogICAgICAgIGlmIG5ld3NfZG9jLmdldCgnc2ln
bmFsJyk6CiAgICAgICAgICAgIGJvZHlfcGFydHMuYXBwZW5kKGYiU2lnbmFsOiB7bmV3c19kb2Nb
J3NpZ25hbCddfSIpCiAgICAgICAgCiAgICAgICAgYm9keSA9ICIgfCAiLmpvaW4oYm9keV9wYXJ0
cykgaWYgYm9keV9wYXJ0cyBlbHNlICJOZXcgbWFya2V0IG5ld3MgZXZlbnQiCiAgICAgICAgCiAg
ICAgICAgIyBTZW5kIHRvIEV4cG8gUHVzaCBOb3RpZmljYXRpb24gc2VydmljZQogICAgICAgIG1l
c3NhZ2VzID0gW10KICAgICAgICBmb3IgdG9rZW5fZG9jIGluIHRva2VuczoKICAgICAgICAgICAg
bWVzc2FnZXMuYXBwZW5kKHsKICAgICAgICAgICAgICAgICJ0byI6IHRva2VuX2RvY1sidG9rZW4i
XSwKICAgICAgICAgICAgICAgICJzb3VuZCI6ICJkZWZhdWx0IiwKICAgICAgICAgICAgICAgICJ0
aXRsZSI6IHRpdGxlLAogICAgICAgICAgICAgICAgImJvZHkiOiBib2R5LAogICAgICAgICAgICAg
ICAgImRhdGEiOiB7CiAgICAgICAgICAgICAgICAgICAgIm5ld3NfaWQiOiBzdHIobmV3c19kb2Nb
Il9pZCJdKSwKICAgICAgICAgICAgICAgICAgICAidGl0bGUiOiBuZXdzX2RvY1sidGl0bGUiXSwK
ICAgICAgICAgICAgICAgICAgICAiY3VycmVuY3kiOiBuZXdzX2RvYy5nZXQoImN1cnJlbmN5Iiks
CiAgICAgICAgICAgICAgICAgICAgInNpZ25hbCI6IG5ld3NfZG9jLmdldCgic2lnbmFsIiksCiAg
ICAgICAgICAgICAgICAgICAgInR5cGUiOiAibWFudWFsX25ld3MiCiAgICAgICAgICAgICAgICB9
LAogICAgICAgICAgICAgICAgInByaW9yaXR5IjogImhpZ2giLAogICAgICAgICAgICAgICAgImNo
YW5uZWxJZCI6ICJkZWZhdWx0IgogICAgICAgICAgICB9KQogICAgICAgIAogICAgICAgICMgU2Vu
ZCBub3RpZmljYXRpb25zIGluIGJhdGNoZXMKICAgICAgICBhc3luYyB3aXRoIGh0dHB4LkFzeW5j
Q2xpZW50KCkgYXMgY2xpZW50OgogICAgICAgICAgICByZXNwb25zZSA9IGF3YWl0IGNsaWVudC5w
b3N0KAogICAgICAgICAgICAgICAgJ2h0dHBzOi8vZXhwLmhvc3QvLS0vYXBpL3YyL3B1c2gvc2Vu
ZCcsCiAgICAgICAgICAgICAgICBqc29uPW1lc3NhZ2VzLAogICAgICAgICAgICAgICAgdGltZW91
dD0xMC4wCiAgICAgICAgICAgICkKICAgICAgICAgICAgbG9nZ2luZy5pbmZvKGYiTWFudWFsIG5l
d3Mgbm90aWZpY2F0aW9uIHNlbnQgdG8ge2xlbihtZXNzYWdlcyl9IHVzZXJzOiB7cmVzcG9uc2Uu
c3RhdHVzX2NvZGV9IikKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICBsb2dnaW5n
LmVycm9yKGYiRXJyb3Igc2VuZGluZyBtYW51YWwgbmV3cyBub3RpZmljYXRpb246IHtlfSIpCgoK
QGFwaV9yb3V0ZXIucG9zdCgiL2FkbWluL3NlbmQtbWFudWFsLW5ld3MiKQphc3luYyBkZWYgYWRt
aW5fc2VuZF9tYW51YWxfbmV3cyhuZXdzOiBNYW51YWxOZXdzRXZlbnQsIGN1cnJlbnRfYWRtaW4g
PSBEZXBlbmRzKGdldF9jdXJyZW50X2FkbWluKSk6CiAgICAiIiIKICAgIEFkbWluIGNhbiBzZW5k
IG1hbnVhbCBuZXdzIGV2ZW50cyB0byBBTEwgdXNlcnMKICAgICIiIgogICAgdHJ5OgogICAgICAg
ICMgR2V0IGFsbCBhY3RpdmUsIHBhaWQgdXNlcnMKICAgICAgICBhbGxfdXNlcnMgPSBhd2FpdCBk
Yi51c2Vycy5maW5kKHsKICAgICAgICAgICAgInN0YXR1cyI6ICJhY3RpdmUiLAogICAgICAgICAg
ICAicGF5bWVudF9zdGF0dXMiOiAicGFpZCIKICAgICAgICB9KS50b19saXN0KGxlbmd0aD0xMDAw
MCkKICAgICAgICAKICAgICAgICAjIEdldCBhbGwgYWRtaW5zCiAgICAgICAgYWxsX2FkbWlucyA9
IGF3YWl0IGRiLmFkbWlucy5maW5kKHt9KS50b19saXN0KGxlbmd0aD0xMDApCiAgICAgICAgCiAg
ICAgICAgIyBDb21iaW5lIHVzZXJzIGFuZCBhZG1pbnMKICAgICAgICBhbGxfcmVjaXBpZW50cyA9
IGFsbF91c2VycyArIGFsbF9hZG1pbnMKICAgICAgICAKICAgICAgICBpZiBub3QgYWxsX3JlY2lw
aWVudHM6CiAgICAgICAgICAgIHJhaXNlIEhUVFBFeGNlcHRpb24oc3RhdHVzX2NvZGU9NDA0LCBk
ZXRhaWw9Ik5vIGFjdGl2ZSB1c2VycyBvciBhZG1pbnMgZm91bmQiKQogICAgICAgIAogICAgICAg
ICMgUHJlcGFyZSBuZXdzIGRvY3VtZW50IC0gb25seSBpbmNsdWRlIG5vbi1Ob25lIGZpZWxkcwog
ICAgICAgIG5ld3NfZG9jID0gewogICAgICAgICAgICAidGl0bGUiOiBuZXdzLnRpdGxlLAogICAg
ICAgICAgICAic2VuZGVyX3R5cGUiOiAiYWRtaW4iLAogICAgICAgICAgICAic2VuZGVyX2lkIjog
c3RyKGN1cnJlbnRfYWRtaW5bIl9pZCJdKSwKICAgICAgICAgICAgInNlbmRlcl9lbWFpbCI6IGN1
cnJlbnRfYWRtaW4uZ2V0KCJlbWFpbCIpLAogICAgICAgICAgICAiY3JlYXRlZF9hdCI6IGRhdGV0
aW1lLnV0Y25vdygpLAogICAgICAgICAgICAiaXNfbWFudWFsIjogVHJ1ZSwKICAgICAgICAgICAg
InN0YXR1cyI6ICJhY3RpdmUiCiAgICAgICAgfQogICAgICAgIAogICAgICAgICMgQWRkIG9wdGlv
bmFsIGZpZWxkcyBvbmx5IGlmIHRoZXkgYXJlIHByb3ZpZGVkCiAgICAgICAgaWYgbmV3cy5ldmVu
dF90aW1lIGlzIG5vdCBOb25lOgogICAgICAgICAgICBuZXdzX2RvY1siZXZlbnRfdGltZSJdID0g
bmV3cy5ldmVudF90aW1lCiAgICAgICAgaWYgbmV3cy5jdXJyZW5jeSBpcyBub3QgTm9uZToKICAg
ICAgICAgICAgbmV3c19kb2NbImN1cnJlbmN5Il0gPSBuZXdzLmN1cnJlbmN5CiAgICAgICAgaWYg
bmV3cy5pbXBhY3QgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIG5ld3NfZG9jWyJpbXBhY3QiXSA9
IG5ld3MuaW1wYWN0CiAgICAgICAgaWYgbmV3cy5kZXNjcmlwdGlvbiBpcyBub3QgTm9uZToKICAg
ICAgICAgICAgbmV3c19kb2NbImRlc2NyaXB0aW9uIl0gPSBuZXdzLmRlc2NyaXB0aW9uCiAgICAg
ICAgaWYgbmV3cy5zaWduYWwgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIG5ld3NfZG9jWyJzaWdu
YWwiXSA9IG5ld3Muc2lnbmFsLnVwcGVyKCkKICAgICAgICAKICAgICAgICAjIEluc2VydCBuZXdz
IGV2ZW50IGludG8gbWFudWFsX25ld3MgY29sbGVjdGlvbgogICAgICAgIHJlc3VsdCA9IGF3YWl0
IGRiLm1hbnVhbF9uZXdzLmluc2VydF9vbmUobmV3c19kb2MpCiAgICAgICAgbmV3c19pZCA9IHN0
cihyZXN1bHQuaW5zZXJ0ZWRfaWQpCiAgICAgICAgbmV3c19kb2NbIl9pZCJdID0gcmVzdWx0Lmlu
c2VydGVkX2lkCiAgICAgICAgCiAgICAgICAgIyBTZW5kIHB1c2ggbm90aWZpY2F0aW9ucyB0byBh
bGwgdXNlcnMgYW5kIGFkbWlucwogICAgICAgIHJlY2lwaWVudF9pZHMgPSBbc3RyKHJlY2lwaWVu
dFsiX2lkIl0pIGZvciByZWNpcGllbnQgaW4gYWxsX3JlY2lwaWVudHNdCiAgICAgICAgYXdhaXQg
c2VuZF9tYW51YWxfbmV3c19ub3RpZmljYXRpb24obmV3c19kb2MsIHJlY2lwaWVudF9pZHMpCiAg
ICAgICAgCiAgICAgICAgcmVjaXBpZW50X2NvdW50ID0gbGVuKGFsbF9yZWNpcGllbnRzKQogICAg
ICAgIAogICAgICAgIGxvZ2dlci5pbmZvKGYi4pyFIEFkbWluIG1hbnVhbCBuZXdzIHNlbnQ6ICd7
bmV3cy50aXRsZX0nIHRvIHtyZWNpcGllbnRfY291bnR9IHJlY2lwaWVudHMgKHVzZXJzICsgYWRt
aW5zKSIpCiAgICAgICAgCiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgIm1lc3NhZ2UiOiAi
TWFudWFsIG5ld3MgZXZlbnQgc2VudCBzdWNjZXNzZnVsbHkiLAogICAgICAgICAgICAibmV3c19p
ZCI6IG5ld3NfaWQsCiAgICAgICAgICAgICJyZWNpcGllbnRfY291bnQiOiByZWNpcGllbnRfY291
bnQsCiAgICAgICAgICAgICJuZXdzIjogewogICAgICAgICAgICAgICAgazogdiBmb3IgaywgdiBp
biBuZXdzX2RvYy5pdGVtcygpIAogICAgICAgICAgICAgICAgaWYgayAhPSAiX2lkIiBhbmQgdiBp
cyBub3QgTm9uZQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIAogICAgZXhjZXB0IEhU
VFBFeGNlcHRpb246CiAgICAgICAgcmFpc2UKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAg
ICAgICBsb2dnZXIuZXJyb3IoZiJFcnJvciBzZW5kaW5nIGFkbWluIG1hbnVhbCBuZXdzOiB7c3Ry
KGUpfSIpCiAgICAgICAgcmFpc2UgSFRUUEV4Y2VwdGlvbihzdGF0dXNfY29kZT01MDAsIGRldGFp
bD1mIkZhaWxlZCB0byBzZW5kIG1hbnVhbCBuZXdzOiB7c3RyKGUpfSIpCgoKQGFwaV9yb3V0ZXIu
cG9zdCgiL21lbnRvci9zZW5kLW1hbnVhbC1uZXdzIikKYXN5bmMgZGVmIG1lbnRvcl9zZW5kX21h
bnVhbF9uZXdzKG5ld3M6IE1hbnVhbE5ld3NFdmVudCwgY3VycmVudF9tZW50b3IgPSBEZXBlbmRz
KGdldF9jdXJyZW50X21lbnRvcikpOgogICAgIiIiCiAgICBNZW50b3IgY2FuIHNlbmQgbWFudWFs
IG5ld3MgZXZlbnRzIHRvIFRIRUlSIHVzZXJzIG9ubHkKICAgICIiIgogICAgdHJ5OgogICAgICAg
IG1lbnRvcl9pZCA9IGN1cnJlbnRfbWVudG9yLmdldCgibWVudG9yX2lkIikKICAgICAgICAKICAg
ICAgICAjIEdldCBtZW50b3IncyB1c2VycwogICAgICAgIG1lbnRvcl91c2VycyA9IGF3YWl0IGRi
LnVzZXJzLmZpbmQoewogICAgICAgICAgICAibWVudG9yX2lkIjogbWVudG9yX2lkLAogICAgICAg
ICAgICAic3RhdHVzIjogImFjdGl2ZSIsCiAgICAgICAgICAgICJwYXltZW50X3N0YXR1cyI6ICJw
YWlkIgogICAgICAgIH0pLnRvX2xpc3QobGVuZ3RoPTEwMDAwKQogICAgICAgIAogICAgICAgICMg
R2V0IGFsbCBhZG1pbnMKICAgICAgICBhbGxfYWRtaW5zID0gYXdhaXQgZGIuYWRtaW5zLmZpbmQo
e30pLnRvX2xpc3QobGVuZ3RoPTEwMCkKICAgICAgICAKICAgICAgICAjIENvbWJpbmUgbWVudG9y
J3MgdXNlcnMgd2l0aCBhZG1pbnMKICAgICAgICBhbGxfcmVjaXBpZW50cyA9IG1lbnRvcl91c2Vy
cyArIGFsbF9hZG1pbnMKICAgICAgICAKICAgICAgICBpZiBub3QgYWxsX3JlY2lwaWVudHM6CiAg
ICAgICAgICAgIHJhaXNlIEhUVFBFeGNlcHRpb24oc3RhdHVzX2NvZGU9NDA0LCBkZXRhaWw9Ik5v
IGFjdGl2ZSB1c2VycyBvciBhZG1pbnMgZm91bmQiKQogICAgICAgIAogICAgICAgICMgUHJlcGFy
ZSBuZXdzIGRvY3VtZW50IC0gb25seSBpbmNsdWRlIG5vbi1Ob25lIGZpZWxkcwogICAgICAgIG5l
d3NfZG9jID0gewogICAgICAgICAgICAidGl0bGUiOiBuZXdzLnRpdGxlLAogICAgICAgICAgICAi
c2VuZGVyX3R5cGUiOiAibWVudG9yIiwKICAgICAgICAgICAgInNlbmRlcl9pZCI6IHN0cihjdXJy
ZW50X21lbnRvclsiX2lkIl0pLAogICAgICAgICAgICAic2VuZGVyX2VtYWlsIjogY3VycmVudF9t
ZW50b3IuZ2V0KCJlbWFpbCIpLAogICAgICAgICAgICAibWVudG9yX2lkIjogbWVudG9yX2lkLAog
ICAgICAgICAgICAiY3JlYXRlZF9hdCI6IGRhdGV0aW1lLnV0Y25vdygpLAogICAgICAgICAgICAi
aXNfbWFudWFsIjogVHJ1ZSwKICAgICAgICAgICAgInN0YXR1cyI6ICJhY3RpdmUiCiAgICAgICAg
fQogICAgICAgIAogICAgICAgICMgQWRkIG9wdGlvbmFsIGZpZWxkcyBvbmx5IGlmIHRoZXkgYXJl
IHByb3ZpZGVkCiAgICAgICAgaWYgbmV3cy5ldmVudF90aW1lIGlzIG5vdCBOb25lOgogICAgICAg
ICAgICBuZXdzX2RvY1siZXZlbnRfdGltZSJdID0gbmV3cy5ldmVudF90aW1lCiAgICAgICAgaWYg
bmV3cy5jdXJyZW5jeSBpcyBub3QgTm9uZToKICAgICAgICAgICAgbmV3c19kb2NbImN1cnJlbmN5
Il0gPSBuZXdzLmN1cnJlbmN5CiAgICAgICAgaWYgbmV3cy5pbXBhY3QgaXMgbm90IE5vbmU6CiAg
ICAgICAgICAgIG5ld3NfZG9jWyJpbXBhY3QiXSA9IG5ld3MuaW1wYWN0CiAgICAgICAgaWYgbmV3
cy5kZXNjcmlwdGlvbiBpcyBub3QgTm9uZToKICAgICAgICAgICAgbmV3c19kb2NbImRlc2NyaXB0
aW9uIl0gPSBuZXdzLmRlc2NyaXB0aW9uCiAgICAgICAgaWYgbmV3cy5zaWduYWwgaXMgbm90IE5v
bmU6CiAgICAgICAgICAgIG5ld3NfZG9jWyJzaWduYWwiXSA9IG5ld3Muc2lnbmFsLnVwcGVyKCkK
ICAgICAgICAKICAgICAgICAjIEluc2VydCBuZXdzIGV2ZW50IGludG8gbWFudWFsX25ld3MgY29s
bGVjdGlvbgogICAgICAgIHJlc3VsdCA9IGF3YWl0IGRiLm1hbnVhbF9uZXdzLmluc2VydF9vbmUo
bmV3c19kb2MpCiAgICAgICAgbmV3c19pZCA9IHN0cihyZXN1bHQuaW5zZXJ0ZWRfaWQpCiAgICAg
ICAgbmV3c19kb2NbIl9pZCJdID0gcmVzdWx0Lmluc2VydGVkX2lkCiAgICAgICAgCiAgICAgICAg
IyBTZW5kIHB1c2ggbm90aWZpY2F0aW9ucyB0byBtZW50b3IncyB1c2VycyBhbmQgYWRtaW5zCiAg
ICAgICAgcmVjaXBpZW50X2lkcyA9IFtzdHIocmVjaXBpZW50WyJfaWQiXSkgZm9yIHJlY2lwaWVu
dCBpbiBhbGxfcmVjaXBpZW50c10KICAgICAgICBhd2FpdCBzZW5kX21hbnVhbF9uZXdzX25vdGlm
aWNhdGlvbihuZXdzX2RvYywgcmVjaXBpZW50X2lkcykKICAgICAgICAKICAgICAgICByZWNpcGll
bnRfY291bnQgPSBsZW4oYWxsX3JlY2lwaWVudHMpCiAgICAgICAgdXNlcl9jb3VudCA9IGxlbiht
ZW50b3JfdXNlcnMpCiAgICAgICAgYWRtaW5fY291bnQgPSBsZW4oYWxsX2FkbWlucykKICAgICAg
ICAKICAgICAgICBsb2dnZXIuaW5mbyhmIuKchSBNZW50b3Ige21lbnRvcl9pZH0gbWFudWFsIG5l
d3Mgc2VudDogJ3tuZXdzLnRpdGxlfScgdG8ge3JlY2lwaWVudF9jb3VudH0gcmVjaXBpZW50cyAo
e3VzZXJfY291bnR9IHVzZXJzICsge2FkbWluX2NvdW50fSBhZG1pbnMpIikKICAgICAgICAKICAg
ICAgICByZXR1cm4gewogICAgICAgICAgICAibWVzc2FnZSI6ICJNYW51YWwgbmV3cyBldmVudCBz
ZW50IHN1Y2Nlc3NmdWxseSIsCiAgICAgICAgICAgICJuZXdzX2lkIjogbmV3c19pZCwKICAgICAg
ICAgICAgInJlY2lwaWVudF9jb3VudCI6IHJlY2lwaWVudF9jb3VudCwKICAgICAgICAgICAgIm5l
d3MiOiB7CiAgICAgICAgICAgICAgICBrOiB2IGZvciBrLCB2IGluIG5ld3NfZG9jLml0ZW1zKCkg
CiAgICAgICAgICAgICAgICBpZiBrICE9ICJfaWQiIGFuZCB2IGlzIG5vdCBOb25lCiAgICAgICAg
ICAgIH0KICAgICAgICB9CiAgICAgICAgCiAgICBleGNlcHQgSFRUUEV4Y2VwdGlvbjoKICAgICAg
ICByYWlzZQogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIGxvZ2dlci5lcnJvcihm
IkVycm9yIHNlbmRpbmcgbWVudG9yIG1hbnVhbCBuZXdzOiB7c3RyKGUpfSIpCgoKIyA9PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQojIENVU1RPTSBJ
TkRJQ0FUT1IgRU5EUE9JTlRTCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT0KCkBhcGlfcm91dGVyLnBvc3QoIi9tZW50b3IvY3JlYXRlLWluZGlj
YXRvciIpCmFzeW5jIGRlZiBjcmVhdGVfY3VzdG9tX2luZGljYXRvcihpbmRpY2F0b3I6IEN1c3Rv
bUluZGljYXRvciwgY3VycmVudF9tZW50b3IgPSBEZXBlbmRzKGdldF9jdXJyZW50X21lbnRvcikp
OgogICAgIiIiCiAgICBNZW50b3IgY3JlYXRlcyBhIGN1c3RvbSBpbmRpY2F0b3Igd2l0aCBmdWxs
IGNvbmZpZ3VyYXRpb24KICAgICIiIgogICAgdHJ5OgogICAgICAgIG1lbnRvcl9pZCA9IGN1cnJl
bnRfbWVudG9yLmdldCgibWVudG9yX2lkIikKICAgICAgICAKICAgICAgICAjIENvbnZlcnQgUHlk
YW50aWMgbW9kZWxzIHRvIGRpY3RzCiAgICAgICAgaW5kaWNhdG9yc19saXN0ID0gW2luZC5kaWN0
KCkgZm9yIGluZCBpbiBpbmRpY2F0b3IuaW5kaWNhdG9yc10KICAgICAgICBidXlfY29uZGl0aW9u
c19saXN0ID0gW2NvbmQuZGljdCgpIGZvciBjb25kIGluIGluZGljYXRvci5idXlfY29uZGl0aW9u
c10KICAgICAgICBzZWxsX2NvbmRpdGlvbnNfbGlzdCA9IFtjb25kLmRpY3QoKSBmb3IgY29uZCBp
biBpbmRpY2F0b3Iuc2VsbF9jb25kaXRpb25zXQogICAgICAgIAogICAgICAgICMgQ3JlYXRlIGlu
ZGljYXRvciBkb2N1bWVudAogICAgICAgIGluZGljYXRvcl9kb2MgPSB7CiAgICAgICAgICAgICJu
YW1lIjogaW5kaWNhdG9yLm5hbWUsCiAgICAgICAgICAgICJkZXNjcmlwdGlvbiI6IGluZGljYXRv
ci5kZXNjcmlwdGlvbiBvciAiIiwKICAgICAgICAgICAgInN5bWJvbCI6IGluZGljYXRvci5zeW1i
b2wsCiAgICAgICAgICAgICJ0aW1lZnJhbWUiOiBpbmRpY2F0b3IudGltZWZyYW1lLAogICAgICAg
ICAgICAiaW5kaWNhdG9ycyI6IGluZGljYXRvcnNfbGlzdCwKICAgICAgICAgICAgImJ1eV9jb25k
aXRpb25zIjogYnV5X2NvbmRpdGlvbnNfbGlzdCwKICAgICAgICAgICAgInNlbGxfY29uZGl0aW9u
cyI6IHNlbGxfY29uZGl0aW9uc19saXN0LAogICAgICAgICAgICAibWVudG9yX2lkIjogbWVudG9y
X2lkLAogICAgICAgICAgICAibWVudG9yX2VtYWlsIjogY3VycmVudF9tZW50b3IuZ2V0KCJlbWFp
bCIpLAogICAgICAgICAgICAiY3VycmVudF9zaWduYWwiOiAiTk9ORSIsICAjIERlZmF1bHQgdG8g
bm8gc2lnbmFsCiAgICAgICAgICAgICJpc19ydW5uaW5nIjogRmFsc2UsICAjIERlZmF1bHQgdG8g
c3RvcHBlZCAobWVudG9yIG11c3Qgc3RhcnQgaXQpCiAgICAgICAgICAgICJzdGF0dXMiOiAiYWN0
aXZlIiwKICAgICAgICAgICAgImNyZWF0ZWRfYXQiOiBkYXRldGltZS51dGNub3coKSwKICAgICAg
ICAgICAgInVwZGF0ZWRfYXQiOiBkYXRldGltZS51dGNub3coKSwKICAgICAgICAgICAgImxhc3Rf
Y2hlY2tlZCI6IE5vbmUgICMgVHJhY2sgd2hlbiBtYXJrZXQgd2FzIGxhc3QgY2hlY2tlZAogICAg
ICAgIH0KICAgICAgICAKICAgICAgICAjIEluc2VydCBpbnRvIGRhdGFiYXNlCiAgICAgICAgcmVz
dWx0ID0gYXdhaXQgZGIuY3VzdG9tX2luZGljYXRvcnMuaW5zZXJ0X29uZShpbmRpY2F0b3JfZG9j
KQogICAgICAgIGluZGljYXRvcl9pZCA9IHN0cihyZXN1bHQuaW5zZXJ0ZWRfaWQpCiAgICAgICAg
CiAgICAgICAgbG9nZ2VyLmluZm8oZiLinIUgTWVudG9yIHttZW50b3JfaWR9IGNyZWF0ZWQgaW5k
aWNhdG9yOiAne2luZGljYXRvci5uYW1lfScgKElEOiB7aW5kaWNhdG9yX2lkfSkiKQogICAgICAg
IAogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICJtZXNzYWdlIjogIkluZGljYXRvciBjcmVh
dGVkIHN1Y2Nlc3NmdWxseSIsCiAgICAgICAgICAgICJpbmRpY2F0b3JfaWQiOiBpbmRpY2F0b3Jf
aWQsCiAgICAgICAgICAgICJpbmRpY2F0b3IiOiB7CiAgICAgICAgICAgICAgICAiaWQiOiBpbmRp
Y2F0b3JfaWQsCiAgICAgICAgICAgICAgICAibmFtZSI6IGluZGljYXRvci5uYW1lLAogICAgICAg
ICAgICAgICAgImRlc2NyaXB0aW9uIjogaW5kaWNhdG9yLmRlc2NyaXB0aW9uLAogICAgICAgICAg
ICAgICAgImN1cnJlbnRfc2lnbmFsIjogIk5PTkUiLAogICAgICAgICAgICAgICAgInN0YXR1cyI6
ICJhY3RpdmUiCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgCiAgICBleGNlcHQgRXhj
ZXB0aW9uIGFzIGU6CiAgICAgICAgbG9nZ2VyLmVycm9yKGYiRXJyb3IgY3JlYXRpbmcgaW5kaWNh
dG9yOiB7c3RyKGUpfSIpCiAgICAgICAgcmFpc2UgSFRUUEV4Y2VwdGlvbihzdGF0dXNfY29kZT01
MDAsIGRldGFpbD1mIkZhaWxlZCB0byBjcmVhdGUgaW5kaWNhdG9yOiB7c3RyKGUpfSIpCgoKQGFw
aV9yb3V0ZXIuZ2V0KCIvbWVudG9yL2luZGljYXRvcnMiKQphc3luYyBkZWYgZ2V0X21lbnRvcl9p
bmRpY2F0b3JzKGN1cnJlbnRfbWVudG9yID0gRGVwZW5kcyhnZXRfY3VycmVudF9tZW50b3IpKToK
ICAgICIiIgogICAgR2V0IGFsbCBpbmRpY2F0b3JzIGNyZWF0ZWQgYnkgdGhpcyBtZW50b3IKICAg
ICIiIgogICAgdHJ5OgogICAgICAgIG1lbnRvcl9pZCA9IGN1cnJlbnRfbWVudG9yLmdldCgibWVu
dG9yX2lkIikKICAgICAgICAKICAgICAgICAjIEdldCBhbGwgaW5kaWNhdG9ycyBmb3IgdGhpcyBt
ZW50b3IKICAgICAgICBpbmRpY2F0b3JzX2N1cnNvciA9IGRiLmN1c3RvbV9pbmRpY2F0b3JzLmZp
bmQoewogICAgICAgICAgICAibWVudG9yX2lkIjogbWVudG9yX2lkLAogICAgICAgICAgICAic3Rh
dHVzIjogImFjdGl2ZSIKICAgICAgICB9KS5zb3J0KCJjcmVhdGVkX2F0IiwgLTEpCiAgICAgICAg
CiAgICAgICAgaW5kaWNhdG9yc19saXN0ID0gYXdhaXQgaW5kaWNhdG9yc19jdXJzb3IudG9fbGlz
dChsZW5ndGg9MTAwKQogICAgICAgIAogICAgICAgICMgRm9ybWF0IGluZGljYXRvcnMKICAgICAg
ICBmb3JtYXR0ZWRfaW5kaWNhdG9ycyA9IFtdCiAgICAgICAgZm9yIGluZCBpbiBpbmRpY2F0b3Jz
X2xpc3Q6CiAgICAgICAgICAgIGZvcm1hdHRlZF9pbmRpY2F0b3JzLmFwcGVuZCh7CiAgICAgICAg
ICAgICAgICAiaWQiOiBzdHIoaW5kWyJfaWQiXSksCiAgICAgICAgICAgICAgICAibmFtZSI6IGlu
ZFsibmFtZSJdLAogICAgICAgICAgICAgICAgImRlc2NyaXB0aW9uIjogaW5kLmdldCgiZGVzY3Jp
cHRpb24iLCAiIiksCiAgICAgICAgICAgICAgICAiY3VycmVudF9zaWduYWwiOiBpbmQuZ2V0KCJj
dXJyZW50X3NpZ25hbCIsICJOT05FIiksCiAgICAgICAgICAgICAgICAiaXNfcnVubmluZyI6IGlu
ZC5nZXQoImlzX3J1bm5pbmciLCBGYWxzZSksCiAgICAgICAgICAgICAgICAiY3JlYXRlZF9hdCI6
IGluZFsiY3JlYXRlZF9hdCJdLmlzb2Zvcm1hdCgpLAogICAgICAgICAgICAgICAgInVwZGF0ZWRf
YXQiOiBpbmQuZ2V0KCJ1cGRhdGVkX2F0IiwgaW5kWyJjcmVhdGVkX2F0Il0pLmlzb2Zvcm1hdCgp
CiAgICAgICAgICAgIH0pCiAgICAgICAgCiAgICAgICAgcmV0dXJuIHsiaW5kaWNhdG9ycyI6IGZv
cm1hdHRlZF9pbmRpY2F0b3JzfQogICAgICAgIAogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgog
ICAgICAgIGxvZ2dlci5lcnJvcihmIkVycm9yIGZldGNoaW5nIG1lbnRvciBpbmRpY2F0b3JzOiB7
c3RyKGUpfSIpCiAgICAgICAgcmFpc2UgSFRUUEV4Y2VwdGlvbihzdGF0dXNfY29kZT01MDAsIGRl
dGFpbD1mIkZhaWxlZCB0byBmZXRjaCBpbmRpY2F0b3JzOiB7c3RyKGUpfSIpCgoKQGFwaV9yb3V0
ZXIucG9zdCgiL21lbnRvci91cGRhdGUtaW5kaWNhdG9yLXNpZ25hbCIpCmFzeW5jIGRlZiB1cGRh
dGVfaW5kaWNhdG9yX3NpZ25hbChzaWduYWxfdXBkYXRlOiBJbmRpY2F0b3JTaWduYWxVcGRhdGUs
IGN1cnJlbnRfbWVudG9yID0gRGVwZW5kcyhnZXRfY3VycmVudF9tZW50b3IpKToKICAgICIiIgog
ICAgTWVudG9yIHVwZGF0ZXMgdGhlIHNpZ25hbCBmb3IgYW4gaW5kaWNhdG9yIChCVVkvU0VMTC9O
T05FKQogICAgQXV0b21hdGljYWxseSBzZW5kcyBub3RpZmljYXRpb24gdG8gQUxMIHVzZXJzIHVu
ZGVyIHRoaXMgbWVudG9yCiAgICAiIiIKICAgIHRyeToKICAgICAgICBtZW50b3JfaWQgPSBjdXJy
ZW50X21lbnRvci5nZXQoIm1lbnRvcl9pZCIpCiAgICAgICAgaW5kaWNhdG9yX2lkID0gc2lnbmFs
X3VwZGF0ZS5pbmRpY2F0b3JfaWQKICAgICAgICBuZXdfc2lnbmFsID0gc2lnbmFsX3VwZGF0ZS5z
aWduYWwudXBwZXIoKQogICAgICAgIAogICAgICAgICMgVmFsaWRhdGUgc2lnbmFsCiAgICAgICAg
aWYgbmV3X3NpZ25hbCBub3QgaW4gWyJCVVkiLCAiU0VMTCIsICJOT05FIl06CiAgICAgICAgICAg
IHJhaXNlIEhUVFBFeGNlcHRpb24oc3RhdHVzX2NvZGU9NDAwLCBkZXRhaWw9IlNpZ25hbCBtdXN0
IGJlIEJVWSwgU0VMTCwgb3IgTk9ORSIpCiAgICAgICAgCiAgICAgICAgIyBWZXJpZnkgaW5kaWNh
dG9yIGJlbG9uZ3MgdG8gdGhpcyBtZW50b3IKICAgICAgICBpbmRpY2F0b3IgPSBhd2FpdCBkYi5j
dXN0b21faW5kaWNhdG9ycy5maW5kX29uZSh7CiAgICAgICAgICAgICJfaWQiOiBPYmplY3RJZChp
bmRpY2F0b3JfaWQpLAogICAgICAgICAgICAibWVudG9yX2lkIjogbWVudG9yX2lkCiAgICAgICAg
fSkKICAgICAgICAKICAgICAgICBpZiBub3QgaW5kaWNhdG9yOgogICAgICAgICAgICByYWlzZSBI
VFRQRXhjZXB0aW9uKHN0YXR1c19jb2RlPTQwNCwgZGV0YWlsPSJJbmRpY2F0b3Igbm90IGZvdW5k
IG9yIGRvZXNuJ3QgYmVsb25nIHRvIHlvdSIpCiAgICAgICAgCiAgICAgICAgIyBVcGRhdGUgaW5k
aWNhdG9yIHNpZ25hbAogICAgICAgIGF3YWl0IGRiLmN1c3RvbV9pbmRpY2F0b3JzLnVwZGF0ZV9v
bmUoCiAgICAgICAgICAgIHsiX2lkIjogT2JqZWN0SWQoaW5kaWNhdG9yX2lkKX0sCiAgICAgICAg
ICAgIHsKICAgICAgICAgICAgICAgICIkc2V0IjogewogICAgICAgICAgICAgICAgICAgICJjdXJy
ZW50X3NpZ25hbCI6IG5ld19zaWduYWwsCiAgICAgICAgICAgICAgICAgICAgInVwZGF0ZWRfYXQi
OiBkYXRldGltZS51dGNub3coKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAg
ICAgKQogICAgICAgIAogICAgICAgICMgR2V0IGFsbCB1c2VycyB1bmRlciB0aGlzIG1lbnRvcgog
ICAgICAgIG1lbnRvcl91c2VycyA9IGF3YWl0IGRiLnVzZXJzLmZpbmQoewogICAgICAgICAgICAi
bWVudG9yX2lkIjogbWVudG9yX2lkLAogICAgICAgICAgICAic3RhdHVzIjogImFjdGl2ZSIsCiAg
ICAgICAgICAgICJwYXltZW50X3N0YXR1cyI6ICJwYWlkIgogICAgICAgIH0pLnRvX2xpc3QobGVu
Z3RoPTEwMDAwKQogICAgICAgIAogICAgICAgICMgQ3JlYXRlIHNpZ25hbCByZWNvcmRzIGZvciBl
YWNoIHVzZXIgKG9ubHkgZm9yIEJVWS9TRUxMLCBub3QgTk9ORSkKICAgICAgICBpZiBtZW50b3Jf
dXNlcnMgYW5kIG5ld19zaWduYWwgIT0gIk5PTkUiOgogICAgICAgICAgICAjIENyZWF0ZSBhIHNp
Z25hbCBkb2N1bWVudAogICAgICAgICAgICBleHBpcnlfdGltZSA9IGRhdGV0aW1lLnV0Y25vdygp
ICsgdGltZWRlbHRhKGhvdXJzPTI0KSAgIyAyNCBob3VyIGV4cGlyeSBmb3IgaW5kaWNhdG9yIHNp
Z25hbHMKICAgICAgICAgICAgCiAgICAgICAgICAgIHNpZ25hbF9kb2MgPSB7CiAgICAgICAgICAg
ICAgICAic3ltYm9sIjogaW5kaWNhdG9yLmdldCgic3ltYm9sIiwgaW5kaWNhdG9yWyJuYW1lIl0p
LCAgIyBVc2UgaW5kaWNhdG9yIG5hbWUgaWYgbm8gc3ltYm9sCiAgICAgICAgICAgICAgICAic2ln
bmFsX3R5cGUiOiBuZXdfc2lnbmFsLAogICAgICAgICAgICAgICAgImluZGljYXRvciI6IGluZGlj
YXRvclsibmFtZSJdLAogICAgICAgICAgICAgICAgImNhbmRsZV9wYXR0ZXJuIjogTm9uZSwKICAg
ICAgICAgICAgICAgICJ0aW1lZnJhbWUiOiBpbmRpY2F0b3IuZ2V0KCJ0aW1lZnJhbWUiLCAiTi9B
IiksCiAgICAgICAgICAgICAgICAibm90ZXMiOiBmIk1lbnRvciBjdXN0b20gaW5kaWNhdG9yIHNp
Z25hbCIsCiAgICAgICAgICAgICAgICAic2VuZGVyX3R5cGUiOiAibWVudG9yX2luZGljYXRvciIs
CiAgICAgICAgICAgICAgICAic2VuZGVyX2lkIjogbWVudG9yX2lkLAogICAgICAgICAgICAgICAg
ImluZGljYXRvcl9pZCI6IGluZGljYXRvcl9pZCwKICAgICAgICAgICAgICAgICJjcmVhdGVkX2F0
IjogZGF0ZXRpbWUudXRjbm93KCksCiAgICAgICAgICAgICAgICAiZXhwaXJlc19hdCI6IGV4cGly
eV90aW1lLAogICAgICAgICAgICAgICAgImR1cmF0aW9uX3NlY29uZHMiOiA4NjQwMCwgICMgMjQg
aG91cnMKICAgICAgICAgICAgICAgICJzdGF0dXMiOiAiYWN0aXZlIgogICAgICAgICAgICB9CiAg
ICAgICAgICAgIAogICAgICAgICAgICAjIEluc2VydCBzaWduYWwKICAgICAgICAgICAgcmVzdWx0
ID0gYXdhaXQgZGIuc2lnbmFscy5pbnNlcnRfb25lKHNpZ25hbF9kb2MpCiAgICAgICAgICAgIHNp
Z25hbF9pZCA9IHN0cihyZXN1bHQuaW5zZXJ0ZWRfaWQpCiAgICAgICAgICAgIAogICAgICAgICAg
ICAjIENyZWF0ZSB1c2VyX3NpZ25hbHMgcmVmZXJlbmNlIGZvciBlYWNoIHVzZXIKICAgICAgICAg
ICAgZm9yIHVzZXIgaW4gbWVudG9yX3VzZXJzOgogICAgICAgICAgICAgICAgYXdhaXQgZGIudXNl
cl9zaWduYWxzLmluc2VydF9vbmUoewogICAgICAgICAgICAgICAgICAgICJzaWduYWxfaWQiOiBz
aWduYWxfaWQsCiAgICAgICAgICAgICAgICAgICAgInVzZXJfaWQiOiBzdHIodXNlclsiX2lkIl0p
LAogICAgICAgICAgICAgICAgICAgICJyZWFkIjogRmFsc2UsCiAgICAgICAgICAgICAgICAgICAg
ImNyZWF0ZWRfYXQiOiBkYXRldGltZS51dGNub3coKQogICAgICAgICAgICAgICAgfSkKICAgICAg
ICAgICAgCiAgICAgICAgICAgIGxvZ2dlci5pbmZvKGYi4pyFIENyZWF0ZWQgc2lnbmFsIHtzaWdu
YWxfaWR9IGZvciB7bGVuKG1lbnRvcl91c2Vycyl9IHVzZXJzIGZyb20gaW5kaWNhdG9yIHtpbmRp
Y2F0b3JbJ25hbWUnXX0iKQogICAgICAgIAogICAgICAgICMgU2VuZCBwdXNoIG5vdGlmaWNhdGlv
bnMgdG8gYWxsIG1lbnRvcidzIHVzZXJzCiAgICAgICAgaWYgbWVudG9yX3VzZXJzIGFuZCBuZXdf
c2lnbmFsICE9ICJOT05FIjoKICAgICAgICAgICAgdG9rZW5zID0gYXdhaXQgZGIucHVzaF90b2tl
bnMuZmluZCh7CiAgICAgICAgICAgICAgICAidXNlcl9pZCI6IHsiJGluIjogW3N0cih1c2VyWyJf
aWQiXSkgZm9yIHVzZXIgaW4gbWVudG9yX3VzZXJzXX0KICAgICAgICAgICAgfSkudG9fbGlzdCgx
MDAwKQogICAgICAgICAgICAKICAgICAgICAgICAgaWYgdG9rZW5zOgogICAgICAgICAgICAgICAg
dGl0bGUgPSBmIvCfk4oge2luZGljYXRvclsnbmFtZSddfSIKICAgICAgICAgICAgICAgIGJvZHkg
PSBmIlNpZ25hbDoge25ld19zaWduYWx9IgogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAg
ICBtZXNzYWdlcyA9IFtdCiAgICAgICAgICAgICAgICBmb3IgdG9rZW5fZG9jIGluIHRva2VuczoK
ICAgICAgICAgICAgICAgICAgICBtZXNzYWdlcy5hcHBlbmQoewogICAgICAgICAgICAgICAgICAg
ICAgICAidG8iOiB0b2tlbl9kb2NbInRva2VuIl0sCiAgICAgICAgICAgICAgICAgICAgICAgICJz
b3VuZCI6ICJkZWZhdWx0IiwKICAgICAgICAgICAgICAgICAgICAgICAgInRpdGxlIjogdGl0bGUs
CiAgICAgICAgICAgICAgICAgICAgICAgICJib2R5IjogYm9keSwKICAgICAgICAgICAgICAgICAg
ICAgICAgImRhdGEiOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiaW5kaWNhdG9yX2lk
IjogaW5kaWNhdG9yX2lkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgImluZGljYXRvcl9u
YW1lIjogaW5kaWNhdG9yWyJuYW1lIl0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAic2ln
bmFsIjogbmV3X3NpZ25hbCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ0eXBlIjogImlu
ZGljYXRvcl9zaWduYWwiCiAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAg
ICAgICAgICAgICJwcmlvcml0eSI6ICJoaWdoIiwKICAgICAgICAgICAgICAgICAgICAgICAgImNo
YW5uZWxJZCI6ICJkZWZhdWx0IgogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAg
ICAKICAgICAgICAgICAgICAgICMgU2VuZCBub3RpZmljYXRpb25zCiAgICAgICAgICAgICAgICBh
c3luYyB3aXRoIGh0dHB4LkFzeW5jQ2xpZW50KCkgYXMgY2xpZW50OgogICAgICAgICAgICAgICAg
ICAgIHJlc3BvbnNlID0gYXdhaXQgY2xpZW50LnBvc3QoCiAgICAgICAgICAgICAgICAgICAgICAg
ICdodHRwczovL2V4cC5ob3N0Ly0tL2FwaS92Mi9wdXNoL3NlbmQnLAogICAgICAgICAgICAgICAg
ICAgICAgICBqc29uPW1lc3NhZ2VzLAogICAgICAgICAgICAgICAgICAgICAgICB0aW1lb3V0PTEw
LjAKICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmluZm8o
ZiJJbmRpY2F0b3Igc2lnbmFsIG5vdGlmaWNhdGlvbiBzZW50IHRvIHtsZW4obWVzc2FnZXMpfSB1
c2Vyczoge3Jlc3BvbnNlLnN0YXR1c19jb2RlfSIpCiAgICAgICAgCiAgICAgICAgbG9nZ2VyLmlu
Zm8oZiLinIUgTWVudG9yIHttZW50b3JfaWR9IHVwZGF0ZWQgaW5kaWNhdG9yICd7aW5kaWNhdG9y
WyduYW1lJ119JyBzaWduYWwgdG8ge25ld19zaWduYWx9IikKICAgICAgICAKICAgICAgICByZXR1
cm4gewogICAgICAgICAgICAibWVzc2FnZSI6ICJJbmRpY2F0b3Igc2lnbmFsIHVwZGF0ZWQgc3Vj
Y2Vzc2Z1bGx5IiwKICAgICAgICAgICAgImluZGljYXRvcl9pZCI6IGluZGljYXRvcl9pZCwKICAg
ICAgICAgICAgImluZGljYXRvcl9uYW1lIjogaW5kaWNhdG9yWyJuYW1lIl0sCiAgICAgICAgICAg
ICJzaWduYWwiOiBuZXdfc2lnbmFsLAogICAgICAgICAgICAidXNlcnNfbm90aWZpZWQiOiBsZW4o
bWVudG9yX3VzZXJzKSBpZiBuZXdfc2lnbmFsICE9ICJOT05FIiBlbHNlIDAKICAgICAgICB9CiAg
ICAgICAgCiAgICBleGNlcHQgSFRUUEV4Y2VwdGlvbjoKICAgICAgICByYWlzZQogICAgZXhjZXB0
IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIGxvZ2dlci5lcnJvcihmIkVycm9yIHVwZGF0aW5nIGlu
ZGljYXRvciBzaWduYWw6IHtzdHIoZSl9IikKICAgICAgICByYWlzZSBIVFRQRXhjZXB0aW9uKHN0
YXR1c19jb2RlPTUwMCwgZGV0YWlsPWYiRmFpbGVkIHRvIHVwZGF0ZSBpbmRpY2F0b3Igc2lnbmFs
OiB7c3RyKGUpfSIpCgoKQGFwaV9yb3V0ZXIucG9zdCgiL21lbnRvci9tYW51YWwtb3ZlcnJpZGUt
c2lnbmFsIikKYXN5bmMgZGVmIG1hbnVhbF9vdmVycmlkZV9zaWduYWwob3ZlcnJpZGU6IE1hbnVh
bE92ZXJyaWRlU2lnbmFsLCBjdXJyZW50X21lbnRvciA9IERlcGVuZHMoZ2V0X2N1cnJlbnRfbWVu
dG9yKSk6CiAgICAiIiIKICAgIE1lbnRvciBtYW51YWxseSBzZW5kcyBCVVkvU0VMTCBzaWduYWwg
dG8gQUxMIHVzZXJzIHN1YnNjcmliZWQgdG8gdGhpcyBpbmRpY2F0b3IKICAgIFRoaXMgb3ZlcnJp
ZGVzIGF1dG9tYXRpYyBjb25kaXRpb24gY2hlY2tpbmcKICAgICIiIgogICAgdHJ5OgogICAgICAg
IG1lbnRvcl9pZCA9IGN1cnJlbnRfbWVudG9yLmdldCgibWVudG9yX2lkIikKICAgICAgICBpbmRp
Y2F0b3JfaWQgPSBvdmVycmlkZS5pbmRpY2F0b3JfaWQKICAgICAgICBzaWduYWwgPSBvdmVycmlk
ZS5zaWduYWwudXBwZXIoKQogICAgICAgIAogICAgICAgICMgVmFsaWRhdGUgc2lnbmFsCiAgICAg
ICAgaWYgc2lnbmFsIG5vdCBpbiBbIkJVWSIsICJTRUxMIl06CiAgICAgICAgICAgIHJhaXNlIEhU
VFBFeGNlcHRpb24oc3RhdHVzX2NvZGU9NDAwLCBkZXRhaWw9IlNpZ25hbCBtdXN0IGJlIEJVWSBv
ciBTRUxMIikKICAgICAgICAKICAgICAgICAjIFZlcmlmeSBpbmRpY2F0b3IgYmVsb25ncyB0byB0
aGlzIG1lbnRvcgogICAgICAgIGluZGljYXRvciA9IGF3YWl0IGRiLmN1c3RvbV9pbmRpY2F0b3Jz
LmZpbmRfb25lKHsKICAgICAgICAgICAgIl9pZCI6IE9iamVjdElkKGluZGljYXRvcl9pZCksCiAg
ICAgICAgICAgICJtZW50b3JfaWQiOiBtZW50b3JfaWQsCiAgICAgICAgICAgICJzdGF0dXMiOiAi
YWN0aXZlIgogICAgICAgIH0pCiAgICAgICAgCiAgICAgICAgaWYgbm90IGluZGljYXRvcjoKICAg
ICAgICAgICAgcmFpc2UgSFRUUEV4Y2VwdGlvbihzdGF0dXNfY29kZT00MDQsIGRldGFpbD0iSW5k
aWNhdG9yIG5vdCBmb3VuZCBvciBkb2Vzbid0IGJlbG9uZyB0byB5b3UiKQogICAgICAgIAogICAg
ICAgICMgR2V0IEFMTCBzdWJzY3JpcHRpb25zIGZvciB0aGlzIGluZGljYXRvciAoYWxsIHVzZXJz
LCBhbGwgc3ltYm9scykKICAgICAgICBzdWJzY3JpcHRpb25zID0gYXdhaXQgZGIudXNlcl9pbmRp
Y2F0b3Jfc3Vic2NyaXB0aW9ucy5maW5kKHsKICAgICAgICAgICAgImluZGljYXRvcl9pZCI6IGlu
ZGljYXRvcl9pZCwKICAgICAgICAgICAgInN0YXR1cyI6ICJhY3RpdmUiCiAgICAgICAgfSkudG9f
bGlzdChsZW5ndGg9MTAwMCkKICAgICAgICAKICAgICAgICBpZiBub3Qgc3Vic2NyaXB0aW9uczoK
ICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgICJtZXNzYWdlIjogIk5vIGFjdGl2
ZSBzdWJzY3JpcHRpb25zIGZvciB0aGlzIGluZGljYXRvciIsCiAgICAgICAgICAgICAgICAidXNl
cnNfbm90aWZpZWQiOiAwCiAgICAgICAgICAgIH0KICAgICAgICAKICAgICAgICAjIENyZWF0ZSBz
aWduYWxzIGZvciBlYWNoIHN1YnNjcmlwdGlvbgogICAgICAgIHNpZ25hbHNfY3JlYXRlZCA9IDAK
ICAgICAgICB1c2VyX2lkcyA9IFtdCiAgICAgICAgCiAgICAgICAgZm9yIHN1YiBpbiBzdWJzY3Jp
cHRpb25zOgogICAgICAgICAgICAjIENyZWF0ZSBzaWduYWwgZG9jdW1lbnQKICAgICAgICAgICAg
ZXhwaXJ5X3RpbWUgPSBkYXRldGltZS51dGNub3coKSArIHRpbWVkZWx0YShob3Vycz0yNCkKICAg
ICAgICAgICAgCiAgICAgICAgICAgIHNpZ25hbF9kb2MgPSB7CiAgICAgICAgICAgICAgICAic3lt
Ym9sIjogc3ViWyJ1c2VyX3NlbGVjdGVkX3N5bWJvbCJdLAogICAgICAgICAgICAgICAgInNpZ25h
bF90eXBlIjogc2lnbmFsLAogICAgICAgICAgICAgICAgImluZGljYXRvciI6IGluZGljYXRvclsi
bmFtZSJdLAogICAgICAgICAgICAgICAgImNhbmRsZV9wYXR0ZXJuIjogTm9uZSwKICAgICAgICAg
ICAgICAgICJ0aW1lZnJhbWUiOiBzdWJbInVzZXJfc2VsZWN0ZWRfdGltZWZyYW1lIl0sCiAgICAg
ICAgICAgICAgICAibm90ZXMiOiBmIk1hbnVhbCBvdmVycmlkZSBieSBtZW50b3IiLAogICAgICAg
ICAgICAgICAgInNlbmRlcl90eXBlIjogIm1lbnRvcl9tYW51YWxfb3ZlcnJpZGUiLAogICAgICAg
ICAgICAgICAgInNlbmRlcl9pZCI6IG1lbnRvcl9pZCwKICAgICAgICAgICAgICAgICJpbmRpY2F0
b3JfaWQiOiBpbmRpY2F0b3JfaWQsCiAgICAgICAgICAgICAgICAic3Vic2NyaXB0aW9uX2lkIjog
c3RyKHN1YlsiX2lkIl0pLAogICAgICAgICAgICAgICAgImNyZWF0ZWRfYXQiOiBkYXRldGltZS51
dGNub3coKSwKICAgICAgICAgICAgICAgICJleHBpcmVzX2F0IjogZXhwaXJ5X3RpbWUsCiAgICAg
ICAgICAgICAgICAiZHVyYXRpb25fc2Vjb25kcyI6IDg2NDAwLAogICAgICAgICAgICAgICAgInN0
YXR1cyI6ICJhY3RpdmUiCiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICAgIHJl
c3VsdCA9IGF3YWl0IGRiLnNpZ25hbHMuaW5zZXJ0X29uZShzaWduYWxfZG9jKQogICAgICAgICAg
ICBzaWduYWxfaWQgPSBzdHIocmVzdWx0Lmluc2VydGVkX2lkKQogICAgICAgICAgICAKICAgICAg
ICAgICAgIyBDcmVhdGUgdXNlcl9zaWduYWxzIHJlZmVyZW5jZQogICAgICAgICAgICBhd2FpdCBk
Yi51c2VyX3NpZ25hbHMuaW5zZXJ0X29uZSh7CiAgICAgICAgICAgICAgICAic2lnbmFsX2lkIjog
c2lnbmFsX2lkLAogICAgICAgICAgICAgICAgInVzZXJfaWQiOiBzdWJbInVzZXJfaWQiXSwKICAg
ICAgICAgICAgICAgICJyZWFkIjogRmFsc2UsCiAgICAgICAgICAgICAgICAiY3JlYXRlZF9hdCI6
IGRhdGV0aW1lLnV0Y25vdygpCiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIAogICAgICAgICAg
ICAjIFVwZGF0ZSBzdWJzY3JpcHRpb24gc3RhdHMKICAgICAgICAgICAgYXdhaXQgZGIudXNlcl9p
bmRpY2F0b3Jfc3Vic2NyaXB0aW9ucy51cGRhdGVfb25lKAogICAgICAgICAgICAgICAgeyJfaWQi
OiBzdWJbIl9pZCJdfSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAiJHNl
dCI6IHsKICAgICAgICAgICAgICAgICAgICAgICAgImxhc3Rfc2lnbmFsX3RpbWUiOiBkYXRldGlt
ZS51dGNub3coKSwKICAgICAgICAgICAgICAgICAgICAgICAgImxhc3Rfc2lnbmFsX3R5cGUiOiBz
aWduYWwKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICIkaW5jIjog
eyJ0b3RhbF9zaWduYWxzX3JlY2VpdmVkIjogMX0KICAgICAgICAgICAgICAgIH0KICAgICAgICAg
ICAgKQogICAgICAgICAgICAKICAgICAgICAgICAgc2lnbmFsc19jcmVhdGVkICs9IDEKICAgICAg
ICAgICAgdXNlcl9pZHMuYXBwZW5kKHN1YlsidXNlcl9pZCJdKQogICAgICAgIAogICAgICAgICMg
U2VuZCBwdXNoIG5vdGlmaWNhdGlvbnMKICAgICAgICBpZiB1c2VyX2lkczoKICAgICAgICAgICAg
dG9rZW5zID0gYXdhaXQgZGIucHVzaF90b2tlbnMuZmluZCh7CiAgICAgICAgICAgICAgICAidXNl
cl9pZCI6IHsiJGluIjogdXNlcl9pZHN9CiAgICAgICAgICAgIH0pLnRvX2xpc3QoMTAwMCkKICAg
ICAgICAgICAgCiAgICAgICAgICAgIGlmIHRva2VuczoKICAgICAgICAgICAgICAgIHRpdGxlID0g
ZiLwn5OKIHtpbmRpY2F0b3JbJ25hbWUnXX0gLSBNYW51YWwgU2lnbmFsIgogICAgICAgICAgICAg
ICAgYm9keSA9IGYiTWVudG9yIE92ZXJyaWRlOiB7c2lnbmFsfSIKICAgICAgICAgICAgICAgIAog
ICAgICAgICAgICAgICAgbWVzc2FnZXMgPSBbXQogICAgICAgICAgICAgICAgZm9yIHRva2VuX2Rv
YyBpbiB0b2tlbnM6CiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZXMuYXBwZW5kKHsKICAgICAg
ICAgICAgICAgICAgICAgICAgInRvIjogdG9rZW5fZG9jWyJ0b2tlbiJdLAogICAgICAgICAgICAg
ICAgICAgICAgICAic291bmQiOiAiZGVmYXVsdCIsCiAgICAgICAgICAgICAgICAgICAgICAgICJ0
aXRsZSI6IHRpdGxlLAogICAgICAgICAgICAgICAgICAgICAgICAiYm9keSI6IGJvZHksCiAgICAg
ICAgICAgICAgICAgICAgICAgICJkYXRhIjogewogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ImluZGljYXRvcl9pZCI6IGluZGljYXRvcl9pZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICJpbmRpY2F0b3JfbmFtZSI6IGluZGljYXRvclsibmFtZSJdLAogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgInNpZ25hbCI6IHNpZ25hbCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ0
eXBlIjogIm1hbnVhbF9vdmVycmlkZSIKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAg
ICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICMgU2VuZCBu
b3RpZmljYXRpb25zIGluIGJhdGNoZXMKICAgICAgICAgICAgICAgIGZvciBpIGluIHJhbmdlKDAs
IGxlbihtZXNzYWdlcyksIDEwMCk6CiAgICAgICAgICAgICAgICAgICAgYmF0Y2ggPSBtZXNzYWdl
c1tpOmkrMTAwXQogICAgICAgICAgICAgICAgICAgIGF3YWl0IHNlbmRfcHVzaF9ub3RpZmljYXRp
b25zX2JhdGNoKGJhdGNoKQogICAgICAgIAogICAgICAgIGxvZ2dlci5pbmZvKGYi4pyFIE1lbnRv
ciB7bWVudG9yX2lkfSBzZW50IG1hbnVhbCBvdmVycmlkZSB7c2lnbmFsfSBmb3IgJ3tpbmRpY2F0
b3JbJ25hbWUnXX0nIHRvIHtzaWduYWxzX2NyZWF0ZWR9IHVzZXJzIikKICAgICAgICAKICAgICAg
ICByZXR1cm4gewogICAgICAgICAgICAibWVzc2FnZSI6IGYiTWFudWFsIHtzaWduYWx9IHNpZ25h
bCBzZW50IHRvIGFsbCBzdWJzY3JpYmVycyIsCiAgICAgICAgICAgICJpbmRpY2F0b3JfbmFtZSI6
IGluZGljYXRvclsibmFtZSJdLAogICAgICAgICAgICAic2lnbmFsIjogc2lnbmFsLAogICAgICAg
ICAgICAidXNlcnNfbm90aWZpZWQiOiBzaWduYWxzX2NyZWF0ZWQsCiAgICAgICAgICAgICJzdWJz
Y3JpcHRpb25zX2FmZmVjdGVkIjogc2lnbmFsc19jcmVhdGVkCiAgICAgICAgfQogICAgICAgIAog
ICAgZXhjZXB0IEhUVFBFeGNlcHRpb246CiAgICAgICAgcmFpc2UKICAgIGV4Y2VwdCBFeGNlcHRp
b24gYXMgZToKICAgICAgICBsb2dnZXIuZXJyb3IoZiJFcnJvciBzZW5kaW5nIG1hbnVhbCBvdmVy
cmlkZToge3N0cihlKX0iKQogICAgICAgIHJhaXNlIEhUVFBFeGNlcHRpb24oc3RhdHVzX2NvZGU9
NTAwLCBkZXRhaWw9ZiJGYWlsZWQgdG8gc2VuZCBtYW51YWwgb3ZlcnJpZGU6IHtzdHIoZSl9IikK
CgpAYXBpX3JvdXRlci5wb3N0KCIvbWVudG9yL3RvZ2dsZS1pbmRpY2F0b3Ive2luZGljYXRvcl9p
ZH0iKQphc3luYyBkZWYgdG9nZ2xlX2luZGljYXRvcl9zdGF0dXMoaW5kaWNhdG9yX2lkOiBzdHIs
IGN1cnJlbnRfbWVudG9yID0gRGVwZW5kcyhnZXRfY3VycmVudF9tZW50b3IpKToKICAgICIiIgog
ICAgTWVudG9yIHRvZ2dsZXMgaW5kaWNhdG9yIFNUQVJUL1NUT1Agc3RhdHVzCiAgICBXaGVuIHJ1
bm5pbmc9VHJ1ZSwgaW5kaWNhdG9yIGlzIHZpc2libGUgdG8gdXNlcnMKICAgICIiIgogICAgdHJ5
OgogICAgICAgIG1lbnRvcl9pZCA9IGN1cnJlbnRfbWVudG9yLmdldCgibWVudG9yX2lkIikKICAg
ICAgICAKICAgICAgICAjIFZlcmlmeSBpbmRpY2F0b3IgYmVsb25ncyB0byB0aGlzIG1lbnRvcgog
ICAgICAgIGluZGljYXRvciA9IGF3YWl0IGRiLmN1c3RvbV9pbmRpY2F0b3JzLmZpbmRfb25lKHsK
ICAgICAgICAgICAgIl9pZCI6IE9iamVjdElkKGluZGljYXRvcl9pZCksCiAgICAgICAgICAgICJt
ZW50b3JfaWQiOiBtZW50b3JfaWQKICAgICAgICB9KQogICAgICAgIAogICAgICAgIGlmIG5vdCBp
bmRpY2F0b3I6CiAgICAgICAgICAgIHJhaXNlIEhUVFBFeGNlcHRpb24oc3RhdHVzX2NvZGU9NDA0
LCBkZXRhaWw9IkluZGljYXRvciBub3QgZm91bmQgb3IgZG9lc24ndCBiZWxvbmcgdG8geW91IikK
ICAgICAgICAKICAgICAgICAjIFRvZ2dsZSBpc19ydW5uaW5nIHN0YXR1cwogICAgICAgIG5ld19z
dGF0dXMgPSBub3QgaW5kaWNhdG9yLmdldCgiaXNfcnVubmluZyIsIEZhbHNlKQogICAgICAgIAog
ICAgICAgIGF3YWl0IGRiLmN1c3RvbV9pbmRpY2F0b3JzLnVwZGF0ZV9vbmUoCiAgICAgICAgICAg
IHsiX2lkIjogT2JqZWN0SWQoaW5kaWNhdG9yX2lkKX0sCiAgICAgICAgICAgIHsKICAgICAgICAg
ICAgICAgICIkc2V0IjogewogICAgICAgICAgICAgICAgICAgICJpc19ydW5uaW5nIjogbmV3X3N0
YXR1cywKICAgICAgICAgICAgICAgICAgICAidXBkYXRlZF9hdCI6IGRhdGV0aW1lLnV0Y25vdygp
CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICApCiAgICAgICAgCiAgICAg
ICAgc3RhdHVzX3RleHQgPSAiU1RBUlRFRCIgaWYgbmV3X3N0YXR1cyBlbHNlICJTVE9QUEVEIgog
ICAgICAgIGxvZ2dlci5pbmZvKGYi4pyFIE1lbnRvciB7bWVudG9yX2lkfSB7c3RhdHVzX3RleHR9
IGluZGljYXRvcjogJ3tpbmRpY2F0b3JbJ25hbWUnXX0nIikKICAgICAgICAKICAgICAgICByZXR1
cm4gewogICAgICAgICAgICAibWVzc2FnZSI6IGYiSW5kaWNhdG9yIHtzdGF0dXNfdGV4dC5sb3dl
cigpfSBzdWNjZXNzZnVsbHkiLAogICAgICAgICAgICAiaW5kaWNhdG9yX2lkIjogaW5kaWNhdG9y
X2lkLAogICAgICAgICAgICAiaW5kaWNhdG9yX25hbWUiOiBpbmRpY2F0b3JbIm5hbWUiXSwKICAg
ICAgICAgICAgImlzX3J1bm5pbmciOiBuZXdfc3RhdHVzCiAgICAgICAgfQogICAgICAgIAogICAg
ZXhjZXB0IEhUVFBFeGNlcHRpb246CiAgICAgICAgcmFpc2UKICAgIGV4Y2VwdCBFeGNlcHRpb24g
YXMgZToKICAgICAgICBsb2dnZXIuZXJyb3IoZiJFcnJvciB0b2dnbGluZyBpbmRpY2F0b3Igc3Rh
dHVzOiB7c3RyKGUpfSIpCiAgICAgICAgcmFpc2UgSFRUUEV4Y2VwdGlvbihzdGF0dXNfY29kZT01
MDAsIGRldGFpbD1mIkZhaWxlZCB0byB0b2dnbGUgaW5kaWNhdG9yOiB7c3RyKGUpfSIpCgoKQGFw
aV9yb3V0ZXIuZGVsZXRlKCIvbWVudG9yL2RlbGV0ZS1pbmRpY2F0b3Ive2luZGljYXRvcl9pZH0i
KQphc3luYyBkZWYgZGVsZXRlX2luZGljYXRvcihpbmRpY2F0b3JfaWQ6IHN0ciwgY3VycmVudF9t
ZW50b3IgPSBEZXBlbmRzKGdldF9jdXJyZW50X21lbnRvcikpOgogICAgIiIiCiAgICBNZW50b3Ig
ZGVsZXRlcyBhIGN1c3RvbSBpbmRpY2F0b3IKICAgICIiIgogICAgdHJ5OgogICAgICAgIG1lbnRv
cl9pZCA9IGN1cnJlbnRfbWVudG9yLmdldCgibWVudG9yX2lkIikKICAgICAgICAKICAgICAgICBs
b2dnZXIuaW5mbyhmIvCfl5HvuI8gIERFTEVURSBSRVFVRVNUOiBNZW50b3Ige21lbnRvcl9pZH0g
YXR0ZW1wdGluZyB0byBkZWxldGUgaW5kaWNhdG9yIHtpbmRpY2F0b3JfaWR9IikKICAgICAgICBs
b2dnZXIuaW5mbyhmIvCflI0gUXVlcnk6IF9pZD17aW5kaWNhdG9yX2lkfSAoT2JqZWN0SWQpLCBt
ZW50b3JfaWQ9e21lbnRvcl9pZH0gKHR5cGU6IHt0eXBlKG1lbnRvcl9pZCl9KSIpCiAgICAgICAg
CiAgICAgICAgIyBGaXJzdCBjaGVjayBpZiBpbmRpY2F0b3IgZXhpc3RzIGF0IGFsbAogICAgICAg
IGFueV9pbmRpY2F0b3IgPSBhd2FpdCBkYi5jdXN0b21faW5kaWNhdG9ycy5maW5kX29uZSh7Il9p
ZCI6IE9iamVjdElkKGluZGljYXRvcl9pZCl9KQogICAgICAgIGlmIGFueV9pbmRpY2F0b3I6CiAg
ICAgICAgICAgIGxvZ2dlci5pbmZvKGYi8J+TiyBJbmRpY2F0b3IgRVhJU1RTOiBuYW1lPSd7YW55
X2luZGljYXRvci5nZXQoJ25hbWUnKX0nLCBtZW50b3JfaWQ9e2FueV9pbmRpY2F0b3IuZ2V0KCdt
ZW50b3JfaWQnKX0gKHR5cGU6IHt0eXBlKGFueV9pbmRpY2F0b3IuZ2V0KCdtZW50b3JfaWQnKSl9
KSIpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgbG9nZ2VyLndhcm5pbmcoZiLinYwgSW5kaWNh
dG9yIHtpbmRpY2F0b3JfaWR9IGRvZXMgTk9UIGV4aXN0IGluIGRhdGFiYXNlIGF0IGFsbCIpCiAg
ICAgICAgCiAgICAgICAgIyBWZXJpZnkgaW5kaWNhdG9yIGJlbG9uZ3MgdG8gdGhpcyBtZW50b3IK
ICAgICAgICBpbmRpY2F0b3IgPSBhd2FpdCBkYi5jdXN0b21faW5kaWNhdG9ycy5maW5kX29uZSh7
CiAgICAgICAgICAgICJfaWQiOiBPYmplY3RJZChpbmRpY2F0b3JfaWQpLAogICAgICAgICAgICAi
bWVudG9yX2lkIjogbWVudG9yX2lkCiAgICAgICAgfSkKICAgICAgICAKICAgICAgICBpZiBub3Qg
aW5kaWNhdG9yOgogICAgICAgICAgICBsb2dnZXIud2FybmluZyhmIuKdjCBJbmRpY2F0b3Ige2lu
ZGljYXRvcl9pZH0gbm90IGZvdW5kIGZvciBtZW50b3Ige21lbnRvcl9pZH0gKHF1ZXJ5IHJldHVy
bmVkIE5vbmUpIikKICAgICAgICAgICAgcmFpc2UgSFRUUEV4Y2VwdGlvbihzdGF0dXNfY29kZT00
MDQsIGRldGFpbD0iSW5kaWNhdG9yIG5vdCBmb3VuZCBvciBkb2Vzbid0IGJlbG9uZyB0byB5b3Ui
KQogICAgICAgIAogICAgICAgIGxvZ2dlci5pbmZvKGYi4pyFIEZvdW5kIGluZGljYXRvciAne2lu
ZGljYXRvclsnbmFtZSddfScsIHByb2NlZWRpbmcgd2l0aCBkZWxldGlvbiIpCiAgICAgICAgCiAg
ICAgICAgIyBTb2Z0IGRlbGV0ZSAtIG1hcmsgYXMgaW5hY3RpdmUKICAgICAgICBhd2FpdCBkYi5j
dXN0b21faW5kaWNhdG9ycy51cGRhdGVfb25lKAogICAgICAgICAgICB7Il9pZCI6IE9iamVjdElk
KGluZGljYXRvcl9pZCl9LAogICAgICAgICAgICB7IiRzZXQiOiB7InN0YXR1cyI6ICJkZWxldGVk
IiwgInVwZGF0ZWRfYXQiOiBkYXRldGltZS51dGNub3coKX19CiAgICAgICAgKQogICAgICAgIAog
ICAgICAgICMgUmVtb3ZlIHRoaXMgaW5kaWNhdG9yIGZyb20gdXNlcnMgd2hvIHNlbGVjdGVkIGl0
CiAgICAgICAgYXdhaXQgZGIudXNlcnMudXBkYXRlX21hbnkoCiAgICAgICAgICAgIHsic2VsZWN0
ZWRfaW5kaWNhdG9yX2lkIjogaW5kaWNhdG9yX2lkfSwKICAgICAgICAgICAgeyIkdW5zZXQiOiB7
InNlbGVjdGVkX2luZGljYXRvcl9pZCI6ICIifX0KICAgICAgICApCiAgICAgICAgCiAgICAgICAg
bG9nZ2VyLmluZm8oZiLinIUgTWVudG9yIHttZW50b3JfaWR9IGRlbGV0ZWQgaW5kaWNhdG9yOiAn
e2luZGljYXRvclsnbmFtZSddfSciKQogICAgICAgIAogICAgICAgIHJldHVybiB7CiAgICAgICAg
ICAgICJtZXNzYWdlIjogIkluZGljYXRvciBkZWxldGVkIHN1Y2Nlc3NmdWxseSIsCiAgICAgICAg
ICAgICJpbmRpY2F0b3JfaWQiOiBpbmRpY2F0b3JfaWQKICAgICAgICB9CiAgICAgICAgCiAgICBl
eGNlcHQgSFRUUEV4Y2VwdGlvbjoKICAgICAgICByYWlzZQogICAgZXhjZXB0IEV4Y2VwdGlvbiBh
cyBlOgogICAgICAgIGxvZ2dlci5lcnJvcihmIkVycm9yIGRlbGV0aW5nIGluZGljYXRvcjoge3N0
cihlKX0iKQogICAgICAgIHJhaXNlIEhUVFBFeGNlcHRpb24oc3RhdHVzX2NvZGU9NTAwLCBkZXRh
aWw9ZiJGYWlsZWQgdG8gZGVsZXRlIGluZGljYXRvcjoge3N0cihlKX0iKQoKCkBhcGlfcm91dGVy
LmdldCgiL3VzZXIvbWVudG9yLWluZGljYXRvcnMiKQphc3luYyBkZWYgZ2V0X3VzZXJfbWVudG9y
X2luZGljYXRvcnMoY3VycmVudF91c2VyID0gRGVwZW5kcyhnZXRfY3VycmVudF91c2VyKSk6CiAg
ICAiIiIKICAgIFVzZXIgZ2V0cyBhbGwgYWN0aXZlIGluZGljYXRvcnMgZnJvbSB0aGVpciBtZW50
b3IKICAgICIiIgogICAgdHJ5OgogICAgICAgIHVzZXJfbWVudG9yX2lkID0gY3VycmVudF91c2Vy
LmdldCgibWVudG9yX2lkIikKICAgICAgICAKICAgICAgICBwcmludChmIlxueyc9Jyo2MH0iKQog
ICAgICAgIHByaW50KGYi8J+UjSBGRVRDSElORyBJTkRJQ0FUT1JTIEZPUiBVU0VSIikKICAgICAg
ICBwcmludChmIvCflI0gVXNlciBlbWFpbDoge2N1cnJlbnRfdXNlci5nZXQoJ2VtYWlsJyl9IikK
ICAgICAgICBwcmludChmIvCflI0gVXNlciBtZW50b3JfaWQ6IHt1c2VyX21lbnRvcl9pZH0iKQog
ICAgICAgIHByaW50KGYieyc9Jyo2MH1cbiIpCiAgICAgICAgCiAgICAgICAgaWYgbm90IHVzZXJf
bWVudG9yX2lkOgogICAgICAgICAgICBwcmludCgi4pqg77iPICBObyBtZW50b3JfaWQgZm91bmQg
Zm9yIHVzZXIhIikKICAgICAgICAgICAgcmV0dXJuIHsiaW5kaWNhdG9ycyI6IFtdLCAic2VsZWN0
ZWRfaW5kaWNhdG9yX2lkIjogTm9uZX0KICAgICAgICAKICAgICAgICAjIEdldCBhbGwgUlVOTklO
RyBpbmRpY2F0b3JzIGZyb20gdXNlcidzIG1lbnRvciAob25seSBzaG93IHN0YXJ0ZWQgaW5kaWNh
dG9ycykKICAgICAgICBxdWVyeSA9IHsKICAgICAgICAgICAgIm1lbnRvcl9pZCI6IHVzZXJfbWVu
dG9yX2lkLAogICAgICAgICAgICAic3RhdHVzIjogImFjdGl2ZSIsCiAgICAgICAgICAgICJpc19y
dW5uaW5nIjogVHJ1ZSAgIyBPbmx5IHNob3cgaW5kaWNhdG9ycyB0aGF0IG1lbnRvciBoYXMgc3Rh
cnRlZAogICAgICAgIH0KICAgICAgICBwcmludChmIvCflI0gUXVlcnk6IHtxdWVyeX0iKQogICAg
ICAgIHByaW50KGYi8J+UjSBBYm91dCB0byBleGVjdXRlIE1vbmdvREIgZmluZC4uLiIpCiAgICAg
ICAgCiAgICAgICAgdHJ5OgogICAgICAgICAgICBpbmRpY2F0b3JzX2N1cnNvciA9IGRiLmN1c3Rv
bV9pbmRpY2F0b3JzLmZpbmQocXVlcnkpLnNvcnQoImNyZWF0ZWRfYXQiLCAtMSkKICAgICAgICAg
ICAgcHJpbnQoZiLwn5SNIEN1cnNvciBjcmVhdGVkLCBjYWxsaW5nIHRvX2xpc3QoKS4uLiIpCiAg
ICAgICAgICAgIAogICAgICAgICAgICBpbmRpY2F0b3JzX2xpc3QgPSBhd2FpdCBpbmRpY2F0b3Jz
X2N1cnNvci50b19saXN0KGxlbmd0aD0xMDApCiAgICAgICAgICAgIHByaW50KGYi8J+UjSB0b19s
aXN0KCkgY29tcGxldGVkIikKICAgICAgICAgICAgCiAgICAgICAgICAgIHByaW50KGYi4pyFIFF1
ZXJ5IGV4ZWN1dGVkIGZvciBtZW50b3JfaWQ6IHt1c2VyX21lbnRvcl9pZH0iKQogICAgICAgICAg
ICBwcmludChmIuKchSBGb3VuZCB7bGVuKGluZGljYXRvcnNfbGlzdCl9IGluZGljYXRvcnMiKQog
ICAgICAgICAgICBwcmludChmIuKchSBUeXBlOiB7dHlwZShpbmRpY2F0b3JzX2xpc3QpfSIpCiAg
ICAgICAgICAgIAogICAgICAgICAgICAjIERlYnVnOiBMZXQncyBzZWUgYWxsIGluZGljYXRvcnMg
cmVnYXJkbGVzcyBvZiBpc19ydW5uaW5nCiAgICAgICAgICAgIHByaW50KGYi8J+UjSBGZXRjaGlu
ZyBhbGwgaW5kaWNhdG9ycyBmb3IgZGVidWcuLi4iKQogICAgICAgICAgICBhbGxfaW5kaWNhdG9y
cyA9IGF3YWl0IGRiLmN1c3RvbV9pbmRpY2F0b3JzLmZpbmQoeyJtZW50b3JfaWQiOiB1c2VyX21l
bnRvcl9pZH0pLnRvX2xpc3QobGVuZ3RoPTEwMCkKICAgICAgICAgICAgcHJpbnQoZiLwn5CbIERF
QlVHOiBUb3RhbCBpbmRpY2F0b3JzIGZvciBtZW50b3I6IHtsZW4oYWxsX2luZGljYXRvcnMpfSIp
CiAgICAgICAgICAgIGZvciBpbmQgaW4gYWxsX2luZGljYXRvcnM6CiAgICAgICAgICAgICAgICBw
cmludChmIvCfkJsgICAtIHtpbmQuZ2V0KCduYW1lJyl9OiBpc19ydW5uaW5nPXtpbmQuZ2V0KCdp
c19ydW5uaW5nJyl9LCBzdGF0dXM9e2luZC5nZXQoJ3N0YXR1cycpfSIpCiAgICAgICAgZXhjZXB0
IEV4Y2VwdGlvbiBhcyBjdXJzb3JfZXJyb3I6CiAgICAgICAgICAgIHByaW50KGYi4p2MIEVSUk9S
IGluIGN1cnNvciBvcGVyYXRpb25zOiB7Y3Vyc29yX2Vycm9yfSIpCiAgICAgICAgICAgIHJhaXNl
CiAgICAgICAgbG9nZ2VyLmluZm8oZiLwn5SNIFVzZXIgbWVudG9yIElEOiB7dXNlcl9tZW50b3Jf
aWR9IikKICAgICAgICBsb2dnZXIuaW5mbyhmIvCflI0gRm91bmQge2xlbihpbmRpY2F0b3JzX2xp
c3QpfSBpbmRpY2F0b3JzIGZvciB1c2VyIikKICAgICAgICAKICAgICAgICAjIEZvcm1hdCBpbmRp
Y2F0b3JzIChzaW1wbGlmaWVkIGZvciB1c2VycyAtIG5vIHRlY2huaWNhbCBkZXRhaWxzKQogICAg
ICAgIGZvcm1hdHRlZF9pbmRpY2F0b3JzID0gW10KICAgICAgICBmb3IgaW5kIGluIGluZGljYXRv
cnNfbGlzdDoKICAgICAgICAgICAgbG9nZ2VyLmluZm8oZiIgIC0gSW5kaWNhdG9yOiB7aW5kWydu
YW1lJ119IHwgaXNfcnVubmluZzoge2luZC5nZXQoJ2lzX3J1bm5pbmcnKX0gfCBzdGF0dXM6IHtp
bmQuZ2V0KCdzdGF0dXMnKX0iKQogICAgICAgICAgICBmb3JtYXR0ZWRfaW5kaWNhdG9ycy5hcHBl
bmQoewogICAgICAgICAgICAgICAgImlkIjogc3RyKGluZFsiX2lkIl0pLAogICAgICAgICAgICAg
ICAgIm5hbWUiOiBpbmRbIm5hbWUiXSwKICAgICAgICAgICAgICAgICJjdXJyZW50X3NpZ25hbCI6
IGluZC5nZXQoImN1cnJlbnRfc2lnbmFsIiwgIk5PTkUiKSwKICAgICAgICAgICAgICAgICJ1cGRh
dGVkX2F0IjogaW5kLmdldCgidXBkYXRlZF9hdCIsIGluZFsiY3JlYXRlZF9hdCJdKS5pc29mb3Jt
YXQoKQogICAgICAgICAgICB9KQogICAgICAgIAogICAgICAgICMgR2V0IHVzZXIncyBzZWxlY3Rl
ZCBpbmRpY2F0b3IKICAgICAgICBzZWxlY3RlZF9pbmRpY2F0b3JfaWQgPSBjdXJyZW50X3VzZXIu
Z2V0KCJzZWxlY3RlZF9pbmRpY2F0b3JfaWQiKQogICAgICAgIAogICAgICAgIGxvZ2dlci5pbmZv
KGYi4pyFIFJldHVybmluZyB7bGVuKGZvcm1hdHRlZF9pbmRpY2F0b3JzKX0gaW5kaWNhdG9ycyB0
byB1c2VyIikKICAgICAgICAKICAgICAgICByZXNwb25zZV9kYXRhID0gewogICAgICAgICAgICAi
aW5kaWNhdG9ycyI6IGZvcm1hdHRlZF9pbmRpY2F0b3JzLAogICAgICAgICAgICAic2VsZWN0ZWRf
aW5kaWNhdG9yX2lkIjogc2VsZWN0ZWRfaW5kaWNhdG9yX2lkCiAgICAgICAgfQogICAgICAgIAog
ICAgICAgIHByaW50KGYiXG7wn5OkIFJFU1BPTlNFIEJFSU5HIFNFTlQgVE8gRlJPTlRFTkQ6IikK
ICAgICAgICBwcmludChmIiAgIGluZGljYXRvcnMgY291bnQ6IHtsZW4oZm9ybWF0dGVkX2luZGlj
YXRvcnMpfSIpCiAgICAgICAgcHJpbnQoZiIgICBpbmRpY2F0b3JzOiB7W2luZFsnbmFtZSddIGZv
ciBpbmQgaW4gZm9ybWF0dGVkX2luZGljYXRvcnNdfSIpCiAgICAgICAgcHJpbnQoZiIgICBGdWxs
IHJlc3BvbnNlOiB7cmVzcG9uc2VfZGF0YX1cbiIpCiAgICAgICAgCiAgICAgICAgcmV0dXJuIHJl
c3BvbnNlX2RhdGEKICAgICAgICAKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICBs
b2dnZXIuZXJyb3IoZiJFcnJvciBmZXRjaGluZyB1c2VyIG1lbnRvciBpbmRpY2F0b3JzOiB7c3Ry
KGUpfSIpCiAgICAgICAgcmFpc2UgSFRUUEV4Y2VwdGlvbihzdGF0dXNfY29kZT01MDAsIGRldGFp
bD1mIkZhaWxlZCB0byBmZXRjaCBpbmRpY2F0b3JzOiB7c3RyKGUpfSIpCgoKQGFwaV9yb3V0ZXIu
cG9zdCgiL3VzZXIvc2VsZWN0LWluZGljYXRvciIpCmFzeW5jIGRlZiB1c2VyX3NlbGVjdF9pbmRp
Y2F0b3Ioc2VsZWN0aW9uOiBVc2VySW5kaWNhdG9yU2VsZWN0aW9uLCBjdXJyZW50X3VzZXIgPSBE
ZXBlbmRzKGdldF9jdXJyZW50X3VzZXIpKToKICAgICIiIgogICAgVXNlciBzZWxlY3RzIHdoaWNo
IGluZGljYXRvciB0byBmb2xsb3cgZnJvbSB0aGVpciBtZW50b3IKICAgICIiIgogICAgdHJ5Ogog
ICAgICAgIHVzZXJfaWQgPSBzdHIoY3VycmVudF91c2VyWyJfaWQiXSkKICAgICAgICB1c2VyX21l
bnRvcl9pZCA9IGN1cnJlbnRfdXNlci5nZXQoIm1lbnRvcl9pZCIpCiAgICAgICAgaW5kaWNhdG9y
X2lkID0gc2VsZWN0aW9uLmluZGljYXRvcl9pZAogICAgICAgIAogICAgICAgICMgVmVyaWZ5IGlu
ZGljYXRvciBleGlzdHMgYW5kIGJlbG9uZ3MgdG8gdXNlcidzIG1lbnRvcgogICAgICAgIGluZGlj
YXRvciA9IGF3YWl0IGRiLmN1c3RvbV9pbmRpY2F0b3JzLmZpbmRfb25lKHsKICAgICAgICAgICAg
Il9pZCI6IE9iamVjdElkKGluZGljYXRvcl9pZCksCiAgICAgICAgICAgICJtZW50b3JfaWQiOiB1
c2VyX21lbnRvcl9pZCwKICAgICAgICAgICAgInN0YXR1cyI6ICJhY3RpdmUiCiAgICAgICAgfSkK
ICAgICAgICAKICAgICAgICBpZiBub3QgaW5kaWNhdG9yOgogICAgICAgICAgICByYWlzZSBIVFRQ
RXhjZXB0aW9uKHN0YXR1c19jb2RlPTQwNCwgZGV0YWlsPSJJbmRpY2F0b3Igbm90IGZvdW5kIG9y
IGRvZXNuJ3QgYmVsb25nIHRvIHlvdXIgbWVudG9yIikKICAgICAgICAKICAgICAgICAjIFVwZGF0
ZSB1c2VyJ3Mgc2VsZWN0ZWQgaW5kaWNhdG9yCiAgICAgICAgYXdhaXQgZGIudXNlcnMudXBkYXRl
X29uZSgKICAgICAgICAgICAgeyJfaWQiOiBPYmplY3RJZCh1c2VyX2lkKX0sCiAgICAgICAgICAg
IHsiJHNldCI6IHsic2VsZWN0ZWRfaW5kaWNhdG9yX2lkIjogaW5kaWNhdG9yX2lkfX0KICAgICAg
ICApCiAgICAgICAgCiAgICAgICAgbG9nZ2VyLmluZm8oZiLinIUgVXNlciB7dXNlcl9pZH0gc2Vs
ZWN0ZWQgaW5kaWNhdG9yOiAne2luZGljYXRvclsnbmFtZSddfScgKElEOiB7aW5kaWNhdG9yX2lk
fSkiKQogICAgICAgIAogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICJtZXNzYWdlIjogIklu
ZGljYXRvciBzZWxlY3RlZCBzdWNjZXNzZnVsbHkiLAogICAgICAgICAgICAiaW5kaWNhdG9yX2lk
IjogaW5kaWNhdG9yX2lkLAogICAgICAgICAgICAiaW5kaWNhdG9yX25hbWUiOiBpbmRpY2F0b3Jb
Im5hbWUiXSwKICAgICAgICAgICAgImN1cnJlbnRfc2lnbmFsIjogaW5kaWNhdG9yLmdldCgiY3Vy
cmVudF9zaWduYWwiLCAiTk9ORSIpCiAgICAgICAgfQogICAgICAgIAogICAgZXhjZXB0IEhUVFBF
eGNlcHRpb246CiAgICAgICAgcmFpc2UKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAg
ICBsb2dnZXIuZXJyb3IoZiJFcnJvciBzZWxlY3RpbmcgaW5kaWNhdG9yOiB7c3RyKGUpfSIpCiAg
ICAgICAgcmFpc2UgSFRUUEV4Y2VwdGlvbihzdGF0dXNfY29kZT01MDAsIGRldGFpbD1mIkZhaWxl
ZCB0byBzZWxlY3QgaW5kaWNhdG9yOiB7c3RyKGUpfSIpCgogICAgICAgIHJhaXNlIEhUVFBFeGNl
cHRpb24oc3RhdHVzX2NvZGU9NTAwLCBkZXRhaWw9ZiJGYWlsZWQgdG8gc2VuZCBtYW51YWwgbmV3
czoge3N0cihlKX0iKQoKCkBhcGlfcm91dGVyLnBvc3QoIi91c2VyL3N1YnNjcmliZS10by1pbmRp
Y2F0b3IiKQphc3luYyBkZWYgc3Vic2NyaWJlX3RvX2luZGljYXRvcihzdWJzY3JpcHRpb246IElu
ZGljYXRvclN1YnNjcmlwdGlvbkNyZWF0ZSwgY3VycmVudF91c2VyID0gRGVwZW5kcyhnZXRfY3Vy
cmVudF91c2VyKSk6CiAgICAiIiIKICAgIFVzZXIgc3Vic2NyaWJlcyB0byBhIG1lbnRvcidzIGlu
ZGljYXRvciB3aXRoIHRoZWlyIGNob3NlbiBzeW1ib2wgYW5kIHRpbWVmcmFtZQogICAgIiIiCiAg
ICB0cnk6CiAgICAgICAgdXNlcl9pZCA9IHN0cihjdXJyZW50X3VzZXJbIl9pZCJdKQogICAgICAg
IHVzZXJfbWVudG9yX2lkID0gY3VycmVudF91c2VyLmdldCgibWVudG9yX2lkIikKICAgICAgICBp
bmRpY2F0b3JfaWQgPSBzdWJzY3JpcHRpb24uaW5kaWNhdG9yX2lkCiAgICAgICAgc3ltYm9sID0g
c3Vic2NyaXB0aW9uLnN5bWJvbC51cHBlcigpCiAgICAgICAgdGltZWZyYW1lID0gc3Vic2NyaXB0
aW9uLnRpbWVmcmFtZQogICAgICAgIAogICAgICAgICMgVmVyaWZ5IGluZGljYXRvciBleGlzdHMg
YW5kIGJlbG9uZ3MgdG8gdXNlcidzIG1lbnRvcgogICAgICAgIGluZGljYXRvciA9IGF3YWl0IGRi
LmN1c3RvbV9pbmRpY2F0b3JzLmZpbmRfb25lKHsKICAgICAgICAgICAgIl9pZCI6IE9iamVjdElk
KGluZGljYXRvcl9pZCksCiAgICAgICAgICAgICJtZW50b3JfaWQiOiB1c2VyX21lbnRvcl9pZCwK
ICAgICAgICAgICAgInN0YXR1cyI6ICJhY3RpdmUiLAogICAgICAgICAgICAiaXNfcnVubmluZyI6
IFRydWUKICAgICAgICB9KQogICAgICAgIAogICAgICAgIGlmIG5vdCBpbmRpY2F0b3I6CiAgICAg
ICAgICAgIHJhaXNlIEhUVFBFeGNlcHRpb24oc3RhdHVzX2NvZGU9NDA0LCBkZXRhaWw9IkluZGlj
YXRvciBub3QgZm91bmQgb3Igbm90IGF2YWlsYWJsZSIpCiAgICAgICAgCiAgICAgICAgIyBDaGVj
ayBpZiB1c2VyIGFscmVhZHkgaGFzIHN1YnNjcmlwdGlvbiBmb3IgdGhpcyBpbmRpY2F0b3IgKyBz
eW1ib2wgY29tYm8KICAgICAgICBleGlzdGluZyA9IGF3YWl0IGRiLnVzZXJfaW5kaWNhdG9yX3N1
YnNjcmlwdGlvbnMuZmluZF9vbmUoewogICAgICAgICAgICAidXNlcl9pZCI6IHVzZXJfaWQsCiAg
ICAgICAgICAgICJpbmRpY2F0b3JfaWQiOiBpbmRpY2F0b3JfaWQsCiAgICAgICAgICAgICJ1c2Vy
X3NlbGVjdGVkX3N5bWJvbCI6IHN5bWJvbCwKICAgICAgICAgICAgInN0YXR1cyI6ICJhY3RpdmUi
CiAgICAgICAgfSkKICAgICAgICAKICAgICAgICBpZiBleGlzdGluZzoKICAgICAgICAgICAgcmFp
c2UgSFRUUEV4Y2VwdGlvbihzdGF0dXNfY29kZT00MDAsIGRldGFpbD1mIllvdSBhcmUgYWxyZWFk
eSBzdWJzY3JpYmVkIHRvIHtpbmRpY2F0b3JbJ25hbWUnXX0gb24ge3N5bWJvbH0iKQogICAgICAg
IAogICAgICAgICMgQ3JlYXRlIHN1YnNjcmlwdGlvbgogICAgICAgIHN1YnNjcmlwdGlvbl9kb2Mg
PSB7CiAgICAgICAgICAgICJ1c2VyX2lkIjogdXNlcl9pZCwKICAgICAgICAgICAgInVzZXJfZW1h
aWwiOiBjdXJyZW50X3VzZXIuZ2V0KCJlbWFpbCIpLAogICAgICAgICAgICAibWVudG9yX2lkIjog
dXNlcl9tZW50b3JfaWQsCiAgICAgICAgICAgICJpbmRpY2F0b3JfaWQiOiBpbmRpY2F0b3JfaWQs
CiAgICAgICAgICAgICJpbmRpY2F0b3JfbmFtZSI6IGluZGljYXRvclsibmFtZSJdLAogICAgICAg
ICAgICAidXNlcl9zZWxlY3RlZF9zeW1ib2wiOiBzeW1ib2wsCiAgICAgICAgICAgICJ1c2VyX3Nl
bGVjdGVkX3RpbWVmcmFtZSI6IHRpbWVmcmFtZSwKICAgICAgICAgICAgInN0YXR1cyI6ICJhY3Rp
dmUiLAogICAgICAgICAgICAic3Vic2NyaWJlZF9hdCI6IGRhdGV0aW1lLnV0Y25vdygpLAogICAg
ICAgICAgICAibGFzdF9zaWduYWxfdGltZSI6IE5vbmUsCiAgICAgICAgICAgICJsYXN0X3NpZ25h
bF90eXBlIjogIk5PTkUiLAogICAgICAgICAgICAidG90YWxfc2lnbmFsc19yZWNlaXZlZCI6IDAK
ICAgICAgICB9CiAgICAgICAgCiAgICAgICAgcmVzdWx0ID0gYXdhaXQgZGIudXNlcl9pbmRpY2F0
b3Jfc3Vic2NyaXB0aW9ucy5pbnNlcnRfb25lKHN1YnNjcmlwdGlvbl9kb2MpCiAgICAgICAgc3Vi
c2NyaXB0aW9uX2lkID0gc3RyKHJlc3VsdC5pbnNlcnRlZF9pZCkKICAgICAgICAKICAgICAgICBs
b2dnZXIuaW5mbyhmIuKchSBVc2VyIHt1c2VyX2lkfSBzdWJzY3JpYmVkIHRvIGluZGljYXRvciAn
e2luZGljYXRvclsnbmFtZSddfScgb24ge3N5bWJvbH0gQCB7dGltZWZyYW1lfSIpCiAgICAgICAg
CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgIm1lc3NhZ2UiOiAiU3VjY2Vzc2Z1bGx5IHN1
YnNjcmliZWQgdG8gaW5kaWNhdG9yIiwKICAgICAgICAgICAgInN1YnNjcmlwdGlvbl9pZCI6IHN1
YnNjcmlwdGlvbl9pZCwKICAgICAgICAgICAgImluZGljYXRvcl9uYW1lIjogaW5kaWNhdG9yWyJu
YW1lIl0sCiAgICAgICAgICAgICJzeW1ib2wiOiBzeW1ib2wsCiAgICAgICAgICAgICJ0aW1lZnJh
bWUiOiB0aW1lZnJhbWUKICAgICAgICB9CiAgICAgICAgCiAgICBleGNlcHQgSFRUUEV4Y2VwdGlv
bjoKICAgICAgICByYWlzZQogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIGxvZ2dl
ci5lcnJvcihmIkVycm9yIGNyZWF0aW5nIHN1YnNjcmlwdGlvbjoge3N0cihlKX0iKQogICAgICAg
IHJhaXNlIEhUVFBFeGNlcHRpb24oc3RhdHVzX2NvZGU9NTAwLCBkZXRhaWw9ZiJGYWlsZWQgdG8g
c3Vic2NyaWJlOiB7c3RyKGUpfSIpCgoKQGFwaV9yb3V0ZXIuZ2V0KCIvdXNlci9teS1pbmRpY2F0
b3Itc3Vic2NyaXB0aW9ucyIpCmFzeW5jIGRlZiBnZXRfbXlfc3Vic2NyaXB0aW9ucyhjdXJyZW50
X3VzZXIgPSBEZXBlbmRzKGdldF9jdXJyZW50X3VzZXIpKToKICAgICIiIgogICAgR2V0IGFsbCBh
Y3RpdmUgaW5kaWNhdG9yIHN1YnNjcmlwdGlvbnMgZm9yIHRoZSBjdXJyZW50IHVzZXIKICAgICIi
IgogICAgdHJ5OgogICAgICAgIHVzZXJfaWQgPSBzdHIoY3VycmVudF91c2VyWyJfaWQiXSkKICAg
ICAgICAKICAgICAgICAjIEdldCBhbGwgYWN0aXZlIHN1YnNjcmlwdGlvbnMKICAgICAgICBzdWJz
Y3JpcHRpb25zX2N1cnNvciA9IGRiLnVzZXJfaW5kaWNhdG9yX3N1YnNjcmlwdGlvbnMuZmluZCh7
CiAgICAgICAgICAgICJ1c2VyX2lkIjogdXNlcl9pZCwKICAgICAgICAgICAgInN0YXR1cyI6ICJh
Y3RpdmUiCiAgICAgICAgfSkuc29ydCgic3Vic2NyaWJlZF9hdCIsIC0xKQogICAgICAgIAogICAg
ICAgIHN1YnNjcmlwdGlvbnNfbGlzdCA9IGF3YWl0IHN1YnNjcmlwdGlvbnNfY3Vyc29yLnRvX2xp
c3QobGVuZ3RoPTEwMCkKICAgICAgICAKICAgICAgICBmb3JtYXR0ZWRfc3Vic2NyaXB0aW9ucyA9
IFtdCiAgICAgICAgZm9yIHN1YiBpbiBzdWJzY3JpcHRpb25zX2xpc3Q6CiAgICAgICAgICAgIGZv
cm1hdHRlZF9zdWJzY3JpcHRpb25zLmFwcGVuZCh7CiAgICAgICAgICAgICAgICAiaWQiOiBzdHIo
c3ViWyJfaWQiXSksCiAgICAgICAgICAgICAgICAiaW5kaWNhdG9yX2lkIjogc3ViWyJpbmRpY2F0
b3JfaWQiXSwKICAgICAgICAgICAgICAgICJpbmRpY2F0b3JfbmFtZSI6IHN1YlsiaW5kaWNhdG9y
X25hbWUiXSwKICAgICAgICAgICAgICAgICJzeW1ib2wiOiBzdWJbInVzZXJfc2VsZWN0ZWRfc3lt
Ym9sIl0sCiAgICAgICAgICAgICAgICAidGltZWZyYW1lIjogc3ViWyJ1c2VyX3NlbGVjdGVkX3Rp
bWVmcmFtZSJdLAogICAgICAgICAgICAgICAgInN1YnNjcmliZWRfYXQiOiBzdWJbInN1YnNjcmli
ZWRfYXQiXS5pc29mb3JtYXQoKSwKICAgICAgICAgICAgICAgICJsYXN0X3NpZ25hbF90aW1lIjog
c3ViWyJsYXN0X3NpZ25hbF90aW1lIl0uaXNvZm9ybWF0KCkgaWYgc3ViLmdldCgibGFzdF9zaWdu
YWxfdGltZSIpIGVsc2UgTm9uZSwKICAgICAgICAgICAgICAgICJsYXN0X3NpZ25hbF90eXBlIjog
c3ViLmdldCgibGFzdF9zaWduYWxfdHlwZSIsICJOT05FIiksCiAgICAgICAgICAgICAgICAidG90
YWxfc2lnbmFsc19yZWNlaXZlZCI6IHN1Yi5nZXQoInRvdGFsX3NpZ25hbHNfcmVjZWl2ZWQiLCAw
KQogICAgICAgICAgICB9KQogICAgICAgIAogICAgICAgIGxvZ2dlci5pbmZvKGYi4pyFIFJldHVy
bmluZyB7bGVuKGZvcm1hdHRlZF9zdWJzY3JpcHRpb25zKX0gc3Vic2NyaXB0aW9ucyBmb3IgdXNl
ciB7dXNlcl9pZH0iKQogICAgICAgIAogICAgICAgIHJldHVybiB7InN1YnNjcmlwdGlvbnMiOiBm
b3JtYXR0ZWRfc3Vic2NyaXB0aW9uc30KICAgICAgICAKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMg
ZToKICAgICAgICBsb2dnZXIuZXJyb3IoZiJFcnJvciBmZXRjaGluZyBzdWJzY3JpcHRpb25zOiB7
c3RyKGUpfSIpCiAgICAgICAgcmFpc2UgSFRUUEV4Y2VwdGlvbihzdGF0dXNfY29kZT01MDAsIGRl
dGFpbD1mIkZhaWxlZCB0byBmZXRjaCBzdWJzY3JpcHRpb25zOiB7c3RyKGUpfSIpCgoKQGFwaV9y
b3V0ZXIuZGVsZXRlKCIvdXNlci91bnN1YnNjcmliZS1pbmRpY2F0b3Ive3N1YnNjcmlwdGlvbl9p
ZH0iKQphc3luYyBkZWYgdW5zdWJzY3JpYmVfZnJvbV9pbmRpY2F0b3Ioc3Vic2NyaXB0aW9uX2lk
OiBzdHIsIGN1cnJlbnRfdXNlciA9IERlcGVuZHMoZ2V0X2N1cnJlbnRfdXNlcikpOgogICAgIiIi
CiAgICBVbnN1YnNjcmliZSBmcm9tIGFuIGluZGljYXRvcgogICAgIiIiCiAgICB0cnk6CiAgICAg
ICAgdXNlcl9pZCA9IHN0cihjdXJyZW50X3VzZXJbIl9pZCJdKQogICAgICAgIAogICAgICAgICMg
VmVyaWZ5IHN1YnNjcmlwdGlvbiBiZWxvbmdzIHRvIHVzZXIKICAgICAgICBzdWJzY3JpcHRpb24g
PSBhd2FpdCBkYi51c2VyX2luZGljYXRvcl9zdWJzY3JpcHRpb25zLmZpbmRfb25lKHsKICAgICAg
ICAgICAgIl9pZCI6IE9iamVjdElkKHN1YnNjcmlwdGlvbl9pZCksCiAgICAgICAgICAgICJ1c2Vy
X2lkIjogdXNlcl9pZAogICAgICAgIH0pCiAgICAgICAgCiAgICAgICAgaWYgbm90IHN1YnNjcmlw
dGlvbjoKICAgICAgICAgICAgcmFpc2UgSFRUUEV4Y2VwdGlvbihzdGF0dXNfY29kZT00MDQsIGRl
dGFpbD0iU3Vic2NyaXB0aW9uIG5vdCBmb3VuZCIpCiAgICAgICAgCiAgICAgICAgIyBTb2Z0IGRl
bGV0ZSAtIHVwZGF0ZSBzdGF0dXMgdG8gaW5hY3RpdmUKICAgICAgICBhd2FpdCBkYi51c2VyX2lu
ZGljYXRvcl9zdWJzY3JpcHRpb25zLnVwZGF0ZV9vbmUoCiAgICAgICAgICAgIHsiX2lkIjogT2Jq
ZWN0SWQoc3Vic2NyaXB0aW9uX2lkKX0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICIk
c2V0IjogewogICAgICAgICAgICAgICAgICAgICJzdGF0dXMiOiAiaW5hY3RpdmUiLAogICAgICAg
ICAgICAgICAgICAgICJ1bnN1YnNjcmliZWRfYXQiOiBkYXRldGltZS51dGNub3coKQogICAgICAg
ICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgKQogICAgICAgIAogICAgICAgIGxvZ2dl
ci5pbmZvKGYi4pyFIFVzZXIge3VzZXJfaWR9IHVuc3Vic2NyaWJlZCBmcm9tIGluZGljYXRvciAn
e3N1YnNjcmlwdGlvblsnaW5kaWNhdG9yX25hbWUnXX0nIG9uIHtzdWJzY3JpcHRpb25bJ3VzZXJf
c2VsZWN0ZWRfc3ltYm9sJ119IikKICAgICAgICAKICAgICAgICByZXR1cm4gewogICAgICAgICAg
ICAibWVzc2FnZSI6ICJTdWNjZXNzZnVsbHkgdW5zdWJzY3JpYmVkIiwKICAgICAgICAgICAgImlu
ZGljYXRvcl9uYW1lIjogc3Vic2NyaXB0aW9uWyJpbmRpY2F0b3JfbmFtZSJdLAogICAgICAgICAg
ICAic3ltYm9sIjogc3Vic2NyaXB0aW9uWyJ1c2VyX3NlbGVjdGVkX3N5bWJvbCJdCiAgICAgICAg
fQogICAgICAgIAogICAgZXhjZXB0IEhUVFBFeGNlcHRpb246CiAgICAgICAgcmFpc2UKICAgIGV4
Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICBsb2dnZXIuZXJyb3IoZiJFcnJvciB1bnN1YnNj
cmliaW5nOiB7c3RyKGUpfSIpCiAgICAgICAgcmFpc2UgSFRUUEV4Y2VwdGlvbihzdGF0dXNfY29k
ZT01MDAsIGRldGFpbD1mIkZhaWxlZCB0byB1bnN1YnNjcmliZToge3N0cihlKX0iKQoKCkBhcGlf
cm91dGVyLmdldCgiL3VzZXIvc2lnbmFscyIpCmFzeW5jIGRlZiBnZXRfdXNlcl9zaWduYWxzKGN1
cnJlbnRfdXNlciA9IERlcGVuZHMoZ2V0X2N1cnJlbnRfdXNlcikpOgogICAgIiIiCiAgICBHZXQg
YWxsIHNpZ25hbHMgZm9yIHRoZSBjdXJyZW50IHVzZXIgKHVucmVhZCBhbmQgcmVjZW50KQogICAg
IiIiCiAgICB0cnk6CiAgICAgICAgdXNlcl9pZCA9IHN0cihjdXJyZW50X3VzZXJbIl9pZCJdKQog
ICAgICAgIAogICAgICAgICMgR2V0IHVzZXIncyBzaWduYWwgcmVmZXJlbmNlcwogICAgICAgIHVz
ZXJfc2lnbmFsX3JlZnMgPSBhd2FpdCBkYi51c2VyX3NpZ25hbHMuZmluZCh7CiAgICAgICAgICAg
ICJ1c2VyX2lkIjogdXNlcl9pZAogICAgICAgIH0pLnNvcnQoImNyZWF0ZWRfYXQiLCAtMSkubGlt
aXQoNTApLnRvX2xpc3QobGVuZ3RoPTUwKQogICAgICAgIAogICAgICAgIHNpZ25hbHMgPSBbXQog
ICAgICAgIGZvciByZWYgaW4gdXNlcl9zaWduYWxfcmVmczoKICAgICAgICAgICAgc2lnbmFsID0g
YXdhaXQgZGIuc2lnbmFscy5maW5kX29uZSh7Il9pZCI6IE9iamVjdElkKHJlZlsic2lnbmFsX2lk
Il0pfSkKICAgICAgICAgICAgaWYgc2lnbmFsOgogICAgICAgICAgICAgICAgc2lnbmFscy5hcHBl
bmQoewogICAgICAgICAgICAgICAgICAgICoqc2VyaWFsaXplX2RvYyhzaWduYWwpLAogICAgICAg
ICAgICAgICAgICAgICJyZWFkIjogcmVmLmdldCgicmVhZCIsIEZhbHNlKSwKICAgICAgICAgICAg
ICAgICAgICAicmVjZWl2ZWRfYXQiOiByZWYuZ2V0KCJjcmVhdGVkX2F0IikKICAgICAgICAgICAg
ICAgIH0pCiAgICAgICAgCiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgInNpZ25hbHMiOiBz
aWduYWxzLAogICAgICAgICAgICAidW5yZWFkX2NvdW50Ijogc3VtKDEgZm9yIHMgaW4gc2lnbmFs
cyBpZiBub3Qgcy5nZXQoInJlYWQiKSkKICAgICAgICB9CiAgICAgICAgCiAgICBleGNlcHQgRXhj
ZXB0aW9uIGFzIGU6CiAgICAgICAgbG9nZ2VyLmVycm9yKGYiRXJyb3IgZmV0Y2hpbmcgdXNlciBz
aWduYWxzOiB7c3RyKGUpfSIpCiAgICAgICAgcmFpc2UgSFRUUEV4Y2VwdGlvbihzdGF0dXNfY29k
ZT01MDAsIGRldGFpbD1mIkZhaWxlZCB0byBmZXRjaCBzaWduYWxzOiB7c3RyKGUpfSIpCgoKQGFw
aV9yb3V0ZXIuZ2V0KCIvdXNlci9zaWduYWxzL2xhdGVzdCIpCmFzeW5jIGRlZiBnZXRfbGF0ZXN0
X3NpZ25hbChjdXJyZW50X3VzZXIgPSBEZXBlbmRzKGdldF9jdXJyZW50X3VzZXIpKToKICAgICIi
IgogICAgR2V0IHRoZSBtb3N0IHJlY2VudCBBQ1RJVkUgKG5vbi1leHBpcmVkKSBzaWduYWwgZm9y
IGZsb2F0aW5nIGJ1dHRvbiBkaXNwbGF5CiAgICAiIiIKICAgIHRyeToKICAgICAgICB1c2VyX2lk
ID0gc3RyKGN1cnJlbnRfdXNlclsiX2lkIl0pCiAgICAgICAgCiAgICAgICAgIyBHZXQgbGF0ZXN0
IHNpZ25hbCByZWZlcmVuY2UKICAgICAgICBsYXRlc3RfcmVmID0gYXdhaXQgZGIudXNlcl9zaWdu
YWxzLmZpbmRfb25lKAogICAgICAgICAgICB7InVzZXJfaWQiOiB1c2VyX2lkfSwKICAgICAgICAg
ICAgc29ydD1bKCJjcmVhdGVkX2F0IiwgLTEpXQogICAgICAgICkKICAgICAgICAKICAgICAgICBp
ZiBub3QgbGF0ZXN0X3JlZjoKICAgICAgICAgICAgcmV0dXJuIHsic2lnbmFsIjogTm9uZX0KICAg
ICAgICAKICAgICAgICBzaWduYWwgPSBhd2FpdCBkYi5zaWduYWxzLmZpbmRfb25lKHsiX2lkIjog
T2JqZWN0SWQobGF0ZXN0X3JlZlsic2lnbmFsX2lkIl0pfSkKICAgICAgICBpZiBzaWduYWw6CiAg
ICAgICAgICAgICMgQ2hlY2sgaWYgc2lnbmFsIGhhcyBleHBpcmVkCiAgICAgICAgICAgIGlmIHNp
Z25hbC5nZXQoImV4cGlyZXNfYXQiKToKICAgICAgICAgICAgICAgIGlmIHNpZ25hbFsiZXhwaXJl
c19hdCJdIDwgZGF0ZXRpbWUudXRjbm93KCk6CiAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmlu
Zm8oZiJTaWduYWwge2xhdGVzdF9yZWZbJ3NpZ25hbF9pZCddfSBleHBpcmVkLCBub3QgZGlzcGxh
eWluZyIpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsic2lnbmFsIjogTm9uZX0KICAgICAg
ICAgICAgCiAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICAic2lnbmFsIjogewog
ICAgICAgICAgICAgICAgICAgICJpZCI6IHN0cihzaWduYWxbIl9pZCJdKSwKICAgICAgICAgICAg
ICAgICAgICAic2lnbmFsX3R5cGUiOiBzaWduYWxbInNpZ25hbF90eXBlIl0sCiAgICAgICAgICAg
ICAgICAgICAgInN5bWJvbCI6IHNpZ25hbC5nZXQoInN5bWJvbCIpLAogICAgICAgICAgICAgICAg
ICAgICJpbmRpY2F0b3IiOiBzaWduYWwuZ2V0KCJpbmRpY2F0b3IiLCAiIiksCiAgICAgICAgICAg
ICAgICAgICAgImNhbmRsZV9wYXR0ZXJuIjogc2lnbmFsLmdldCgiY2FuZGxlX3BhdHRlcm4iLCAi
IiksCiAgICAgICAgICAgICAgICAgICAgInRpbWVmcmFtZSI6IHNpZ25hbC5nZXQoInRpbWVmcmFt
ZSIsICIiKSwKICAgICAgICAgICAgICAgICAgICAibm90ZXMiOiBzaWduYWwuZ2V0KCJub3RlcyIs
ICIiKSwKICAgICAgICAgICAgICAgICAgICAiZW50cnlfcHJpY2UiOiBzaWduYWwuZ2V0KCJlbnRy
eV9wcmljZSIpLAogICAgICAgICAgICAgICAgICAgICJzdG9wX2xvc3MiOiBzaWduYWwuZ2V0KCJz
dG9wX2xvc3MiKSwKICAgICAgICAgICAgICAgICAgICAidGFrZV9wcm9maXQiOiBzaWduYWwuZ2V0
KCJ0YWtlX3Byb2ZpdCIpLAogICAgICAgICAgICAgICAgICAgICJtZXNzYWdlIjogc2lnbmFsLmdl
dCgibWVzc2FnZSIsICIiKSwKICAgICAgICAgICAgICAgICAgICAic2VuZGVyX3R5cGUiOiBzaWdu
YWwuZ2V0KCJzZW5kZXJfdHlwZSIsICIiKSwKICAgICAgICAgICAgICAgICAgICAic3RhdHVzIjog
c2lnbmFsLmdldCgic3RhdHVzIiwgIiIpLAogICAgICAgICAgICAgICAgICAgICJjcmVhdGVkX2F0
Ijogc2lnbmFsWyJjcmVhdGVkX2F0Il0uaXNvZm9ybWF0KCkgaWYgc2lnbmFsLmdldCgiY3JlYXRl
ZF9hdCIpIGVsc2UgTm9uZSwKICAgICAgICAgICAgICAgICAgICAiZXhwaXJlc19hdCI6IHNpZ25h
bFsiZXhwaXJlc19hdCJdLmlzb2Zvcm1hdCgpIGlmIHNpZ25hbC5nZXQoImV4cGlyZXNfYXQiKSBl
bHNlIE5vbmUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIAogICAgICAg
IHJldHVybiB7InNpZ25hbCI6IE5vbmV9CiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAg
ICAgbG9nZ2VyLmVycm9yKGYiRXJyb3IgZmV0Y2hpbmcgbGF0ZXN0IHNpZ25hbDoge3N0cihlKX0i
KQogICAgICAgIHJhaXNlIEhUVFBFeGNlcHRpb24oc3RhdHVzX2NvZGU9NTAwLCBkZXRhaWw9ZiJG
YWlsZWQgdG8gZmV0Y2ggbGF0ZXN0IHNpZ25hbDoge3N0cihlKX0iKQoKCiMgPT09PT09PT09PT09
PT09PT09PT0gQlJPS0VSIEFGRklMSUFURSBMSU5LUyA9PT09PT09PT09PT09PT09PT09PQoKQGFw
aV9yb3V0ZXIucG9zdCgiL2FkbWluL2Jyb2tlcnMiKQphc3luYyBkZWYgYWRtaW5fYWRkX2Jyb2tl
cihicm9rZXI6IEJyb2tlckFmZmlsaWF0ZSwgY3VycmVudF9hZG1pbiA9IERlcGVuZHMoZ2V0X2N1
cnJlbnRfYWRtaW4pKToKICAgICIiIgogICAgQWRtaW4gYWRkcyBhIGJyb2tlciBhZmZpbGlhdGUg
bGluayB0aGF0IHdpbGwgYmUgc2VudCB0byBhbGwgdXNlcnMKICAgICIiIgogICAgdHJ5OgogICAg
ICAgIGJyb2tlcl9kb2MgPSB7CiAgICAgICAgICAgICJicm9rZXJfbmFtZSI6IGJyb2tlci5icm9r
ZXJfbmFtZSwKICAgICAgICAgICAgImJyb2tlcl9pbWFnZSI6IGJyb2tlci5icm9rZXJfaW1hZ2Us
CiAgICAgICAgICAgICJhZmZpbGlhdGVfbGluayI6IGJyb2tlci5hZmZpbGlhdGVfbGluaywKICAg
ICAgICAgICAgImRlc2NyaXB0aW9uIjogYnJva2VyLmRlc2NyaXB0aW9uIG9yICIiLAogICAgICAg
ICAgICAiYWRkZWRfYnlfdHlwZSI6ICJhZG1pbiIsCiAgICAgICAgICAgICJhZGRlZF9ieV9pZCI6
IHN0cihjdXJyZW50X2FkbWluWyJfaWQiXSksCiAgICAgICAgICAgICJjcmVhdGVkX2F0IjogZGF0
ZXRpbWUudXRjbm93KCksCiAgICAgICAgICAgICJzdGF0dXMiOiAiYWN0aXZlIgogICAgICAgIH0K
ICAgICAgICAKICAgICAgICByZXN1bHQgPSBhd2FpdCBkYi5icm9rZXJzLmluc2VydF9vbmUoYnJv
a2VyX2RvYykKICAgICAgICBicm9rZXJfaWQgPSBzdHIocmVzdWx0Lmluc2VydGVkX2lkKQogICAg
ICAgIAogICAgICAgICMgU2VuZCBub3RpZmljYXRpb24gdG8gYWxsIGFjdGl2ZSBwYWlkIHVzZXJz
CiAgICAgICAgYWN0aXZlX3VzZXJzID0gYXdhaXQgZGIudXNlcnMuZmluZCh7CiAgICAgICAgICAg
ICJzdGF0dXMiOiAiYWN0aXZlIiwKICAgICAgICAgICAgInBheW1lbnRfc3RhdHVzIjogInBhaWQi
CiAgICAgICAgfSkudG9fbGlzdChsZW5ndGg9MTAwMCkKICAgICAgICAKICAgICAgICBub3RpZmlj
YXRpb25fY291bnQgPSAwCiAgICAgICAgZm9yIHVzZXIgaW4gYWN0aXZlX3VzZXJzOgogICAgICAg
ICAgICBhd2FpdCBkYi5icm9rZXJfbm90aWZpY2F0aW9ucy5pbnNlcnRfb25lKHsKICAgICAgICAg
ICAgICAgICJicm9rZXJfaWQiOiBicm9rZXJfaWQsCiAgICAgICAgICAgICAgICAidXNlcl9pZCI6
IHN0cih1c2VyWyJfaWQiXSksCiAgICAgICAgICAgICAgICAic2VlbiI6IEZhbHNlLAogICAgICAg
ICAgICAgICAgImNyZWF0ZWRfYXQiOiBkYXRldGltZS51dGNub3coKQogICAgICAgICAgICB9KQog
ICAgICAgICAgICBub3RpZmljYXRpb25fY291bnQgKz0gMQogICAgICAgIAogICAgICAgIGxvZ2dl
ci5pbmZvKGYi4pyFIEFkbWluIGFkZGVkIGJyb2tlcjoge2Jyb2tlci5icm9rZXJfbmFtZX0sIG5v
dGlmaWVkIHtub3RpZmljYXRpb25fY291bnR9IHVzZXJzIikKICAgICAgICAKICAgICAgICByZXR1
cm4gewogICAgICAgICAgICAibWVzc2FnZSI6ICJCcm9rZXIgYWRkZWQgc3VjY2Vzc2Z1bGx5IiwK
ICAgICAgICAgICAgImJyb2tlcl9pZCI6IGJyb2tlcl9pZCwKICAgICAgICAgICAgIm5vdGlmaWVk
X3VzZXJzIjogbm90aWZpY2F0aW9uX2NvdW50CiAgICAgICAgfQogICAgICAgIAogICAgZXhjZXB0
IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIGxvZ2dlci5lcnJvcihmIkVycm9yIGFkZGluZyBhZG1p
biBicm9rZXI6IHtzdHIoZSl9IikKICAgICAgICByYWlzZSBIVFRQRXhjZXB0aW9uKHN0YXR1c19j
b2RlPTUwMCwgZGV0YWlsPWYiRmFpbGVkIHRvIGFkZCBicm9rZXI6IHtzdHIoZSl9IikKCgpAYXBp
X3JvdXRlci5nZXQoIi9hZG1pbi9icm9rZXJzIikKYXN5bmMgZGVmIGdldF9hZG1pbl9icm9rZXJz
KGN1cnJlbnRfYWRtaW4gPSBEZXBlbmRzKGdldF9jdXJyZW50X2FkbWluKSk6CiAgICAiIiIKICAg
IEdldCBhbGwgYnJva2VycyAoYWRtaW4gKyBtZW50b3IgY3JlYXRlZCkgZm9yIGFkbWluIGRhc2hi
b2FyZAogICAgQWRtaW4gY2FuIHNlZSBhbGwgYnJva2VycyBpbiB0aGUgc3lzdGVtCiAgICAiIiIK
ICAgIHRyeToKICAgICAgICAjIEdldCBhbGwgYWN0aXZlIGJyb2tlcnMgKGFkbWluIGFuZCBtZW50
b3IpCiAgICAgICAgYnJva2VycyA9IGF3YWl0IGRiLmJyb2tlcnMuZmluZCh7CiAgICAgICAgICAg
ICJzdGF0dXMiOiAiYWN0aXZlIgogICAgICAgIH0pLnNvcnQoImNyZWF0ZWRfYXQiLCAtMSkudG9f
bGlzdChsZW5ndGg9MTAwKQogICAgICAgIAogICAgICAgICMgRW5yaWNoIHdpdGggY3JlYXRvciBp
bmZvCiAgICAgICAgcmVzdWx0ID0gW10KICAgICAgICBmb3IgYnJva2VyIGluIGJyb2tlcnM6CiAg
ICAgICAgICAgIGJyb2tlcl9kYXRhID0gc2VyaWFsaXplX2RvYyhicm9rZXIpCiAgICAgICAgICAg
IAogICAgICAgICAgICAjIEFkZCBjcmVhdG9yIHR5cGUgYW5kIElECiAgICAgICAgICAgIGJyb2tl
cl9kYXRhWyJhZGRlZF9ieV90eXBlIl0gPSBicm9rZXIuZ2V0KCJhZGRlZF9ieV90eXBlIiwgImFk
bWluIikKICAgICAgICAgICAgYnJva2VyX2RhdGFbIm1lbnRvcl9pZCJdID0gYnJva2VyLmdldCgi
bWVudG9yX2lkIiwgTm9uZSkKICAgICAgICAgICAgCiAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQo
YnJva2VyX2RhdGEpCiAgICAgICAgCiAgICAgICAgcmV0dXJuIHsiYnJva2VycyI6IHJlc3VsdH0K
ICAgICAgICAKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICBsb2dnZXIuZXJyb3Io
ZiJFcnJvciBmZXRjaGluZyBhZG1pbiBicm9rZXJzOiB7c3RyKGUpfSIpCiAgICAgICAgcmFpc2Ug
SFRUUEV4Y2VwdGlvbihzdGF0dXNfY29kZT01MDAsIGRldGFpbD1mIkZhaWxlZCB0byBmZXRjaCBi
cm9rZXJzOiB7c3RyKGUpfSIpCgoKQGFwaV9yb3V0ZXIuZGVsZXRlKCIvYWRtaW4vYnJva2Vycy97
YnJva2VyX2lkfSIpCmFzeW5jIGRlZiBkZWxldGVfYWRtaW5fYnJva2VyKGJyb2tlcl9pZDogc3Ry
LCBjdXJyZW50X2FkbWluID0gRGVwZW5kcyhnZXRfY3VycmVudF9hZG1pbikpOgogICAgIiIiCiAg
ICBEZWxldGUgYSBicm9rZXIgKGFkbWluIG9ubHkpIC0gY29tcGxldGVseSByZW1vdmVzIGl0IGFu
ZCBhbGwgbm90aWZpY2F0aW9ucwogICAgIiIiCiAgICB0cnk6CiAgICAgICAgIyBEZWxldGUgdGhl
IGJyb2tlcgogICAgICAgIGJyb2tlcl9yZXN1bHQgPSBhd2FpdCBkYi5icm9rZXJzLmRlbGV0ZV9v
bmUoeyJfaWQiOiBPYmplY3RJZChicm9rZXJfaWQpfSkKICAgICAgICAKICAgICAgICBpZiBicm9r
ZXJfcmVzdWx0LmRlbGV0ZWRfY291bnQgPT0gMDoKICAgICAgICAgICAgcmFpc2UgSFRUUEV4Y2Vw
dGlvbihzdGF0dXNfY29kZT00MDQsIGRldGFpbD0iQnJva2VyIG5vdCBmb3VuZCIpCiAgICAgICAg
CiAgICAgICAgIyBEZWxldGUgYWxsIGJyb2tlciBub3RpZmljYXRpb25zIGZvciB0aGlzIGJyb2tl
cgogICAgICAgIGF3YWl0IGRiLmJyb2tlcl9ub3RpZmljYXRpb25zLmRlbGV0ZV9tYW55KHsiYnJv
a2VyX2lkIjogYnJva2VyX2lkfSkKICAgICAgICAKICAgICAgICBsb2dnZXIuaW5mbyhmIkFkbWlu
IGRlbGV0ZWQgYnJva2VyIHticm9rZXJfaWR9IikKICAgICAgICByZXR1cm4geyJtZXNzYWdlIjog
IkJyb2tlciBkZWxldGVkIHN1Y2Nlc3NmdWxseSJ9CiAgICAgICAgCiAgICBleGNlcHQgSFRUUEV4
Y2VwdGlvbjoKICAgICAgICByYWlzZQogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAg
IGxvZ2dlci5lcnJvcihmIkVycm9yIGRlbGV0aW5nIGJyb2tlcjoge3N0cihlKX0iKQogICAgICAg
IHJhaXNlIEhUVFBFeGNlcHRpb24oc3RhdHVzX2NvZGU9NTAwLCBkZXRhaWw9ZiJGYWlsZWQgdG8g
ZGVsZXRlIGJyb2tlcjoge3N0cihlKX0iKQoKCkBhcGlfcm91dGVyLnBvc3QoIi9tZW50b3IvYnJv
a2VycyIpCmFzeW5jIGRlZiBtZW50b3JfYWRkX2Jyb2tlcihicm9rZXI6IEJyb2tlckFmZmlsaWF0
ZSwgY3VycmVudF9tZW50b3IgPSBEZXBlbmRzKGdldF9jdXJyZW50X21lbnRvcikpOgogICAgIiIi
CiAgICBNZW50b3IgYWRkcyBhIGJyb2tlciBhZmZpbGlhdGUgbGluayB0aGF0IHdpbGwgYmUgc2Vu
dCB0byB0aGVpciB1c2VycyBvbmx5CiAgICAiIiIKICAgIHRyeToKICAgICAgICBtZW50b3JfaWQg
PSBjdXJyZW50X21lbnRvci5nZXQoIm1lbnRvcl9pZCIpCiAgICAgICAgCiAgICAgICAgIyBHZXQg
bWVudG9yJ3MgYWN0aXZlIHBhaWQgdXNlcnMKICAgICAgICBtZW50b3JfdXNlcnMgPSBhd2FpdCBk
Yi51c2Vycy5maW5kKHsKICAgICAgICAgICAgIm1lbnRvcl9pZCI6IG1lbnRvcl9pZCwKICAgICAg
ICAgICAgInN0YXR1cyI6ICJhY3RpdmUiLAogICAgICAgICAgICAicGF5bWVudF9zdGF0dXMiOiAi
cGFpZCIKICAgICAgICB9KS50b19saXN0KGxlbmd0aD0xMDAwKQogICAgICAgIAogICAgICAgIGlm
IG5vdCBtZW50b3JfdXNlcnM6CiAgICAgICAgICAgIHJhaXNlIEhUVFBFeGNlcHRpb24oc3RhdHVz
X2NvZGU9NDA0LCBkZXRhaWw9Ik5vIGFjdGl2ZSB1c2VycyBmb3VuZCB1bmRlciB5b3VyIG1lbnRv
ciBJRCIpCiAgICAgICAgCiAgICAgICAgYnJva2VyX2RvYyA9IHsKICAgICAgICAgICAgImJyb2tl
cl9uYW1lIjogYnJva2VyLmJyb2tlcl9uYW1lLAogICAgICAgICAgICAiYnJva2VyX2ltYWdlIjog
YnJva2VyLmJyb2tlcl9pbWFnZSwKICAgICAgICAgICAgImFmZmlsaWF0ZV9saW5rIjogYnJva2Vy
LmFmZmlsaWF0ZV9saW5rLAogICAgICAgICAgICAiZGVzY3JpcHRpb24iOiBicm9rZXIuZGVzY3Jp
cHRpb24gb3IgIiIsCiAgICAgICAgICAgICJhZGRlZF9ieV90eXBlIjogIm1lbnRvciIsCiAgICAg
ICAgICAgICJhZGRlZF9ieV9pZCI6IHN0cihjdXJyZW50X21lbnRvclsiX2lkIl0pLAogICAgICAg
ICAgICAibWVudG9yX2lkIjogbWVudG9yX2lkLAogICAgICAgICAgICAiY3JlYXRlZF9hdCI6IGRh
dGV0aW1lLnV0Y25vdygpLAogICAgICAgICAgICAic3RhdHVzIjogImFjdGl2ZSIKICAgICAgICB9
CiAgICAgICAgCiAgICAgICAgcmVzdWx0ID0gYXdhaXQgZGIuYnJva2Vycy5pbnNlcnRfb25lKGJy
b2tlcl9kb2MpCiAgICAgICAgYnJva2VyX2lkID0gc3RyKHJlc3VsdC5pbnNlcnRlZF9pZCkKICAg
ICAgICAKICAgICAgICAjIFNlbmQgbm90aWZpY2F0aW9uIHRvIG1lbnRvcidzIHVzZXJzIG9ubHkK
ICAgICAgICBub3RpZmljYXRpb25fY291bnQgPSAwCiAgICAgICAgZm9yIHVzZXIgaW4gbWVudG9y
X3VzZXJzOgogICAgICAgICAgICBhd2FpdCBkYi5icm9rZXJfbm90aWZpY2F0aW9ucy5pbnNlcnRf
b25lKHsKICAgICAgICAgICAgICAgICJicm9rZXJfaWQiOiBicm9rZXJfaWQsCiAgICAgICAgICAg
ICAgICAidXNlcl9pZCI6IHN0cih1c2VyWyJfaWQiXSksCiAgICAgICAgICAgICAgICAic2VlbiI6
IEZhbHNlLAogICAgICAgICAgICAgICAgImNyZWF0ZWRfYXQiOiBkYXRldGltZS51dGNub3coKQog
ICAgICAgICAgICB9KQogICAgICAgICAgICBub3RpZmljYXRpb25fY291bnQgKz0gMQogICAgICAg
IAogICAgICAgIGxvZ2dlci5pbmZvKGYi4pyFIE1lbnRvciB7bWVudG9yX2lkfSBhZGRlZCBicm9r
ZXI6IHticm9rZXIuYnJva2VyX25hbWV9LCBub3RpZmllZCB7bm90aWZpY2F0aW9uX2NvdW50fSB1
c2VycyIpCiAgICAgICAgCiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgIm1lc3NhZ2UiOiAi
QnJva2VyIGFkZGVkIHN1Y2Nlc3NmdWxseSIsCiAgICAgICAgICAgICJicm9rZXJfaWQiOiBicm9r
ZXJfaWQsCiAgICAgICAgICAgICJub3RpZmllZF91c2VycyI6IG5vdGlmaWNhdGlvbl9jb3VudAog
ICAgICAgIH0KICAgICAgICAKICAgIGV4Y2VwdCBIVFRQRXhjZXB0aW9uOgogICAgICAgIHJhaXNl
CiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgbG9nZ2VyLmVycm9yKGYiRXJyb3Ig
YWRkaW5nIG1lbnRvciBicm9rZXI6IHtzdHIoZSl9IikKICAgICAgICByYWlzZSBIVFRQRXhjZXB0
aW9uKHN0YXR1c19jb2RlPTUwMCwgZGV0YWlsPWYiRmFpbGVkIHRvIGFkZCBicm9rZXI6IHtzdHIo
ZSl9IikKCgpAYXBpX3JvdXRlci5nZXQoIi9tZW50b3IvYnJva2VycyIpCmFzeW5jIGRlZiBnZXRf
bWVudG9yX2Jyb2tlcnMoY3VycmVudF9tZW50b3IgPSBEZXBlbmRzKGdldF9jdXJyZW50X21lbnRv
cikpOgogICAgIiIiCiAgICBHZXQgYWxsIGJyb2tlcnMgYWRkZWQgYnkgdGhpcyBtZW50b3IKICAg
ICIiIgogICAgdHJ5OgogICAgICAgIG1lbnRvcl9pZCA9IGN1cnJlbnRfbWVudG9yLmdldCgibWVu
dG9yX2lkIikKICAgICAgICAKICAgICAgICBicm9rZXJzID0gYXdhaXQgZGIuYnJva2Vycy5maW5k
KHsKICAgICAgICAgICAgImFkZGVkX2J5X3R5cGUiOiAibWVudG9yIiwKICAgICAgICAgICAgIm1l
bnRvcl9pZCI6IG1lbnRvcl9pZCwKICAgICAgICAgICAgInN0YXR1cyI6ICJhY3RpdmUiCiAgICAg
ICAgfSkuc29ydCgiY3JlYXRlZF9hdCIsIC0xKS50b19saXN0KGxlbmd0aD0xMDApCiAgICAgICAg
CiAgICAgICAgcmV0dXJuIHsiYnJva2VycyI6IFtzZXJpYWxpemVfZG9jKGIpIGZvciBiIGluIGJy
b2tlcnNdfQogICAgICAgIAogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIGxvZ2dl
ci5lcnJvcihmIkVycm9yIGZldGNoaW5nIG1lbnRvciBicm9rZXJzOiB7c3RyKGUpfSIpCiAgICAg
ICAgcmFpc2UgSFRUUEV4Y2VwdGlvbihzdGF0dXNfY29kZT01MDAsIGRldGFpbD1mIkZhaWxlZCB0
byBmZXRjaCBicm9rZXJzOiB7c3RyKGUpfSIpCgoKQGFwaV9yb3V0ZXIuZGVsZXRlKCIvbWVudG9y
L2Jyb2tlcnMve2Jyb2tlcl9pZH0iKQphc3luYyBkZWYgZGVsZXRlX21lbnRvcl9icm9rZXIoYnJv
a2VyX2lkOiBzdHIsIGN1cnJlbnRfbWVudG9yID0gRGVwZW5kcyhnZXRfY3VycmVudF9tZW50b3Ip
KToKICAgICIiIgogICAgRGVsZXRlIGEgYnJva2VyIGFmZmlsaWF0ZSBsaW5rIChtZW50b3Igb25s
eSBjYW4gZGVsZXRlIHRoZWlyIG93bikKICAgIEFsc28gZGVsZXRlcyBhbGwgYXNzb2NpYXRlZCBu
b3RpZmljYXRpb25zCiAgICAiIiIKICAgIHRyeToKICAgICAgICBtZW50b3JfaWQgPSBjdXJyZW50
X21lbnRvci5nZXQoIm1lbnRvcl9pZCIpCiAgICAgICAgCiAgICAgICAgIyBDaGVjayBpZiBicm9r
ZXIgZXhpc3RzIGFuZCBiZWxvbmdzIHRvIHRoaXMgbWVudG9yCiAgICAgICAgYnJva2VyID0gYXdh
aXQgZGIuYnJva2Vycy5maW5kX29uZSh7CiAgICAgICAgICAgICJfaWQiOiBPYmplY3RJZChicm9r
ZXJfaWQpLAogICAgICAgICAgICAibWVudG9yX2lkIjogbWVudG9yX2lkLAogICAgICAgICAgICAi
YWRkZWRfYnlfdHlwZSI6ICJtZW50b3IiCiAgICAgICAgfSkKICAgICAgICAKICAgICAgICBpZiBu
b3QgYnJva2VyOgogICAgICAgICAgICByYWlzZSBIVFRQRXhjZXB0aW9uKHN0YXR1c19jb2RlPTQw
NCwgZGV0YWlsPSJCcm9rZXIgbm90IGZvdW5kIG9yIG5vdCBhdXRob3JpemVkIHRvIGRlbGV0ZSIp
CiAgICAgICAgCiAgICAgICAgIyBEZWxldGUgYnJva2VyCiAgICAgICAgcmVzdWx0ID0gYXdhaXQg
ZGIuYnJva2Vycy5kZWxldGVfb25lKHsiX2lkIjogT2JqZWN0SWQoYnJva2VyX2lkKX0pCiAgICAg
ICAgCiAgICAgICAgIyBEZWxldGUgYXNzb2NpYXRlZCBub3RpZmljYXRpb25zCiAgICAgICAgYXdh
aXQgZGIuYnJva2VyX25vdGlmaWNhdGlvbnMuZGVsZXRlX21hbnkoeyJicm9rZXJfaWQiOiBicm9r
ZXJfaWR9KQogICAgICAgIAogICAgICAgIGlmIHJlc3VsdC5kZWxldGVkX2NvdW50ID4gMDoKICAg
ICAgICAgICAgbG9nZ2VyLmluZm8oZiLinIUgTWVudG9yIHttZW50b3JfaWR9IGRlbGV0ZWQgYnJv
a2VyOiB7YnJva2VyLmdldCgnYnJva2VyX25hbWUnKX0iKQogICAgICAgICAgICByZXR1cm4gewog
ICAgICAgICAgICAgICAgIm1lc3NhZ2UiOiAiQnJva2VyIGRlbGV0ZWQgc3VjY2Vzc2Z1bGx5IiwK
ICAgICAgICAgICAgICAgICJicm9rZXJfaWQiOiBicm9rZXJfaWQKICAgICAgICAgICAgfQogICAg
ICAgIGVsc2U6CiAgICAgICAgICAgIHJhaXNlIEhUVFBFeGNlcHRpb24oc3RhdHVzX2NvZGU9NTAw
LCBkZXRhaWw9IkZhaWxlZCB0byBkZWxldGUgYnJva2VyIikKICAgICAgICAgICAgCiAgICBleGNl
cHQgSFRUUEV4Y2VwdGlvbjoKICAgICAgICByYWlzZQogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBl
OgogICAgICAgIGxvZ2dlci5lcnJvcihmIkVycm9yIGRlbGV0aW5nIG1lbnRvciBicm9rZXI6IHtz
dHIoZSl9IikKICAgICAgICByYWlzZSBIVFRQRXhjZXB0aW9uKHN0YXR1c19jb2RlPTUwMCwgZGV0
YWlsPWYiRmFpbGVkIHRvIGRlbGV0ZSBicm9rZXI6IHtzdHIoZSl9IikKCgojID09PT09PT09PT09
PT09PT09PT09IE1BUktFVCBORVdTID09PT09PT09PT09PT09PT09PT09CgpAYXBpX3JvdXRlci5w
b3N0KCIvYWRtaW4vbmV3cyIpCmFzeW5jIGRlZiBjcmVhdGVfbmV3cyhuZXdzOiBNYXJrZXROZXdz
LCBjdXJyZW50X2FkbWluID0gRGVwZW5kcyhnZXRfY3VycmVudF9hZG1pbikpOgogICAgIiIiCiAg
ICBBZG1pbiBjcmVhdGVzIG1hcmtldCBuZXdzL2V2ZW50CiAgICAiIiIKICAgIHRyeToKICAgICAg
ICBuZXdzX2RvYyA9IHsKICAgICAgICAgICAgInRpdGxlIjogbmV3cy50aXRsZSwKICAgICAgICAg
ICAgImV2ZW50X3RpbWUiOiBuZXdzLmV2ZW50X3RpbWUsCiAgICAgICAgICAgICJjdXJyZW5jeSI6
IG5ld3MuY3VycmVuY3ksCiAgICAgICAgICAgICJpbXBhY3QiOiBuZXdzLmltcGFjdCwKICAgICAg
ICAgICAgInNpZ25hbCI6IG5ld3Muc2lnbmFsLAogICAgICAgICAgICAic2VuZGVyX3R5cGUiOiAi
YWRtaW4iLAogICAgICAgICAgICAic2VuZGVyX2lkIjogc3RyKGN1cnJlbnRfYWRtaW5bIl9pZCJd
KSwKICAgICAgICAgICAgImNyZWF0ZWRfYXQiOiBkYXRldGltZS51dGNub3coKSwKICAgICAgICAg
ICAgInN0YXR1cyI6ICJhY3RpdmUiCiAgICAgICAgfQogICAgICAgIAogICAgICAgIHJlc3VsdCA9
IGF3YWl0IGRiLm1hcmtldF9uZXdzLmluc2VydF9vbmUobmV3c19kb2MpCiAgICAgICAgCiAgICAg
ICAgcmV0dXJuIHsKICAgICAgICAgICAgIm1lc3NhZ2UiOiAiTmV3cyBjcmVhdGVkIHN1Y2Nlc3Nm
dWxseSIsCiAgICAgICAgICAgICJuZXdzX2lkIjogc3RyKHJlc3VsdC5pbnNlcnRlZF9pZCkKICAg
ICAgICB9CiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgbG9nZ2VyLmVycm9yKGYi
RXJyb3IgY3JlYXRpbmcgbmV3czoge3N0cihlKX0iKQogICAgICAgIHJhaXNlIEhUVFBFeGNlcHRp
b24oc3RhdHVzX2NvZGU9NTAwLCBkZXRhaWw9ZiJGYWlsZWQgdG8gY3JlYXRlIG5ld3M6IHtzdHIo
ZSl9IikKCgpAYXBpX3JvdXRlci5wb3N0KCIvbWVudG9yL25ld3MiKQphc3luYyBkZWYgY3JlYXRl
X21lbnRvcl9uZXdzKG5ld3M6IE1hcmtldE5ld3MsIGN1cnJlbnRfbWVudG9yID0gRGVwZW5kcyhn
ZXRfY3VycmVudF9tZW50b3IpKToKICAgICIiIgogICAgTWVudG9yIGNyZWF0ZXMgbWFya2V0IG5l
d3MvZXZlbnQgZm9yIHRoZWlyIHVzZXJzCiAgICAiIiIKICAgIHRyeToKICAgICAgICBtZW50b3Jf
aWQgPSBjdXJyZW50X21lbnRvci5nZXQoIm1lbnRvcl9pZCIpCiAgICAgICAgCiAgICAgICAgbmV3
c19kb2MgPSB7CiAgICAgICAgICAgICJ0aXRsZSI6IG5ld3MudGl0bGUsCiAgICAgICAgICAgICJl
dmVudF90aW1lIjogbmV3cy5ldmVudF90aW1lLAogICAgICAgICAgICAiY3VycmVuY3kiOiBuZXdz
LmN1cnJlbmN5LAogICAgICAgICAgICAiaW1wYWN0IjogbmV3cy5pbXBhY3QsCiAgICAgICAgICAg
ICJzaWduYWwiOiBuZXdzLnNpZ25hbCwKICAgICAgICAgICAgInNlbmRlcl90eXBlIjogIm1lbnRv
ciIsCiAgICAgICAgICAgICJzZW5kZXJfaWQiOiBtZW50b3JfaWQsCiAgICAgICAgICAgICJjcmVh
dGVkX2F0IjogZGF0ZXRpbWUudXRjbm93KCksCiAgICAgICAgICAgICJzdGF0dXMiOiAiYWN0aXZl
IgogICAgICAgIH0KICAgICAgICAKICAgICAgICByZXN1bHQgPSBhd2FpdCBkYi5tYXJrZXRfbmV3
cy5pbnNlcnRfb25lKG5ld3NfZG9jKQogICAgICAgIAogICAgICAgIHJldHVybiB7CiAgICAgICAg
ICAgICJtZXNzYWdlIjogIk5ld3MgY3JlYXRlZCBzdWNjZXNzZnVsbHkiLAogICAgICAgICAgICAi
bmV3c19pZCI6IHN0cihyZXN1bHQuaW5zZXJ0ZWRfaWQpCiAgICAgICAgfQogICAgZXhjZXB0IEV4
Y2VwdGlvbiBhcyBlOgogICAgICAgIGxvZ2dlci5lcnJvcihmIkVycm9yIGNyZWF0aW5nIG5ld3M6
IHtzdHIoZSl9IikKICAgICAgICByYWlzZSBIVFRQRXhjZXB0aW9uKHN0YXR1c19jb2RlPTUwMCwg
ZGV0YWlsPWYiRmFpbGVkIHRvIGNyZWF0ZSBuZXdzOiB7c3RyKGUpfSIpCgoKCkBhcGlfcm91dGVy
LmdldCgiL2FkbWluL25ld3MiKQphc3luYyBkZWYgZ2V0X2FkbWluX25ld3MoY3VycmVudF9hZG1p
biA9IERlcGVuZHMoZ2V0X2N1cnJlbnRfYWRtaW4pKToKICAgICIiIgogICAgR2V0IGFsbCBtYW51
YWwgbmV3cyBmb3IgYWRtaW4gdG8gdmlldwogICAgIiIiCiAgICB0cnk6CiAgICAgICAgIyBHZXQg
YWxsIG1hbnVhbCBuZXdzIChmcm9tIGFueSBzb3VyY2UpCiAgICAgICAgbmV3c19jdXJzb3IgPSBk
Yi5tYW51YWxfbmV3cy5maW5kKHsKICAgICAgICAgICAgInN0YXR1cyI6ICJhY3RpdmUiCiAgICAg
ICAgfSkuc29ydCgiY3JlYXRlZF9hdCIsIC0xKS5saW1pdCg1MCkKICAgICAgICBtYW51YWxfbmV3
c19saXN0ID0gYXdhaXQgbmV3c19jdXJzb3IudG9fbGlzdChsZW5ndGg9NTApCiAgICAgICAgCiAg
ICAgICAgIyBGb3JtYXQgbmV3cyB3aXRoIG9wdGlvbmFsIGZpZWxkcwogICAgICAgIGZvcm1hdHRl
ZF9uZXdzID0gW10KICAgICAgICBmb3IgaXRlbSBpbiBtYW51YWxfbmV3c19saXN0OgogICAgICAg
ICAgICBuZXdzX2l0ZW0gPSB7CiAgICAgICAgICAgICAgICAiaWQiOiBzdHIoaXRlbVsiX2lkIl0p
LAogICAgICAgICAgICAgICAgInRpdGxlIjogaXRlbVsidGl0bGUiXSwKICAgICAgICAgICAgICAg
ICJzZW5kZXJfdHlwZSI6IGl0ZW0uZ2V0KCJzZW5kZXJfdHlwZSIsICJ1bmtub3duIiksCiAgICAg
ICAgICAgICAgICAic2VuZGVyX2VtYWlsIjogaXRlbS5nZXQoInNlbmRlcl9lbWFpbCIsICIiKSwK
ICAgICAgICAgICAgICAgICJjcmVhdGVkX2F0IjogaXRlbVsiY3JlYXRlZF9hdCJdLmlzb2Zvcm1h
dCgpLAogICAgICAgICAgICB9CiAgICAgICAgICAgIAogICAgICAgICAgICAjIEFkZCBvcHRpb25h
bCBmaWVsZHMgaWYgdGhleSBleGlzdAogICAgICAgICAgICBpZiBpdGVtLmdldCgiZXZlbnRfdGlt
ZSIpOgogICAgICAgICAgICAgICAgbmV3c19pdGVtWyJldmVudF90aW1lIl0gPSBpdGVtWyJldmVu
dF90aW1lIl0KICAgICAgICAgICAgaWYgaXRlbS5nZXQoImN1cnJlbmN5Iik6CiAgICAgICAgICAg
ICAgICBuZXdzX2l0ZW1bImN1cnJlbmN5Il0gPSBpdGVtWyJjdXJyZW5jeSJdCiAgICAgICAgICAg
IGlmIGl0ZW0uZ2V0KCJpbXBhY3QiKToKICAgICAgICAgICAgICAgIG5ld3NfaXRlbVsiaW1wYWN0
Il0gPSBpdGVtWyJpbXBhY3QiXQogICAgICAgICAgICBpZiBpdGVtLmdldCgic2lnbmFsIik6CiAg
ICAgICAgICAgICAgICBuZXdzX2l0ZW1bInNpZ25hbCJdID0gaXRlbVsic2lnbmFsIl0KICAgICAg
ICAgICAgaWYgaXRlbS5nZXQoImRlc2NyaXB0aW9uIik6CiAgICAgICAgICAgICAgICBuZXdzX2l0
ZW1bImRlc2NyaXB0aW9uIl0gPSBpdGVtWyJkZXNjcmlwdGlvbiJdCiAgICAgICAgICAgIGlmIGl0
ZW0uZ2V0KCJtZW50b3JfaWQiKToKICAgICAgICAgICAgICAgIG5ld3NfaXRlbVsibWVudG9yX2lk
Il0gPSBpdGVtWyJtZW50b3JfaWQiXQogICAgICAgICAgICAKICAgICAgICAgICAgZm9ybWF0dGVk
X25ld3MuYXBwZW5kKG5ld3NfaXRlbSkKICAgICAgICAKICAgICAgICByZXR1cm4geyJuZXdzIjog
Zm9ybWF0dGVkX25ld3N9CiAgICAgICAgCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAg
ICAgbG9nZ2VyLmVycm9yKGYiRXJyb3IgZmV0Y2hpbmcgYWRtaW4gbmV3czoge3N0cihlKX0iKQog
ICAgICAgIHJhaXNlIEhUVFBFeGNlcHRpb24oc3RhdHVzX2NvZGU9NTAwLCBkZXRhaWw9ZiJGYWls
ZWQgdG8gZmV0Y2ggbmV3czoge3N0cihlKX0iKQoKCgpAYXBpX3JvdXRlci5nZXQoIi9tZW50b3Iv
dXBjb21pbmctbmV3cyIpCmFzeW5jIGRlZiBnZXRfbWVudG9yX3VwY29taW5nX25ld3MoY3VycmVu
dF9tZW50b3IgPSBEZXBlbmRzKGdldF9jdXJyZW50X21lbnRvcikpOgogICAgIiIiCiAgICBHZXQg
dXBjb21pbmcgbmV3cyBldmVudHMgZm9yIG5leHQgNyBkYXlzIGZvciBtZW50b3IgdG8gYWRkIHNp
Z25hbHMKICAgIE9ubHkgc2hvd3MgRlVUVVJFIGV2ZW50cywgbm8gb2xkL3Bhc3QgZXZlbnRzCiAg
ICAiIiIKICAgIHRyeToKICAgICAgICBmcm9tIGRhdGV0aW1lIGltcG9ydCBkYXRldGltZSwgdGlt
ZWRlbHRhCiAgICAgICAgCiAgICAgICAgIyBGZXRjaCBsaXZlIGVjb25vbWljIGNhbGVuZGFyIChh
bHJlYWR5IGZpbHRlcmVkIGZvciBuZXh0IDcgZGF5cywgZnV0dXJlIG9ubHkpCiAgICAgICAgbGl2
ZV9ldmVudHMgPSBhd2FpdCBmZXRjaF9saXZlX2Vjb25vbWljX2NhbGVuZGFyKCkKICAgICAgICAK
ICAgICAgICAjIEdldCBhbGwgbmV3cyAoYWRtaW4gKyBtZW50b3IncyBvd24gbmV3cykKICAgICAg
ICBtZW50b3JfaWQgPSBjdXJyZW50X21lbnRvci5nZXQoIm1lbnRvcl9pZCIpCiAgICAgICAgbmV3
c19jdXJzb3IgPSBkYi5tYXJrZXRfbmV3cy5maW5kKHsKICAgICAgICAgICAgIiRvciI6IFsKICAg
ICAgICAgICAgICAgIHsic2VuZGVyX3R5cGUiOiAiYWRtaW4ifSwKICAgICAgICAgICAgICAgIHsi
c2VuZGVyX3R5cGUiOiAibWVudG9yIiwgInNlbmRlcl9pZCI6IG1lbnRvcl9pZH0KICAgICAgICAg
ICAgXSwKICAgICAgICAgICAgInN0YXR1cyI6ICJhY3RpdmUiCiAgICAgICAgfSkuc29ydCgiY3Jl
YXRlZF9hdCIsIC0xKQogICAgICAgIG1hbnVhbF9uZXdzID0gYXdhaXQgbmV3c19jdXJzb3IudG9f
bGlzdChsZW5ndGg9MTAwKQogICAgICAgIAogICAgICAgICMgQ29tYmluZSBhbmQgZm9ybWF0CiAg
ICAgICAgYWxsX25ld3MgPSBbXQogICAgICAgIG5vdyA9IGRhdGV0aW1lLnV0Y25vdygpCiAgICAg
ICAgbWF4X2Z1dHVyZV9kYXRlID0gbm93ICsgdGltZWRlbHRhKGRheXM9NykKICAgICAgICAKICAg
ICAgICAjIEFkZCBsaXZlIGV2ZW50cyAoYWxyZWFkeSBmaWx0ZXJlZCBmb3IgdXBjb21pbmcgb25s
eSkKICAgICAgICBmb3IgZXZlbnQgaW4gbGl2ZV9ldmVudHM6CiAgICAgICAgICAgIHRyeToKICAg
ICAgICAgICAgICAgIGV2ZW50X2R0ID0gZGF0ZXRpbWUuZnJvbWlzb2Zvcm1hdChldmVudC5nZXQo
ImV2ZW50X2RhdGV0aW1lIiwgIiIpKQogICAgICAgICAgICAgICAgdGltZV9kaWZmID0gKGV2ZW50
X2R0IC0gbm93KS50b3RhbF9zZWNvbmRzKCkgLyAzNjAwICAjIGhvdXJzCiAgICAgICAgICAgICAg
ICAKICAgICAgICAgICAgICAgIGFsbF9uZXdzLmFwcGVuZCh7CiAgICAgICAgICAgICAgICAgICAg
KipldmVudCwKICAgICAgICAgICAgICAgICAgICAiaXNfbGl2ZSI6IFRydWUsCiAgICAgICAgICAg
ICAgICAgICAgImhvdXJzX3VudGlsIjogcm91bmQodGltZV9kaWZmLCAxKQogICAgICAgICAgICAg
ICAgfSkKICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgY29udGludWUKICAgICAg
ICAKICAgICAgICAjIEdldCBtZW50b3IncyBzaWduYWxzIG9uIG5ld3MgZXZlbnRzCiAgICAgICAg
bWVudG9yX3NpZ25hbHMgPSB7fQogICAgICAgIHNpZ25hbHNfY3Vyc29yID0gZGIubmV3c19zaWdu
YWxzLmZpbmQoeyJtZW50b3JfaWQiOiBtZW50b3JfaWR9KQogICAgICAgIHNpZ25hbHNfbGlzdCA9
IGF3YWl0IHNpZ25hbHNfY3Vyc29yLnRvX2xpc3QobGVuZ3RoPTEwMCkKICAgICAgICBmb3Igc2ln
IGluIHNpZ25hbHNfbGlzdDoKICAgICAgICAgICAgbWVudG9yX3NpZ25hbHNbc2lnWyJldmVudF9p
ZCJdXSA9IHNpZy5nZXQoInNpZ25hbCIpCiAgICAgICAgCiAgICAgICAgIyBBZGQgbWFudWFsIG5l
d3MgKHdpdGggbWVudG9yIHNpZ25hbHMgaWYgYXBwbGljYWJsZSkKICAgICAgICAjIEFsc28gZmls
dGVyIHRvIG9ubHkgc2hvdyB1cGNvbWluZyBtYW51YWwgbmV3cwogICAgICAgIGZvciBpdGVtIGlu
IG1hbnVhbF9uZXdzOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAjIFBhcnNlIGV2
ZW50IHRpbWUKICAgICAgICAgICAgICAgIGV2ZW50X3RpbWVfc3RyID0gaXRlbS5nZXQoImV2ZW50
X3RpbWUiLCAiIikKICAgICAgICAgICAgICAgICMgSWYgaXQncyBhIGRhdGV0aW1lIHN0cmluZywg
cGFyc2UgaXQKICAgICAgICAgICAgICAgIGlmICJUIiBpbiBldmVudF90aW1lX3N0ciBvciBsZW4o
ZXZlbnRfdGltZV9zdHIpID4gMTA6CiAgICAgICAgICAgICAgICAgICAgZXZlbnRfZHQgPSBkYXRl
dGltZS5mcm9taXNvZm9ybWF0KGV2ZW50X3RpbWVfc3RyLnJlcGxhY2UoIloiLCAiKzAwOjAwIikp
CiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICMgSWYganVzdCB0aW1l
LCBhc3N1bWUgdG9kYXkKICAgICAgICAgICAgICAgICAgICB0b2RheSA9IGRhdGV0aW1lLnV0Y25v
dygpLmRhdGUoKQogICAgICAgICAgICAgICAgICAgIHRpbWVfb2JqID0gZGF0ZXRpbWUuc3RycHRp
bWUoZXZlbnRfdGltZV9zdHIsICIlSDolTSIpLnRpbWUoKQogICAgICAgICAgICAgICAgICAgIGV2
ZW50X2R0ID0gZGF0ZXRpbWUuY29tYmluZSh0b2RheSwgdGltZV9vYmopCiAgICAgICAgICAgICAg
ICAKICAgICAgICAgICAgICAgICMgT25seSBpbmNsdWRlIGZ1dHVyZSBldmVudHMgd2l0aGluIDcg
ZGF5cwogICAgICAgICAgICAgICAgaWYgZXZlbnRfZHQgPD0gbm93IG9yIGV2ZW50X2R0ID4gbWF4
X2Z1dHVyZV9kYXRlOgogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgICAg
ICAgICAgCiAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgICMgSWYgY2FuJ3QgcGFy
c2UgZGF0ZSwgc2tpcCB0aGlzIGV2ZW50CiAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAg
ICAgICAKICAgICAgICAgICAgbmV3c19pZCA9IHN0cihpdGVtWyJfaWQiXSkKICAgICAgICAgICAg
IyBDaGVjayBpZiBtZW50b3IgaGFzIHNldCBhIHNpZ25hbCBvdmVycmlkZQogICAgICAgICAgICBz
aWduYWwgPSBtZW50b3Jfc2lnbmFscy5nZXQobmV3c19pZCwgaXRlbS5nZXQoInNpZ25hbCIpKQog
ICAgICAgICAgICAKICAgICAgICAgICAgYWxsX25ld3MuYXBwZW5kKHsKICAgICAgICAgICAgICAg
ICJpZCI6IG5ld3NfaWQsCiAgICAgICAgICAgICAgICAidGl0bGUiOiBpdGVtWyJ0aXRsZSJdLAog
ICAgICAgICAgICAgICAgImV2ZW50X3RpbWUiOiBpdGVtWyJldmVudF90aW1lIl0sCiAgICAgICAg
ICAgICAgICAiZXZlbnRfZGF0ZXRpbWUiOiBpdGVtLmdldCgiZXZlbnRfdGltZSIpLAogICAgICAg
ICAgICAgICAgImN1cnJlbmN5IjogaXRlbVsiY3VycmVuY3kiXSwKICAgICAgICAgICAgICAgICJp
bXBhY3QiOiBpdGVtWyJpbXBhY3QiXSwKICAgICAgICAgICAgICAgICJzaWduYWwiOiBzaWduYWws
CiAgICAgICAgICAgICAgICAiY3JlYXRlZF9hdCI6IGl0ZW1bImNyZWF0ZWRfYXQiXS5pc29mb3Jt
YXQoKSwKICAgICAgICAgICAgICAgICJzb3VyY2UiOiAibWVudG9yIiBpZiBpdGVtWyJzZW5kZXJf
dHlwZSJdID09ICJtZW50b3IiIGVsc2UgImFkbWluIiwKICAgICAgICAgICAgICAgICJpc19saXZl
IjogRmFsc2UKICAgICAgICAgICAgfSkKICAgICAgICAKICAgICAgICAjIFNvcnQgYnkgdGltZQog
ICAgICAgIGxvZ2dlci5pbmZvKGYiUmV0dXJuaW5nIHtsZW4oYWxsX25ld3MpfSB1cGNvbWluZyBu
ZXdzIGV2ZW50cyBmb3IgbWVudG9yICg3LWRheSBmb3JlY2FzdCkiKQogICAgICAgIHJldHVybiB7
Im5ld3MiOiBhbGxfbmV3c30KICAgICAgICAKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAg
ICAgICBsb2dnZXIuZXJyb3IoZiJFcnJvciBmZXRjaGluZyB1cGNvbWluZyBuZXdzOiB7c3RyKGUp
fSIpCiAgICAgICAgcmFpc2UgSFRUUEV4Y2VwdGlvbihzdGF0dXNfY29kZT01MDAsIGRldGFpbD1m
IkZhaWxlZCB0byBmZXRjaCBuZXdzOiB7c3RyKGUpfSIpCgoKQGFwaV9yb3V0ZXIucHV0KCIvbWVu
dG9yL25ld3Mve25ld3NfaWR9L3NpZ25hbCIpCmFzeW5jIGRlZiB1cGRhdGVfbmV3c19zaWduYWwo
CiAgICBuZXdzX2lkOiBzdHIsCiAgICBzaWduYWxfZGF0YTogZGljdCwKICAgIGN1cnJlbnRfbWVu
dG9yID0gRGVwZW5kcyhnZXRfY3VycmVudF9tZW50b3IpCik6CiAgICAiIiIKICAgIE1lbnRvciB1
cGRhdGVzIHNpZ25hbCAoQlVZL1NFTEwpIG9uIGEgbmV3cyBldmVudAogICAgIiIiCiAgICB0cnk6
CiAgICAgICAgbWVudG9yX2lkID0gY3VycmVudF9tZW50b3IuZ2V0KCJtZW50b3JfaWQiKQogICAg
ICAgIHNpZ25hbCA9IHNpZ25hbF9kYXRhLmdldCgic2lnbmFsIikgICMgQlVZIG9yIFNFTEwgb3Ig
Tm9uZQogICAgICAgIAogICAgICAgIGlmIHNpZ25hbCBub3QgaW4gWyJCVVkiLCAiU0VMTCIsIE5v
bmVdOgogICAgICAgICAgICByYWlzZSBIVFRQRXhjZXB0aW9uKHN0YXR1c19jb2RlPTQwMCwgZGV0
YWlsPSJTaWduYWwgbXVzdCBiZSBCVVksIFNFTEwsIG9yIE5vbmUiKQogICAgICAgIAogICAgICAg
ICMgQ2hlY2sgaWYgdGhpcyBpcyBtZW50b3IncyBvd24gbmV3cyBpbiBtYXJrZXRfbmV3cyBjb2xs
ZWN0aW9uCiAgICAgICAgdHJ5OgogICAgICAgICAgICAjIFRyeSB0byB1cGRhdGUgaWYgaXQncyBt
ZW50b3IncyBvd24gbmV3cwogICAgICAgICAgICByZXN1bHQgPSBhd2FpdCBkYi5tYXJrZXRfbmV3
cy51cGRhdGVfb25lKAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICJfaWQi
OiBPYmplY3RJZChuZXdzX2lkKSwKICAgICAgICAgICAgICAgICAgICAic2VuZGVyX3R5cGUiOiAi
bWVudG9yIiwKICAgICAgICAgICAgICAgICAgICAic2VuZGVyX2lkIjogbWVudG9yX2lkCiAgICAg
ICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgeyIkc2V0IjogeyJzaWduYWwiOiBzaWduYWws
ICJ1cGRhdGVkX2F0IjogZGF0ZXRpbWUudXRjbm93KCl9fQogICAgICAgICAgICApCiAgICAgICAg
ICAgIAogICAgICAgICAgICBpZiByZXN1bHQubWF0Y2hlZF9jb3VudCA+IDA6CiAgICAgICAgICAg
ICAgICAjIFN1Y2Nlc3NmdWxseSB1cGRhdGVkIG1lbnRvcidzIG93biBuZXdzCiAgICAgICAgICAg
ICAgICBwYXNzCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAjIE5vdCBtZW50b3In
cyBvd24gbmV3cywgc3RvcmUgc2lnbmFsIGluIG5ld3Nfc2lnbmFscyBjb2xsZWN0aW9uCiAgICAg
ICAgICAgICAgICAjIFRoaXMgaGFuZGxlcyBhZG1pbiBuZXdzLCBsaXZlIGV2ZW50cywgb3Igb3Ro
ZXIgbWVudG9yJ3MgbmV3cwogICAgICAgICAgICAgICAgc2lnbmFsX2RvYyA9IHsKICAgICAgICAg
ICAgICAgICAgICAiZXZlbnRfaWQiOiBuZXdzX2lkLAogICAgICAgICAgICAgICAgICAgICJtZW50
b3JfaWQiOiBtZW50b3JfaWQsCiAgICAgICAgICAgICAgICAgICAgInNpZ25hbCI6IHNpZ25hbCwK
ICAgICAgICAgICAgICAgICAgICAidXBkYXRlZF9hdCI6IGRhdGV0aW1lLnV0Y25vdygpCiAgICAg
ICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICMgVXBzZXJ0IHRo
ZSBzaWduYWwKICAgICAgICAgICAgICAgIGF3YWl0IGRiLm5ld3Nfc2lnbmFscy51cGRhdGVfb25l
KAogICAgICAgICAgICAgICAgICAgIHsiZXZlbnRfaWQiOiBuZXdzX2lkLCAibWVudG9yX2lkIjog
bWVudG9yX2lkfSwKICAgICAgICAgICAgICAgICAgICB7IiRzZXQiOiBzaWduYWxfZG9jfSwKICAg
ICAgICAgICAgICAgICAgICB1cHNlcnQ9VHJ1ZQogICAgICAgICAgICAgICAgKQogICAgICAgIGV4
Y2VwdDoKICAgICAgICAgICAgIyBJZiBPYmplY3RJZCBjb252ZXJzaW9uIGZhaWxzIChlLmcuLCBm
b3IgbGl2ZV8gZXZlbnRzKSwgdXNlIG5ld3Nfc2lnbmFscwogICAgICAgICAgICBzaWduYWxfZG9j
ID0gewogICAgICAgICAgICAgICAgImV2ZW50X2lkIjogbmV3c19pZCwKICAgICAgICAgICAgICAg
ICJtZW50b3JfaWQiOiBtZW50b3JfaWQsCiAgICAgICAgICAgICAgICAic2lnbmFsIjogc2lnbmFs
LAogICAgICAgICAgICAgICAgInVwZGF0ZWRfYXQiOiBkYXRldGltZS51dGNub3coKQogICAgICAg
ICAgICB9CiAgICAgICAgICAgIAogICAgICAgICAgICBhd2FpdCBkYi5uZXdzX3NpZ25hbHMudXBk
YXRlX29uZSgKICAgICAgICAgICAgICAgIHsiZXZlbnRfaWQiOiBuZXdzX2lkLCAibWVudG9yX2lk
IjogbWVudG9yX2lkfSwKICAgICAgICAgICAgICAgIHsiJHNldCI6IHNpZ25hbF9kb2N9LAogICAg
ICAgICAgICAgICAgdXBzZXJ0PVRydWUKICAgICAgICAgICAgKQogICAgICAgIAogICAgICAgIHJl
dHVybiB7Im1lc3NhZ2UiOiAiU2lnbmFsIHVwZGF0ZWQgc3VjY2Vzc2Z1bGx5IiwgInNpZ25hbCI6
IHNpZ25hbH0KICAgICAgICAKICAgIGV4Y2VwdCBIVFRQRXhjZXB0aW9uOgogICAgICAgIHJhaXNl
CiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgbG9nZ2VyLmVycm9yKGYiRXJyb3Ig
dXBkYXRpbmcgbmV3cyBzaWduYWw6IHtzdHIoZSl9IikKICAgICAgICByYWlzZSBIVFRQRXhjZXB0
aW9uKHN0YXR1c19jb2RlPTUwMCwgZGV0YWlsPWYiRmFpbGVkIHRvIHVwZGF0ZSBzaWduYWw6IHtz
dHIoZSl9IikKCgpAYXBpX3JvdXRlci5nZXQoIi91c2VyL25ld3MiKQphc3luYyBkZWYgZ2V0X3Vz
ZXJfbmV3cyhjdXJyZW50X3VzZXIgPSBEZXBlbmRzKGdldF9jdXJyZW50X3VzZXIpKToKICAgICIi
IgogICAgR2V0IG1hcmtldCBuZXdzIGZvciB0aGUgdXNlciAoY29tYmluZXMgbGl2ZSBlY29ub21p
YyBjYWxlbmRhciArIG1hbnVhbCBuZXdzICsgbWVudG9yIHNpZ25hbHMpCiAgICBPTkxZIFNIT1dT
IFVQQ09NSU5HIE5FV1MgKG5vdCBwYXN0IGV2ZW50cykKICAgICIiIgogICAgdHJ5OgogICAgICAg
IGZyb20gZGF0ZXRpbWUgaW1wb3J0IGRhdGV0aW1lCiAgICAgICAgdXNlcl9tZW50b3JfaWQgPSBj
dXJyZW50X3VzZXIuZ2V0KCJtZW50b3JfaWQiKQogICAgICAgIG5vdyA9IGRhdGV0aW1lLnV0Y25v
dygpCiAgICAgICAgCiAgICAgICAgIyBHZXQgbWFudWFsIG5ld3MgZnJvbSBhZG1pbiBhbmQgbWVu
dG9yCiAgICAgICAgcXVlcnkgPSB7CiAgICAgICAgICAgICIkb3IiOiBbCiAgICAgICAgICAgICAg
ICB7InNlbmRlcl90eXBlIjogImFkbWluIn0sCiAgICAgICAgICAgICAgICB7InNlbmRlcl90eXBl
IjogIm1lbnRvciIsICJtZW50b3JfaWQiOiB1c2VyX21lbnRvcl9pZH0KICAgICAgICAgICAgXSwK
ICAgICAgICAgICAgInN0YXR1cyI6ICJhY3RpdmUiCiAgICAgICAgfQogICAgICAgIAogICAgICAg
IG5ld3NfY3Vyc29yID0gZGIubWFudWFsX25ld3MuZmluZChxdWVyeSkuc29ydCgiY3JlYXRlZF9h
dCIsIC0xKS5saW1pdCgyMCkKICAgICAgICBtYW51YWxfbmV3c19saXN0ID0gYXdhaXQgbmV3c19j
dXJzb3IudG9fbGlzdChsZW5ndGg9MjApCiAgICAgICAgCiAgICAgICAgIyBGZXRjaCBsaXZlIGVj
b25vbWljIGNhbGVuZGFyCiAgICAgICAgbGl2ZV9uZXdzID0gYXdhaXQgZmV0Y2hfbGl2ZV9lY29u
b21pY19jYWxlbmRhcigpCiAgICAgICAgCiAgICAgICAgIyBHZXQgbWVudG9yJ3Mgc2lnbmFscyBv
biBsaXZlIGV2ZW50cwogICAgICAgIG1lbnRvcl9zaWduYWxzID0ge30KICAgICAgICBpZiB1c2Vy
X21lbnRvcl9pZDoKICAgICAgICAgICAgc2lnbmFsc19jdXJzb3IgPSBkYi5uZXdzX3NpZ25hbHMu
ZmluZCh7Im1lbnRvcl9pZCI6IHVzZXJfbWVudG9yX2lkfSkKICAgICAgICAgICAgc2lnbmFsc19s
aXN0ID0gYXdhaXQgc2lnbmFsc19jdXJzb3IudG9fbGlzdChsZW5ndGg9MTAwKQogICAgICAgICAg
ICBmb3Igc2lnIGluIHNpZ25hbHNfbGlzdDoKICAgICAgICAgICAgICAgIG1lbnRvcl9zaWduYWxz
W3NpZ1siZXZlbnRfaWQiXV0gPSBzaWcuZ2V0KCJzaWduYWwiKQogICAgICAgIAogICAgICAgICMg
Q29tYmluZSBtYW51YWwgbmV3cyB3aXRoIGxpdmUgY2FsZW5kYXIKICAgICAgICBmb3JtYXR0ZWRf
bmV3cyA9IFtdCiAgICAgICAgCiAgICAgICAgIyBBZGQgbWFudWFsIG5ld3MgZmlyc3QgKGZyb20g
bWVudG9yL2FkbWluKSAtIG9ubHkgdXBjb21pbmcKICAgICAgICBmb3IgaXRlbSBpbiBtYW51YWxf
bmV3c19saXN0OgogICAgICAgICAgICAjIENoZWNrIGlmIGV2ZW50IGhhcyBhIGRhdGV0aW1lIGFu
ZCBpZiBpdCdzIGluIHRoZSBmdXR1cmUKICAgICAgICAgICAgZXZlbnRfZGF0ZXRpbWVfc3RyID0g
aXRlbS5nZXQoImV2ZW50X3RpbWUiKQogICAgICAgICAgICBpZiBldmVudF9kYXRldGltZV9zdHI6
CiAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgIyBQYXJzZSB0aGUgZXZl
bnQgZGF0ZXRpbWUKICAgICAgICAgICAgICAgICAgICBldmVudF9kdCA9IGRhdGV0aW1lLmZyb21p
c29mb3JtYXQoZXZlbnRfZGF0ZXRpbWVfc3RyLnJlcGxhY2UoJ1onLCAnKzAwOjAwJykpIGlmIGlz
aW5zdGFuY2UoZXZlbnRfZGF0ZXRpbWVfc3RyLCBzdHIpIGVsc2UgZXZlbnRfZGF0ZXRpbWVfc3Ry
CiAgICAgICAgICAgICAgICAgICAgIyBTa2lwIGlmIGV2ZW50IGlzIGluIHRoZSBwYXN0CiAgICAg
ICAgICAgICAgICAgICAgaWYgZXZlbnRfZHQgPCBub3c6CiAgICAgICAgICAgICAgICAgICAgICAg
IGNvbnRpbnVlCiAgICAgICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICAgICAgcGFz
cyAgIyBJZiBwYXJzaW5nIGZhaWxzLCBpbmNsdWRlIHRoZSBuZXdzIGl0ZW0KICAgICAgICAgICAg
CiAgICAgICAgICAgIG5ld3NfaXRlbSA9IHsKICAgICAgICAgICAgICAgICJpZCI6IHN0cihpdGVt
WyJfaWQiXSksCiAgICAgICAgICAgICAgICAidGl0bGUiOiBpdGVtWyJ0aXRsZSJdLAogICAgICAg
ICAgICAgICAgImNyZWF0ZWRfYXQiOiBpdGVtWyJjcmVhdGVkX2F0Il0uaXNvZm9ybWF0KCksCiAg
ICAgICAgICAgICAgICAic291cmNlIjogIm1hbnVhbCIKICAgICAgICAgICAgfQogICAgICAgICAg
ICAKICAgICAgICAgICAgIyBPbmx5IGFkZCBvcHRpb25hbCBmaWVsZHMgaWYgdGhleSBleGlzdAog
ICAgICAgICAgICBpZiBpdGVtLmdldCgiZXZlbnRfdGltZSIpOgogICAgICAgICAgICAgICAgbmV3
c19pdGVtWyJldmVudF90aW1lIl0gPSBpdGVtWyJldmVudF90aW1lIl0KICAgICAgICAgICAgICAg
IG5ld3NfaXRlbVsiZXZlbnRfZGF0ZXRpbWUiXSA9IGl0ZW1bImV2ZW50X3RpbWUiXQogICAgICAg
ICAgICBpZiBpdGVtLmdldCgiY3VycmVuY3kiKToKICAgICAgICAgICAgICAgIG5ld3NfaXRlbVsi
Y3VycmVuY3kiXSA9IGl0ZW1bImN1cnJlbmN5Il0KICAgICAgICAgICAgaWYgaXRlbS5nZXQoImlt
cGFjdCIpOgogICAgICAgICAgICAgICAgbmV3c19pdGVtWyJpbXBhY3QiXSA9IGl0ZW1bImltcGFj
dCJdCiAgICAgICAgICAgIGlmIGl0ZW0uZ2V0KCJzaWduYWwiKToKICAgICAgICAgICAgICAgIG5l
d3NfaXRlbVsic2lnbmFsIl0gPSBpdGVtWyJzaWduYWwiXQogICAgICAgICAgICBpZiBpdGVtLmdl
dCgiZGVzY3JpcHRpb24iKToKICAgICAgICAgICAgICAgIG5ld3NfaXRlbVsiZGVzY3JpcHRpb24i
XSA9IGl0ZW1bImRlc2NyaXB0aW9uIl0KICAgICAgICAgICAgCiAgICAgICAgICAgIGZvcm1hdHRl
ZF9uZXdzLmFwcGVuZChuZXdzX2l0ZW0pCiAgICAgICAgCiAgICAgICAgIyBBZGQgbGl2ZSBlY29u
b21pYyBjYWxlbmRhciBldmVudHMgd2l0aCBtZW50b3Igc2lnbmFscyAtIG9ubHkgdXBjb21pbmcK
ICAgICAgICBmb3IgZXZlbnQgaW4gbGl2ZV9uZXdzOgogICAgICAgICAgICAjIENoZWNrIGlmIGV2
ZW50IGlzIGluIHRoZSBmdXR1cmUKICAgICAgICAgICAgZXZlbnRfZGF0ZXRpbWVfc3RyID0gZXZl
bnQuZ2V0KCJldmVudF9kYXRldGltZSIpCiAgICAgICAgICAgIGlmIGV2ZW50X2RhdGV0aW1lX3N0
cjoKICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICBldmVudF9kdCA9IGRh
dGV0aW1lLmZyb21pc29mb3JtYXQoZXZlbnRfZGF0ZXRpbWVfc3RyLnJlcGxhY2UoJ1onLCAnKzAw
OjAwJykpCiAgICAgICAgICAgICAgICAgICAgIyBTa2lwIGlmIGV2ZW50IGlzIGluIHRoZSBwYXN0
CiAgICAgICAgICAgICAgICAgICAgaWYgZXZlbnRfZHQgPCBub3c6CiAgICAgICAgICAgICAgICAg
ICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICAg
ICAgcGFzcyAgIyBJZiBwYXJzaW5nIGZhaWxzLCBpbmNsdWRlIHRoZSBldmVudAogICAgICAgICAg
ICAKICAgICAgICAgICAgZXZlbnRfaWQgPSBldmVudC5nZXQoImlkIikKICAgICAgICAgICAgaWYg
ZXZlbnRfaWQgaW4gbWVudG9yX3NpZ25hbHM6CiAgICAgICAgICAgICAgICBldmVudFsic2lnbmFs
Il0gPSBtZW50b3Jfc2lnbmFsc1tldmVudF9pZF0KICAgICAgICAgICAgZm9ybWF0dGVkX25ld3Mu
YXBwZW5kKGV2ZW50KQogICAgICAgIAogICAgICAgICMgU29ydCBieSBldmVudCBkYXRldGltZSAo
dXBjb21pbmcgZmlyc3QpIGFuZCBsaW1pdCB0byAyMCBpdGVtcwogICAgICAgIGZvcm1hdHRlZF9u
ZXdzLnNvcnQoa2V5PWxhbWJkYSB4OiB4LmdldCgnZXZlbnRfZGF0ZXRpbWUnLCAnJyksIHJldmVy
c2U9RmFsc2UpCiAgICAgICAgCiAgICAgICAgbG9nZ2VyLmluZm8oZiJSZXR1cm5pbmcge2xlbihm
b3JtYXR0ZWRfbmV3c1s6MjBdKX0gdXBjb21pbmcgbmV3cyBpdGVtcyIpCiAgICAgICAgcmV0dXJu
IHsibmV3cyI6IGZvcm1hdHRlZF9uZXdzWzoyMF19CiAgICAgICAgCiAgICBleGNlcHQgRXhjZXB0
aW9uIGFzIGU6CiAgICAgICAgbG9nZ2VyLmVycm9yKGYiRXJyb3IgZmV0Y2hpbmcgbmV3czoge3N0
cihlKX0iKQoKCgpAYXBpX3JvdXRlci5nZXQoIi91c2VyL3VwY29taW5nLW5ld3MtYWxlcnRzIikK
YXN5bmMgZGVmIGdldF91cGNvbWluZ19uZXdzX2FsZXJ0cyhjdXJyZW50X3VzZXIgPSBEZXBlbmRz
KGdldF9jdXJyZW50X3VzZXIpKToKICAgICIiIgogICAgR2V0IG5ld3MgZXZlbnRzIGhhcHBlbmlu
ZyB3aXRoaW4gdGhlIG5leHQgMTAgbWludXRlcyBmb3IgYnViYmxlIGFsZXJ0cwogICAgIiIiCiAg
ICB0cnk6CiAgICAgICAgZnJvbSBkYXRldGltZSBpbXBvcnQgZGF0ZXRpbWUsIHRpbWVkZWx0YQog
ICAgICAgIAogICAgICAgIHVzZXJfbWVudG9yX2lkID0gY3VycmVudF91c2VyLmdldCgibWVudG9y
X2lkIikKICAgICAgICBub3cgPSBkYXRldGltZS51dGNub3coKQogICAgICAgIGFsZXJ0X3dpbmRv
dyA9IG5vdyArIHRpbWVkZWx0YShtaW51dGVzPTEwKQogICAgICAgIAogICAgICAgICMgR2V0IGxp
dmUgZWNvbm9taWMgY2FsZW5kYXIKICAgICAgICBsaXZlX25ld3MgPSBhd2FpdCBmZXRjaF9saXZl
X2Vjb25vbWljX2NhbGVuZGFyKCkKICAgICAgICAKICAgICAgICAjIEdldCBtZW50b3IncyBzaWdu
YWxzIG9uIGxpdmUgZXZlbnRzCiAgICAgICAgbWVudG9yX3NpZ25hbHMgPSB7fQogICAgICAgIGlm
IHVzZXJfbWVudG9yX2lkOgogICAgICAgICAgICBzaWduYWxzX2N1cnNvciA9IGRiLm5ld3Nfc2ln
bmFscy5maW5kKHsibWVudG9yX2lkIjogdXNlcl9tZW50b3JfaWR9KQogICAgICAgICAgICBzaWdu
YWxzX2xpc3QgPSBhd2FpdCBzaWduYWxzX2N1cnNvci50b19saXN0KGxlbmd0aD0xMDApCiAgICAg
ICAgICAgIGZvciBzaWcgaW4gc2lnbmFsc19saXN0OgogICAgICAgICAgICAgICAgbWVudG9yX3Np
Z25hbHNbc2lnWyJldmVudF9pZCJdXSA9IHNpZy5nZXQoInNpZ25hbCIpCiAgICAgICAgCiAgICAg
ICAgIyBGaWx0ZXIgZXZlbnRzIHdpdGhpbiAxMCBtaW51dGVzCiAgICAgICAgdXBjb21pbmdfYWxl
cnRzID0gW10KICAgICAgICBmb3IgZXZlbnQgaW4gbGl2ZV9uZXdzOgogICAgICAgICAgICB0cnk6
CiAgICAgICAgICAgICAgICBldmVudF9kdCA9IGRhdGV0aW1lLmZyb21pc29mb3JtYXQoZXZlbnQu
Z2V0KCJldmVudF9kYXRldGltZSIsICIiKSkKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAg
ICAgIyBDaGVjayBpZiBldmVudCBpcyB3aXRoaW4gbmV4dCAxMCBtaW51dGVzCiAgICAgICAgICAg
ICAgICBpZiBub3cgPD0gZXZlbnRfZHQgPD0gYWxlcnRfd2luZG93OgogICAgICAgICAgICAgICAg
ICAgIGV2ZW50X2lkID0gZXZlbnQuZ2V0KCJpZCIpCiAgICAgICAgICAgICAgICAgICAgZXZlbnRb
InNpZ25hbCJdID0gbWVudG9yX3NpZ25hbHMuZ2V0KGV2ZW50X2lkKQogICAgICAgICAgICAgICAg
ICAgIGV2ZW50WyJtaW51dGVzX3VudGlsIl0gPSByb3VuZCgoZXZlbnRfZHQgLSBub3cpLnRvdGFs
X3NlY29uZHMoKSAvIDYwLCAxKQogICAgICAgICAgICAgICAgICAgIHVwY29taW5nX2FsZXJ0cy5h
cHBlbmQoZXZlbnQpCiAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgIGNvbnRpbnVl
CiAgICAgICAgCiAgICAgICAgcmV0dXJuIHsiYWxlcnRzIjogdXBjb21pbmdfYWxlcnRzfQogICAg
ICAgIAogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIGxvZ2dlci5lcnJvcihmIkVy
cm9yIGZldGNoaW5nIHVwY29taW5nIGFsZXJ0czoge3N0cihlKX0iKQogICAgICAgIHJldHVybiB7
ImFsZXJ0cyI6IFtdfQoKICAgICAgICByYWlzZSBIVFRQRXhjZXB0aW9uKHN0YXR1c19jb2RlPTUw
MCwgZGV0YWlsPWYiRmFpbGVkIHRvIGZldGNoIG5ld3M6IHtzdHIoZSl9IikKCgphc3luYyBkZWYg
ZmV0Y2hfbGl2ZV9lY29ub21pY19jYWxlbmRhcigpOgogICAgIiIiCiAgICBGZXRjaCBsaXZlIGZp
bmFuY2lhbC9tYXJrZXQgbmV3cyB1c2luZyBGaW5hbmNpYWwgTW9kZWxpbmcgUHJlcCBBUEkKICAg
IEZhbGxzIGJhY2sgdG8gbW9jayBkYXRhIGlmIEFQSSBmYWlscwogICAgUmV0dXJucyByZWxldmFu
dCB0cmFkaW5nIG5ld3MgYW5kIG1hcmtldCBldmVudHMgZm9yIHRoZSBuZXh0IDcgZGF5cwogICAg
IiIiCiAgICB0cnk6CiAgICAgICAgaW1wb3J0IGh0dHB4CiAgICAgICAgZnJvbSBkYXRldGltZSBp
bXBvcnQgZGF0ZXRpbWUsIHRpbWVkZWx0YQogICAgICAgIAogICAgICAgIG5vdyA9IGRhdGV0aW1l
LnV0Y25vdygpCiAgICAgICAgbWF4X2Z1dHVyZV9kYXRlID0gbm93ICsgdGltZWRlbHRhKGRheXM9
NykgICMgTWF4aW11bSAxIHdlZWsgZm9yZWNhc3QKICAgICAgICAKICAgICAgICAjIFRyeSB0byBm
ZXRjaCBmcm9tIEZNUCBBUEkgZmlyc3QKICAgICAgICB1cmwgPSAiaHR0cHM6Ly9maW5hbmNpYWxt
b2RlbGluZ3ByZXAuY29tL2FwaS92My9zdG9ja19uZXdzIgogICAgICAgIHBhcmFtcyA9IHsKICAg
ICAgICAgICAgImxpbWl0IjogNTAsCiAgICAgICAgICAgICJhcGlrZXkiOiAiZGVtbyIgICMgRGVt
byBrZXkgZm9yIHRlc3RpbmcKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgdHJ5OgogICAgICAg
ICAgICBhc3luYyB3aXRoIGh0dHB4LkFzeW5jQ2xpZW50KHRpbWVvdXQ9MTAuMCkgYXMgY2xpZW50
OgogICAgICAgICAgICAgICAgcmVzcG9uc2UgPSBhd2FpdCBjbGllbnQuZ2V0KHVybCwgcGFyYW1z
PXBhcmFtcykKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgaWYgcmVzcG9uc2Uuc3Rh
dHVzX2NvZGUgPT0gMjAwOgogICAgICAgICAgICAgICAgICAgIG5ld3NfaXRlbXMgPSByZXNwb25z
ZS5qc29uKCkKICAgICAgICAgICAgICAgICAgICBmb3JtYXR0ZWRfZXZlbnRzID0gW10KICAgICAg
ICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBmb3IgaXRlbSBpbiBuZXdzX2l0ZW1z
WzozMF06ICAjIExpbWl0IHRvIDMwIGl0ZW1zCiAgICAgICAgICAgICAgICAgICAgICAgIHRyeToK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgUGFyc2UgcHVibGlzaGVkIGRhdGUKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHB1Ymxpc2hlZF9hdCA9IGRhdGV0aW1lLnN0cnB0aW1lKGl0
ZW0uZ2V0KCJwdWJsaXNoZWREYXRlIiwgIiIpLCAiJVktJW0tJWQgJUg6JU06JVMiKQogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIE9ubHkg
aW5jbHVkZSByZWNlbnQgbmV3cyAobGFzdCAyNCBob3VycyB0byBuZXh0IDcgZGF5cykKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHRpbWVfZGlmZiA9IChwdWJsaXNoZWRfYXQgLSBub3cpLnRv
dGFsX3NlY29uZHMoKSAvIDM2MDAgICMgaG91cnMKICAgICAgICAgICAgICAgICAgICAgICAgICAg
IGlmIHRpbWVfZGlmZiA8IC0yNCBvciB0aW1lX2RpZmYgPiAxNjg6ICAjIC0yNGggdG8gKzcgZGF5
cwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgRGV0ZXJtaW5lIGlt
cGFjdCBiYXNlZCBvbiBwcmVzZW5jZSBpbiB0aXRsZS9kZXNjcmlwdGlvbgogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgdGl0bGUgPSBpdGVtLmdldCgidGl0bGUiLCAiIikubG93ZXIoKQogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgaW1wYWN0ID0gIk1lZGl1bSIKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGlmIGFueSh3b3JkIGluIHRpdGxlIGZvciB3b3JkIGluIFsiYnJlYWtpbmci
LCAiZmVkIiwgImluZmxhdGlvbiIsICJnZHAiLCAicmF0ZSIsICJlbXBsb3ltZW50IiwgImVhcm5p
bmdzIiwgImNyYXNoIiwgInN1cmdlIl0pOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IGltcGFjdCA9ICJIaWdoIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxpZiBhbnkod29y
ZCBpbiB0aXRsZSBmb3Igd29yZCBpbiBbInVwZGF0ZSIsICJjb21tZW50IiwgIm9waW5pb24iLCAi
YW5hbHlzaXMiXSk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW1wYWN0ID0gIkxv
dyIKICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIyBFeHRyYWN0IHN5bWJvbCBpZiBhdmFpbGFibGUKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIGN1cnJlbmN5ID0gaXRlbS5nZXQoInN5bWJvbCIsICJNQVJLRVQiKQogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgaWYgbm90IGN1cnJlbmN5IG9yIGxlbihjdXJyZW5jeSkgPiAxMDoKICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW5jeSA9ICJHRU5FUkFMIgogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JtYXR0
ZWRfZXZlbnRzLmFwcGVuZCh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImlkIjog
ZiJmbXBfe2l0ZW0uZ2V0KCd1cmwnLCAnJykuc3BsaXQoJy8nKVstMV19IiwKICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAidGl0bGUiOiBpdGVtLmdldCgidGl0bGUiLCAiTWFya2V0IE5l
d3MiKVs6MTAwXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiZXZlbnRfdGltZSI6
IHB1Ymxpc2hlZF9hdC5zdHJmdGltZSgiJUg6JU0gVVRDIiksCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgImV2ZW50X2RhdGV0aW1lIjogcHVibGlzaGVkX2F0Lmlzb2Zvcm1hdCgpLAog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJjdXJyZW5jeSI6IGN1cnJlbmN5WzoxMF0s
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImltcGFjdCI6IGltcGFjdCwKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAic2lnbmFsIjogTm9uZSwKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAiY3JlYXRlZF9hdCI6IGRhdGV0aW1lLnV0Y25vdygpLmlzb2Zvcm1h
dCgpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJzb3VyY2UiOiAiZm1wX25ld3Mi
LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJkZXNjcmlwdGlvbiI6IGl0ZW0uZ2V0
KCJ0ZXh0IiwgIiIpWzoyMDBdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ1cmwi
OiBpdGVtLmdldCgidXJsIiwgIiIpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJz
aXRlIjogaXRlbS5nZXQoInNpdGUiLCAiIikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0p
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAg
IGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dl
ci5lcnJvcihmIkVycm9yIHBhcnNpbmcgRk1QIG5ld3MgaXRlbToge3N0cihlKX0iKQogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgICAgICAgICAKICAgICAg
ICAgICAgICAgICAgICBpZiBmb3JtYXR0ZWRfZXZlbnRzOgogICAgICAgICAgICAgICAgICAgICAg
ICBsb2dnZXIuaW5mbyhmIkZldGNoZWQge2xlbihmb3JtYXR0ZWRfZXZlbnRzKX0gbWFya2V0IG5l
d3MgZXZlbnRzIGZyb20gRk1QIikKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZvcm1h
dHRlZF9ldmVudHMKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgbG9n
Z2VyLndhcm5pbmcoZiJGTVAgQVBJIHJldHVybmVkIHtyZXNwb25zZS5zdGF0dXNfY29kZX0iKQog
ICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgYXBpX2Vycm9yOgogICAgICAgICAgICBsb2dnZXIu
d2FybmluZyhmIkZNUCBBUEkgZmFpbGVkOiB7c3RyKGFwaV9lcnJvcil9IikKICAgICAgICAKICAg
ICAgICAjIEZhbGxiYWNrOiBHZW5lcmF0ZSBtb2NrIG5ld3MgZXZlbnRzIGlmIEFQSSBmYWlscwog
ICAgICAgIGxvZ2dlci5pbmZvKCJVc2luZyBtb2NrIG5ld3MgZGF0YSBhcyBGTVAgQVBJIGlzIHVu
YXZhaWxhYmxlIikKICAgICAgICBtb2NrX2V2ZW50cyA9IFtdCiAgICAgICAgCiAgICAgICAgIyBH
ZW5lcmF0ZSAxMCBtb2NrIG5ld3MgZXZlbnRzIGZvciB0aGUgbmV4dCA3IGRheXMKICAgICAgICBm
b3IgaSBpbiByYW5nZSgxMCk6CiAgICAgICAgICAgIGV2ZW50X3RpbWUgPSBub3cgKyB0aW1lZGVs
dGEoaG91cnM9aSo2ICsgMikgICMgRXZlbnRzIGV2ZXJ5IDYgaG91cnMKICAgICAgICAgICAgCiAg
ICAgICAgICAgIG1vY2tfdGl0bGVzID0gWwogICAgICAgICAgICAgICAgIkZlZCBJbnRlcmVzdCBS
YXRlIERlY2lzaW9uIEV4cGVjdGVkIFRvZGF5IiwKICAgICAgICAgICAgICAgICJVUyBEb2xsYXIg
U3RyZW5ndGhlbnMgQWdhaW5zdCBNYWpvciBDdXJyZW5jaWVzIiwKICAgICAgICAgICAgICAgICJF
dXJvcGVhbiBDZW50cmFsIEJhbmsgUG9saWN5IE1lZXRpbmciLAogICAgICAgICAgICAgICAgIk9p
bCBQcmljZXMgU3VyZ2Ugb24gU3VwcGx5IENvbmNlcm5zIiwKICAgICAgICAgICAgICAgICJUZWNo
IFN0b2NrcyBSYWxseSBvbiBTdHJvbmcgRWFybmluZ3MiLAogICAgICAgICAgICAgICAgIkdvbGQg
UmVhY2hlcyBOZXcgSGlnaCBBbWlkIE1hcmtldCBVbmNlcnRhaW50eSIsCiAgICAgICAgICAgICAg
ICAiVVMgRW1wbG95bWVudCBSZXBvcnQgU2hvd3MgSm9iIEdyb3d0aCIsCiAgICAgICAgICAgICAg
ICAiQml0Y29pbiBUcmFkaW5nIFZvbHVtZSBJbmNyZWFzZXMgU2lnbmlmaWNhbnRseSIsCiAgICAg
ICAgICAgICAgICAiRVVSL1VTRCBIaXRzIEtleSBTdXBwb3J0IExldmVsIiwKICAgICAgICAgICAg
ICAgICJBc2lhbiBNYXJrZXRzIE9wZW4gSGlnaGVyIG9uIEVjb25vbWljIERhdGEiCiAgICAgICAg
ICAgIF0KICAgICAgICAgICAgCiAgICAgICAgICAgIGN1cnJlbmNpZXMgPSBbIlVTRCIsICJFVVIi
LCAiR0JQIiwgIkpQWSIsICJBVUQiLCAiTlpEIiwgIkNBRCIsICJDSEYiLCAiR09MRCIsICJPSUwi
XQogICAgICAgICAgICBpbXBhY3RzID0gWyJIaWdoIiwgIkhpZ2giLCAiTWVkaXVtIiwgIkhpZ2gi
LCAiTWVkaXVtIiwgIkhpZ2giLCAiSGlnaCIsICJNZWRpdW0iLCAiTWVkaXVtIiwgIk1lZGl1bSJd
CiAgICAgICAgICAgIAogICAgICAgICAgICBtb2NrX2V2ZW50cy5hcHBlbmQoewogICAgICAgICAg
ICAgICAgImlkIjogZiJtb2NrX25ld3Nfe2l9X3tpbnQoZXZlbnRfdGltZS50aW1lc3RhbXAoKSl9
IiwKICAgICAgICAgICAgICAgICJ0aXRsZSI6IG1vY2tfdGl0bGVzW2ldLAogICAgICAgICAgICAg
ICAgImV2ZW50X3RpbWUiOiBldmVudF90aW1lLnN0cmZ0aW1lKCIlSDolTSBVVEMiKSwKICAgICAg
ICAgICAgICAgICJldmVudF9kYXRldGltZSI6IGV2ZW50X3RpbWUuaXNvZm9ybWF0KCksCiAgICAg
ICAgICAgICAgICAiY3VycmVuY3kiOiBjdXJyZW5jaWVzW2ldLAogICAgICAgICAgICAgICAgImlt
cGFjdCI6IGltcGFjdHNbaV0sCiAgICAgICAgICAgICAgICAic2lnbmFsIjogTm9uZSwKICAgICAg
ICAgICAgICAgICJjcmVhdGVkX2F0IjogZGF0ZXRpbWUudXRjbm93KCkuaXNvZm9ybWF0KCksCiAg
ICAgICAgICAgICAgICAic291cmNlIjogIm1vY2tfY2FsZW5kYXIiLAogICAgICAgICAgICAgICAg
ImRlc2NyaXB0aW9uIjogZiJNb2NrIHRyYWRpbmcgZXZlbnQgZm9yIHtjdXJyZW5jaWVzW2ldfSAt
IHttb2NrX3RpdGxlc1tpXX0iLAogICAgICAgICAgICAgICAgInVybCI6ICIiCiAgICAgICAgICAg
IH0pCiAgICAgICAgCiAgICAgICAgbG9nZ2VyLmluZm8oZiJHZW5lcmF0ZWQge2xlbihtb2NrX2V2
ZW50cyl9IG1vY2sgbmV3cyBldmVudHMiKQogICAgICAgIHJldHVybiBtb2NrX2V2ZW50cwogICAg
ICAgIAogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIGxvZ2dlci5lcnJvcihmIkVy
cm9yIGluIGZldGNoX2xpdmVfZWNvbm9taWNfY2FsZW5kYXI6IHtzdHIoZSl9IikKICAgICAgICBy
ZXR1cm4gW10KCgpAYXBpX3JvdXRlci5nZXQoIi91c2VyL2Jyb2tlcnMiKQphc3luYyBkZWYgZ2V0
X3VzZXJfYnJva2VycyhjdXJyZW50X3VzZXIgPSBEZXBlbmRzKGdldF9jdXJyZW50X3VzZXIpKToK
ICAgICIiIgogICAgR2V0IGFsbCBicm9rZXJzIHNlbnQgdG8gdGhpcyB1c2VyIChmcm9tIGFkbWlu
IGFuZCB0aGVpciBtZW50b3IpCiAgICBTaG93cyBicm9rZXJzIGluIHJvdGF0aW9uIGFmdGVyIHNv
bWUgdGltZQogICAgIiIiCiAgICB0cnk6CiAgICAgICAgdXNlcl9pZCA9IHN0cihjdXJyZW50X3Vz
ZXJbIl9pZCJdKQogICAgICAgIAogICAgICAgICMgR2V0IGJyb2tlciBub3RpZmljYXRpb25zIGZv
ciB0aGlzIHVzZXIKICAgICAgICBub3RpZmljYXRpb25zID0gYXdhaXQgZGIuYnJva2VyX25vdGlm
aWNhdGlvbnMuZmluZCh7CiAgICAgICAgICAgICJ1c2VyX2lkIjogdXNlcl9pZAogICAgICAgIH0p
LnNvcnQoImNyZWF0ZWRfYXQiLCAtMSkudG9fbGlzdChsZW5ndGg9MTAwKQogICAgICAgIAogICAg
ICAgIGJyb2tlcnMgPSBbXQogICAgICAgIHVuc2Vlbl9jb3VudCA9IDAKICAgICAgICAKICAgICAg
ICBmb3Igbm90aWYgaW4gbm90aWZpY2F0aW9uczoKICAgICAgICAgICAgYnJva2VyID0gYXdhaXQg
ZGIuYnJva2Vycy5maW5kX29uZSh7CiAgICAgICAgICAgICAgICAiX2lkIjogT2JqZWN0SWQobm90
aWZbImJyb2tlcl9pZCJdKSwKICAgICAgICAgICAgICAgICJzdGF0dXMiOiAiYWN0aXZlIgogICAg
ICAgICAgICB9KQogICAgICAgICAgICAKICAgICAgICAgICAgaWYgYnJva2VyOgogICAgICAgICAg
ICAgICAgYnJva2Vycy5hcHBlbmQoewogICAgICAgICAgICAgICAgICAgICoqc2VyaWFsaXplX2Rv
Yyhicm9rZXIpLAogICAgICAgICAgICAgICAgICAgICJzZWVuIjogbm90aWYuZ2V0KCJzZWVuIiwg
RmFsc2UpLAogICAgICAgICAgICAgICAgICAgICJub3RpZmljYXRpb25faWQiOiBzdHIobm90aWZb
Il9pZCJdKSwKICAgICAgICAgICAgICAgICAgICAicmVjZWl2ZWRfYXQiOiBub3RpZi5nZXQoImNy
ZWF0ZWRfYXQiKQogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIAogICAgICAgICAg
ICAgICAgaWYgbm90IG5vdGlmLmdldCgic2VlbiIpOgogICAgICAgICAgICAgICAgICAgIHVuc2Vl
bl9jb3VudCArPSAxCiAgICAgICAgCiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgImJyb2tl
cnMiOiBicm9rZXJzLAogICAgICAgICAgICAidW5zZWVuX2NvdW50IjogdW5zZWVuX2NvdW50CiAg
ICAgICAgfQogICAgICAgIAogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIGxvZ2dl
ci5lcnJvcihmIkVycm9yIGZldGNoaW5nIHVzZXIgYnJva2Vyczoge3N0cihlKX0iKQogICAgICAg
IHJhaXNlIEhUVFBFeGNlcHRpb24oc3RhdHVzX2NvZGU9NTAwLCBkZXRhaWw9ZiJGYWlsZWQgdG8g
ZmV0Y2ggYnJva2Vyczoge3N0cihlKX0iKQoKCkBhcGlfcm91dGVyLnBvc3QoIi91c2VyL2Jyb2tl
cnMve25vdGlmaWNhdGlvbl9pZH0vbWFyay1zZWVuIikKYXN5bmMgZGVmIG1hcmtfYnJva2VyX3Nl
ZW4obm90aWZpY2F0aW9uX2lkOiBzdHIsIGN1cnJlbnRfdXNlciA9IERlcGVuZHMoZ2V0X2N1cnJl
bnRfdXNlcikpOgogICAgIiIiCiAgICBNYXJrIGEgYnJva2VyIG5vdGlmaWNhdGlvbiBhcyBzZWVu
CiAgICAiIiIKICAgIHRyeToKICAgICAgICB1c2VyX2lkID0gc3RyKGN1cnJlbnRfdXNlclsiX2lk
Il0pCiAgICAgICAgCiAgICAgICAgcmVzdWx0ID0gYXdhaXQgZGIuYnJva2VyX25vdGlmaWNhdGlv
bnMudXBkYXRlX29uZSgKICAgICAgICAgICAgeyJfaWQiOiBPYmplY3RJZChub3RpZmljYXRpb25f
aWQpLCAidXNlcl9pZCI6IHVzZXJfaWR9LAogICAgICAgICAgICB7IiRzZXQiOiB7InNlZW4iOiBU
cnVlLCAic2Vlbl9hdCI6IGRhdGV0aW1lLnV0Y25vdygpfX0KICAgICAgICApCiAgICAgICAgCiAg
ICAgICAgaWYgcmVzdWx0Lm1vZGlmaWVkX2NvdW50ID4gMDoKICAgICAgICAgICAgcmV0dXJuIHsi
bWVzc2FnZSI6ICJCcm9rZXIgbm90aWZpY2F0aW9uIG1hcmtlZCBhcyBzZWVuIn0KICAgICAgICBl
bHNlOgogICAgICAgICAgICByYWlzZSBIVFRQRXhjZXB0aW9uKHN0YXR1c19jb2RlPTQwNCwgZGV0
YWlsPSJOb3RpZmljYXRpb24gbm90IGZvdW5kIikKICAgICAgICAKICAgIGV4Y2VwdCBIVFRQRXhj
ZXB0aW9uOgogICAgICAgIHJhaXNlCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAg
bG9nZ2VyLmVycm9yKGYiRXJyb3IgbWFya2luZyBicm9rZXIgc2Vlbjoge3N0cihlKX0iKQogICAg
ICAgIHJhaXNlIEhUVFBFeGNlcHRpb24oc3RhdHVzX2NvZGU9NTAwLCBkZXRhaWw9ZiJGYWlsZWQg
dG8gbWFyayBicm9rZXIgc2Vlbjoge3N0cihlKX0iKQoKCkBhcGlfcm91dGVyLnBvc3QoIi91c2Vy
L3NpZ25hbHMve3NpZ25hbF9pZH0vbWFyay1yZWFkIikKYXN5bmMgZGVmIG1hcmtfc2lnbmFsX3Jl
YWQoc2lnbmFsX2lkOiBzdHIsIGN1cnJlbnRfdXNlciA9IERlcGVuZHMoZ2V0X2N1cnJlbnRfdXNl
cikpOgogICAgIiIiCiAgICBNYXJrIGEgc2lnbmFsIGFzIHJlYWQKICAgICIiIgogICAgdHJ5Ogog
ICAgICAgIHVzZXJfaWQgPSBzdHIoY3VycmVudF91c2VyWyJfaWQiXSkKICAgICAgICAKICAgICAg
ICByZXN1bHQgPSBhd2FpdCBkYi51c2VyX3NpZ25hbHMudXBkYXRlX29uZSgKICAgICAgICAgICAg
eyJzaWduYWxfaWQiOiBzaWduYWxfaWQsICJ1c2VyX2lkIjogdXNlcl9pZH0sCiAgICAgICAgICAg
IHsiJHNldCI6IHsicmVhZCI6IFRydWUsICJyZWFkX2F0IjogZGF0ZXRpbWUudXRjbm93KCl9fQog
ICAgICAgICkKICAgICAgICAKICAgICAgICBpZiByZXN1bHQubW9kaWZpZWRfY291bnQgPiAwOgog
ICAgICAgICAgICByZXR1cm4geyJtZXNzYWdlIjogIlNpZ25hbCBtYXJrZWQgYXMgcmVhZCJ9CiAg
ICAgICAgZWxzZToKICAgICAgICAgICAgcmFpc2UgSFRUUEV4Y2VwdGlvbihzdGF0dXNfY29kZT00
MDQsIGRldGFpbD0iU2lnbmFsIG5vdCBmb3VuZCIpCiAgICAgICAgCiAgICBleGNlcHQgSFRUUEV4
Y2VwdGlvbjoKICAgICAgICByYWlzZQogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAg
IGxvZ2dlci5lcnJvcihmIkVycm9yIG1hcmtpbmcgc2lnbmFsIGFzIHJlYWQ6IHtzdHIoZSl9IikK
ICAgICAgICByYWlzZSBIVFRQRXhjZXB0aW9uKHN0YXR1c19jb2RlPTUwMCwgZGV0YWlsPWYiRmFp
bGVkIHRvIG1hcmsgc2lnbmFsIGFzIHJlYWQ6IHtzdHIoZSl9IikKCgphc3luYyBkZWYgcm9vdCgp
OgogICAgcmV0dXJuIHsibWVzc2FnZSI6ICJFQSBUcmFkaW5nIEFQSSBpcyBydW5uaW5nIn0KCiMg
SW5jbHVkZSB0aGUgcm91dGVyIGluIHRoZSBtYWluIGFwcAphcHAuaW5jbHVkZV9yb3V0ZXIoYXBp
X3JvdXRlcikKCmFwcC5hZGRfbWlkZGxld2FyZSgKICAgIENPUlNNaWRkbGV3YXJlLAogICAgYWxs
b3dfY3JlZGVudGlhbHM9VHJ1ZSwKICAgIGFsbG93X29yaWdpbnM9WyIqIl0sCiAgICBhbGxvd19t
ZXRob2RzPVsiKiJdLAogICAgYWxsb3dfaGVhZGVycz1bIioiXSwKKQoKIyBDb25maWd1cmUgbG9n
Z2luZwpsb2dnaW5nLmJhc2ljQ29uZmlnKAogICAgbGV2ZWw9bG9nZ2luZy5JTkZPLAogICAgZm9y
bWF0PSclKGFzY3RpbWUpcyAtICUobmFtZSlzIC0gJShsZXZlbG5hbWUpcyAtICUobWVzc2FnZSlz
JwopCmxvZ2dlciA9IGxvZ2dpbmcuZ2V0TG9nZ2VyKF9fbmFtZV9fKQoKQGFwcC5vbl9ldmVudCgi
c2h1dGRvd24iKQphc3luYyBkZWYgc2h1dGRvd25fZGJfY2xpZW50KCk6CiAgICBjbGllbnQuY2xv
c2UoKQo=
